<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Model validation and interpretation | Multifunctional peptide engineering</title>
  <meta name="description" content="Section 4 Model validation and interpretation | Multifunctional peptide engineering" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Model validation and interpretation | Multifunctional peptide engineering" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Model validation and interpretation | Multifunctional peptide engineering" />
  
  
  

<meta name="author" content="Renee Ti Chou and Henry T. Hsueh" />


<meta name="date" content="2023-03-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_03_model_training.html"/>
<link rel="next" href="id_05_adversarial_computational_control.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.24/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<!-- https://stackoverflow.com/questions/45360998/code-folding-in-bookdown -->
<script type="text/javascript" src="js/transition.js"></script>
<script type="text/javascript" src="js/dropdown.js"></script>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><i>Multifunctional peptide engineering</i></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="id_01_pilot_peptide_array.html"><a href="id_01_pilot_peptide_array.html"><i class="fa fa-check"></i><b>1</b> Melanin binding pilot peptide array</a>
<ul>
<li class="chapter" data-level="1.1" data-path="id_01_pilot_peptide_array.html"><a href="id_01_pilot_peptide_array.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="id_01_pilot_peptide_array.html"><a href="id_01_pilot_peptide_array.html#generating-ml-input"><i class="fa fa-check"></i><b>1.2</b> Generating ML input</a></li>
<li class="chapter" data-level="1.3" data-path="id_01_pilot_peptide_array.html"><a href="id_01_pilot_peptide_array.html#training-initial-rf-model"><i class="fa fa-check"></i><b>1.3</b> Training initial RF model</a></li>
<li class="chapter" data-level="1.4" data-path="id_01_pilot_peptide_array.html"><a href="id_01_pilot_peptide_array.html#melanin-binding-variable-importance"><i class="fa fa-check"></i><b>1.4</b> Melanin binding variable importance</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html"><i class="fa fa-check"></i><b>2</b> Variable reduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#methods"><i class="fa fa-check"></i><b>2.1</b> Methods</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#regression"><i class="fa fa-check"></i><b>2.1.1</b> Regression</a></li>
<li class="chapter" data-level="2.1.2" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#classification"><i class="fa fa-check"></i><b>2.1.2</b> Classification</a>
<ul>
<li class="chapter" data-level="2.1.2.1" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#extension-to-multi-class-classification"><i class="fa fa-check"></i><b>2.1.2.1</b> Extension to multi-class classification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#ml-input-generating-function"><i class="fa fa-check"></i><b>2.2</b> ML input generating function</a></li>
<li class="chapter" data-level="2.3" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#aic-functions"><i class="fa fa-check"></i><b>2.3</b> AIC functions</a></li>
<li class="chapter" data-level="2.4" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#melanin-binding-regression"><i class="fa fa-check"></i><b>2.4</b> Melanin binding (regression)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#generating-ml-input-1"><i class="fa fa-check"></i><b>2.4.1</b> Generating ML input</a></li>
<li class="chapter" data-level="2.4.2" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#variable-importance"><i class="fa fa-check"></i><b>2.4.2</b> Variable importance</a></li>
<li class="chapter" data-level="2.4.3" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#variable-reduction"><i class="fa fa-check"></i><b>2.4.3</b> Variable reduction</a></li>
<li class="chapter" data-level="2.4.4" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#generating-train-test-splits"><i class="fa fa-check"></i><b>2.4.4</b> Generating train-test splits</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#cell-penetration-classification"><i class="fa fa-check"></i><b>2.5</b> Cell-penetration (classification)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#generating-ml-input-2"><i class="fa fa-check"></i><b>2.5.1</b> Generating ML input</a></li>
<li class="chapter" data-level="2.5.2" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#variable-importance-1"><i class="fa fa-check"></i><b>2.5.2</b> Variable importance</a></li>
<li class="chapter" data-level="2.5.3" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#variable-reduction-1"><i class="fa fa-check"></i><b>2.5.3</b> Variable reduction</a></li>
<li class="chapter" data-level="2.5.4" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#generating-train-test-splits-1"><i class="fa fa-check"></i><b>2.5.4</b> Generating train-test splits</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#toxicity-classification"><i class="fa fa-check"></i><b>2.6</b> Toxicity (classification)</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#generating-ml-input-3"><i class="fa fa-check"></i><b>2.6.1</b> Generating ML input</a></li>
<li class="chapter" data-level="2.6.2" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#variable-importance-2"><i class="fa fa-check"></i><b>2.6.2</b> Variable importance</a></li>
<li class="chapter" data-level="2.6.3" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#variable-reduction-2"><i class="fa fa-check"></i><b>2.6.3</b> Variable reduction</a></li>
<li class="chapter" data-level="2.6.4" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#generating-train-test-splits-2"><i class="fa fa-check"></i><b>2.6.4</b> Generating train-test splits</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="id_02_variable_reduction.html"><a href="id_02_variable_reduction.html#plotting"><i class="fa fa-check"></i><b>2.7</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="id_03_model_training.html"><a href="id_03_model_training.html"><i class="fa fa-check"></i><b>3</b> Model training</a>
<ul>
<li class="chapter" data-level="3.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#overview-1"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#general-codefunctions"><i class="fa fa-check"></i><b>3.2</b> General code/functions</a></li>
<li class="chapter" data-level="3.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#melanin-binding-regression-1"><i class="fa fa-check"></i><b>3.3</b> Melanin binding (regression)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#model-training"><i class="fa fa-check"></i><b>3.3.1</b> Model training</a></li>
<li class="chapter" data-level="3.3.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#inner-cross-validation"><i class="fa fa-check"></i><b>3.3.2</b> Inner cross-validation</a></li>
<li class="chapter" data-level="3.3.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#training-on-whole-data-set"><i class="fa fa-check"></i><b>3.3.3</b> Training on whole data set</a></li>
<li class="chapter" data-level="3.3.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#model-evaluation"><i class="fa fa-check"></i><b>3.3.4</b> Model evaluation</a></li>
<li class="chapter" data-level="3.3.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#inner-loop-model-selection"><i class="fa fa-check"></i><b>3.3.5</b> Inner loop model selection</a>
<ul>
<li class="chapter" data-level="3.3.5.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-1"><i class="fa fa-check"></i><b>3.3.5.1</b> CV 1</a></li>
<li class="chapter" data-level="3.3.5.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-2"><i class="fa fa-check"></i><b>3.3.5.2</b> CV 2</a></li>
<li class="chapter" data-level="3.3.5.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-3"><i class="fa fa-check"></i><b>3.3.5.3</b> CV 3</a></li>
<li class="chapter" data-level="3.3.5.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-4"><i class="fa fa-check"></i><b>3.3.5.4</b> CV 4</a></li>
<li class="chapter" data-level="3.3.5.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-5"><i class="fa fa-check"></i><b>3.3.5.5</b> CV 5</a></li>
<li class="chapter" data-level="3.3.5.6" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-6"><i class="fa fa-check"></i><b>3.3.5.6</b> CV 6</a></li>
<li class="chapter" data-level="3.3.5.7" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-7"><i class="fa fa-check"></i><b>3.3.5.7</b> CV 7</a></li>
<li class="chapter" data-level="3.3.5.8" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-8"><i class="fa fa-check"></i><b>3.3.5.8</b> CV 8</a></li>
<li class="chapter" data-level="3.3.5.9" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-9"><i class="fa fa-check"></i><b>3.3.5.9</b> CV 9</a></li>
<li class="chapter" data-level="3.3.5.10" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-10"><i class="fa fa-check"></i><b>3.3.5.10</b> CV 10</a></li>
</ul></li>
<li class="chapter" data-level="3.3.6" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-evaluation"><i class="fa fa-check"></i><b>3.3.6</b> Final evaluation</a></li>
<li class="chapter" data-level="3.3.7" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-model-selection"><i class="fa fa-check"></i><b>3.3.7</b> Final model selection</a></li>
<li class="chapter" data-level="3.3.8" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-reduced-sl"><i class="fa fa-check"></i><b>3.3.8</b> Final reduced SL</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cell-penetration-classification-1"><i class="fa fa-check"></i><b>3.4</b> Cell-penetration (classification)</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#model-training-1"><i class="fa fa-check"></i><b>3.4.1</b> Model training</a></li>
<li class="chapter" data-level="3.4.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#inner-cross-validation-1"><i class="fa fa-check"></i><b>3.4.2</b> Inner cross-validation</a></li>
<li class="chapter" data-level="3.4.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#training-on-whole-data-set-1"><i class="fa fa-check"></i><b>3.4.3</b> Training on whole data set</a></li>
<li class="chapter" data-level="3.4.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#model-evaluation-1"><i class="fa fa-check"></i><b>3.4.4</b> Model evaluation</a></li>
<li class="chapter" data-level="3.4.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#inner-loop-model-selection-1"><i class="fa fa-check"></i><b>3.4.5</b> Inner loop model selection</a>
<ul>
<li class="chapter" data-level="3.4.5.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-1-1"><i class="fa fa-check"></i><b>3.4.5.1</b> CV 1</a></li>
<li class="chapter" data-level="3.4.5.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-2-1"><i class="fa fa-check"></i><b>3.4.5.2</b> CV 2</a></li>
<li class="chapter" data-level="3.4.5.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-3-1"><i class="fa fa-check"></i><b>3.4.5.3</b> CV 3</a></li>
<li class="chapter" data-level="3.4.5.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-4-1"><i class="fa fa-check"></i><b>3.4.5.4</b> CV 4</a></li>
<li class="chapter" data-level="3.4.5.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-5-1"><i class="fa fa-check"></i><b>3.4.5.5</b> CV 5</a></li>
<li class="chapter" data-level="3.4.5.6" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-6-1"><i class="fa fa-check"></i><b>3.4.5.6</b> CV 6</a></li>
<li class="chapter" data-level="3.4.5.7" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-7-1"><i class="fa fa-check"></i><b>3.4.5.7</b> CV 7</a></li>
<li class="chapter" data-level="3.4.5.8" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-8-1"><i class="fa fa-check"></i><b>3.4.5.8</b> CV 8</a></li>
<li class="chapter" data-level="3.4.5.9" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-9-1"><i class="fa fa-check"></i><b>3.4.5.9</b> CV 9</a></li>
<li class="chapter" data-level="3.4.5.10" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-10-1"><i class="fa fa-check"></i><b>3.4.5.10</b> CV 10</a></li>
</ul></li>
<li class="chapter" data-level="3.4.6" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-evaluation-1"><i class="fa fa-check"></i><b>3.4.6</b> Final evaluation</a></li>
<li class="chapter" data-level="3.4.7" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-model-selection-1"><i class="fa fa-check"></i><b>3.4.7</b> Final model selection</a></li>
<li class="chapter" data-level="3.4.8" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-reduced-sl-1"><i class="fa fa-check"></i><b>3.4.8</b> Final reduced SL</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#toxicity-classification-1"><i class="fa fa-check"></i><b>3.5</b> Toxicity (classification)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#model-training-2"><i class="fa fa-check"></i><b>3.5.1</b> Model training</a></li>
<li class="chapter" data-level="3.5.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#inner-cross-validation-2"><i class="fa fa-check"></i><b>3.5.2</b> Inner cross-validation</a></li>
<li class="chapter" data-level="3.5.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#training-on-whole-data-set-2"><i class="fa fa-check"></i><b>3.5.3</b> Training on whole data set</a></li>
<li class="chapter" data-level="3.5.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#model-evaluation-2"><i class="fa fa-check"></i><b>3.5.4</b> Model evaluation</a></li>
<li class="chapter" data-level="3.5.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#inner-loop-model-selection-2"><i class="fa fa-check"></i><b>3.5.5</b> Inner loop model selection</a>
<ul>
<li class="chapter" data-level="3.5.5.1" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-1-2"><i class="fa fa-check"></i><b>3.5.5.1</b> CV 1</a></li>
<li class="chapter" data-level="3.5.5.2" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-2-2"><i class="fa fa-check"></i><b>3.5.5.2</b> CV 2</a></li>
<li class="chapter" data-level="3.5.5.3" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-3-2"><i class="fa fa-check"></i><b>3.5.5.3</b> CV 3</a></li>
<li class="chapter" data-level="3.5.5.4" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-4-2"><i class="fa fa-check"></i><b>3.5.5.4</b> CV 4</a></li>
<li class="chapter" data-level="3.5.5.5" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-5-2"><i class="fa fa-check"></i><b>3.5.5.5</b> CV 5</a></li>
<li class="chapter" data-level="3.5.5.6" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-6-2"><i class="fa fa-check"></i><b>3.5.5.6</b> CV 6</a></li>
<li class="chapter" data-level="3.5.5.7" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-7-2"><i class="fa fa-check"></i><b>3.5.5.7</b> CV 7</a></li>
<li class="chapter" data-level="3.5.5.8" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-8-2"><i class="fa fa-check"></i><b>3.5.5.8</b> CV 8</a></li>
<li class="chapter" data-level="3.5.5.9" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-9-2"><i class="fa fa-check"></i><b>3.5.5.9</b> CV 9</a></li>
<li class="chapter" data-level="3.5.5.10" data-path="id_03_model_training.html"><a href="id_03_model_training.html#cv-10-2"><i class="fa fa-check"></i><b>3.5.5.10</b> CV 10</a></li>
</ul></li>
<li class="chapter" data-level="3.5.6" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-evaluation-2"><i class="fa fa-check"></i><b>3.5.6</b> Final evaluation</a></li>
<li class="chapter" data-level="3.5.7" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-model-selection-2"><i class="fa fa-check"></i><b>3.5.7</b> Final model selection</a></li>
<li class="chapter" data-level="3.5.8" data-path="id_03_model_training.html"><a href="id_03_model_training.html#final-reduced-sl-2"><i class="fa fa-check"></i><b>3.5.8</b> Final reduced SL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html"><i class="fa fa-check"></i><b>4</b> Model validation and interpretation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#model-validation"><i class="fa fa-check"></i><b>4.1</b> Model validation</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#melaning-binding"><i class="fa fa-check"></i><b>4.1.1</b> Melaning binding</a></li>
<li class="chapter" data-level="4.1.2" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#melanin-binding-and-cell-penetration"><i class="fa fa-check"></i><b>4.1.2</b> Melanin binding and cell-penetration</a></li>
<li class="chapter" data-level="4.1.3" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#melanin-induced-cells"><i class="fa fa-check"></i><b>4.1.3</b> Melanin-induced cells</a></li>
<li class="chapter" data-level="4.1.4" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#non-melanin-induced-cells"><i class="fa fa-check"></i><b>4.1.4</b> Non-melanin induced cells</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#overall-model-interpretation"><i class="fa fa-check"></i><b>4.2</b> Overall model interpretation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#melanin-binding-regression-2"><i class="fa fa-check"></i><b>4.2.1</b> Melanin binding (regression)</a></li>
<li class="chapter" data-level="4.2.2" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#cell-penetration-classification-2"><i class="fa fa-check"></i><b>4.2.2</b> Cell-penetration (classification)</a></li>
<li class="chapter" data-level="4.2.3" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#toxicity-classification-2"><i class="fa fa-check"></i><b>4.2.3</b> Toxicity (classification)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#multifunctional-peptide-selection"><i class="fa fa-check"></i><b>4.3</b> Multifunctional peptide selection</a></li>
<li class="chapter" data-level="4.4" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#explanation-of-hr97-predictions"><i class="fa fa-check"></i><b>4.4</b> Explanation of HR97 predictions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#melanin-binding"><i class="fa fa-check"></i><b>4.4.1</b> Melanin binding</a></li>
<li class="chapter" data-level="4.4.2" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#cell-penetration"><i class="fa fa-check"></i><b>4.4.2</b> Cell-penetration</a></li>
<li class="chapter" data-level="4.4.3" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#toxicity"><i class="fa fa-check"></i><b>4.4.3</b> Toxicity</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="id_04_model_validation_and_interpretation.html"><a href="id_04_model_validation_and_interpretation.html#peptide-design-space-visualization"><i class="fa fa-check"></i><b>4.5</b> Peptide design space visualization</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html"><i class="fa fa-check"></i><b>5</b> Adversarial computational control</a>
<ul>
<li class="chapter" data-level="5.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#general-codefunctions-1"><i class="fa fa-check"></i><b>5.1</b> General code/functions</a></li>
<li class="chapter" data-level="5.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#melanin-binding-regression-3"><i class="fa fa-check"></i><b>5.2</b> Melanin binding (regression)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#model-training-3"><i class="fa fa-check"></i><b>5.2.1</b> Model training</a></li>
<li class="chapter" data-level="5.2.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#inner-cross-validation-3"><i class="fa fa-check"></i><b>5.2.2</b> Inner cross-validation</a></li>
<li class="chapter" data-level="5.2.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#model-evaluation-3"><i class="fa fa-check"></i><b>5.2.3</b> Model evaluation</a></li>
<li class="chapter" data-level="5.2.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#inner-loop-model-selection-3"><i class="fa fa-check"></i><b>5.2.4</b> Inner loop model selection</a>
<ul>
<li class="chapter" data-level="5.2.4.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-1-3"><i class="fa fa-check"></i><b>5.2.4.1</b> CV 1</a></li>
<li class="chapter" data-level="5.2.4.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-2-3"><i class="fa fa-check"></i><b>5.2.4.2</b> CV 2</a></li>
<li class="chapter" data-level="5.2.4.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-3-3"><i class="fa fa-check"></i><b>5.2.4.3</b> CV 3</a></li>
<li class="chapter" data-level="5.2.4.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-4-3"><i class="fa fa-check"></i><b>5.2.4.4</b> CV 4</a></li>
<li class="chapter" data-level="5.2.4.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-5-3"><i class="fa fa-check"></i><b>5.2.4.5</b> CV 5</a></li>
<li class="chapter" data-level="5.2.4.6" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-6-3"><i class="fa fa-check"></i><b>5.2.4.6</b> CV 6</a></li>
<li class="chapter" data-level="5.2.4.7" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-7-3"><i class="fa fa-check"></i><b>5.2.4.7</b> CV 7</a></li>
<li class="chapter" data-level="5.2.4.8" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-8-3"><i class="fa fa-check"></i><b>5.2.4.8</b> CV 8</a></li>
<li class="chapter" data-level="5.2.4.9" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-9-3"><i class="fa fa-check"></i><b>5.2.4.9</b> CV 9</a></li>
<li class="chapter" data-level="5.2.4.10" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-10-3"><i class="fa fa-check"></i><b>5.2.4.10</b> CV 10</a></li>
</ul></li>
<li class="chapter" data-level="5.2.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#final-evaluation-3"><i class="fa fa-check"></i><b>5.2.5</b> Final evaluation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cell-penetration-classification-3"><i class="fa fa-check"></i><b>5.3</b> Cell-penetration (classification)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#model-training-4"><i class="fa fa-check"></i><b>5.3.1</b> Model training</a></li>
<li class="chapter" data-level="5.3.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#inner-cross-validation-4"><i class="fa fa-check"></i><b>5.3.2</b> Inner cross-validation</a></li>
<li class="chapter" data-level="5.3.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#model-evaluation-4"><i class="fa fa-check"></i><b>5.3.3</b> Model evaluation</a></li>
<li class="chapter" data-level="5.3.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#inner-loop-model-selection-4"><i class="fa fa-check"></i><b>5.3.4</b> Inner loop model selection</a>
<ul>
<li class="chapter" data-level="5.3.4.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-1-4"><i class="fa fa-check"></i><b>5.3.4.1</b> CV 1</a></li>
<li class="chapter" data-level="5.3.4.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-2-4"><i class="fa fa-check"></i><b>5.3.4.2</b> CV 2</a></li>
<li class="chapter" data-level="5.3.4.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-3-4"><i class="fa fa-check"></i><b>5.3.4.3</b> CV 3</a></li>
<li class="chapter" data-level="5.3.4.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-4-4"><i class="fa fa-check"></i><b>5.3.4.4</b> CV 4</a></li>
<li class="chapter" data-level="5.3.4.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-5-4"><i class="fa fa-check"></i><b>5.3.4.5</b> CV 5</a></li>
<li class="chapter" data-level="5.3.4.6" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-6-4"><i class="fa fa-check"></i><b>5.3.4.6</b> CV 6</a></li>
<li class="chapter" data-level="5.3.4.7" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-7-4"><i class="fa fa-check"></i><b>5.3.4.7</b> CV 7</a></li>
<li class="chapter" data-level="5.3.4.8" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-8-4"><i class="fa fa-check"></i><b>5.3.4.8</b> CV 8</a></li>
<li class="chapter" data-level="5.3.4.9" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-9-4"><i class="fa fa-check"></i><b>5.3.4.9</b> CV 9</a></li>
<li class="chapter" data-level="5.3.4.10" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-10-4"><i class="fa fa-check"></i><b>5.3.4.10</b> CV 10</a></li>
</ul></li>
<li class="chapter" data-level="5.3.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#final-evaluation-4"><i class="fa fa-check"></i><b>5.3.5</b> Final evaluation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#toxicity-classification-3"><i class="fa fa-check"></i><b>5.4</b> Toxicity (classification)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#model-training-5"><i class="fa fa-check"></i><b>5.4.1</b> Model training</a></li>
<li class="chapter" data-level="5.4.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#inner-cross-validation-5"><i class="fa fa-check"></i><b>5.4.2</b> Inner cross-validation</a></li>
<li class="chapter" data-level="5.4.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#model-evaluation-5"><i class="fa fa-check"></i><b>5.4.3</b> Model evaluation</a></li>
<li class="chapter" data-level="5.4.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#inner-loop-model-selection-5"><i class="fa fa-check"></i><b>5.4.4</b> Inner loop model selection</a>
<ul>
<li class="chapter" data-level="5.4.4.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-1-5"><i class="fa fa-check"></i><b>5.4.4.1</b> CV 1</a></li>
<li class="chapter" data-level="5.4.4.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-2-5"><i class="fa fa-check"></i><b>5.4.4.2</b> CV 2</a></li>
<li class="chapter" data-level="5.4.4.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-3-5"><i class="fa fa-check"></i><b>5.4.4.3</b> CV 3</a></li>
<li class="chapter" data-level="5.4.4.4" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-4-5"><i class="fa fa-check"></i><b>5.4.4.4</b> CV 4</a></li>
<li class="chapter" data-level="5.4.4.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-5-5"><i class="fa fa-check"></i><b>5.4.4.5</b> CV 5</a></li>
<li class="chapter" data-level="5.4.4.6" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-6-5"><i class="fa fa-check"></i><b>5.4.4.6</b> CV 6</a></li>
<li class="chapter" data-level="5.4.4.7" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-7-5"><i class="fa fa-check"></i><b>5.4.4.7</b> CV 7</a></li>
<li class="chapter" data-level="5.4.4.8" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-8-5"><i class="fa fa-check"></i><b>5.4.4.8</b> CV 8</a></li>
<li class="chapter" data-level="5.4.4.9" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-9-5"><i class="fa fa-check"></i><b>5.4.4.9</b> CV 9</a></li>
<li class="chapter" data-level="5.4.4.10" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cv-10-5"><i class="fa fa-check"></i><b>5.4.4.10</b> CV 10</a></li>
</ul></li>
<li class="chapter" data-level="5.4.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#final-evaluation-5"><i class="fa fa-check"></i><b>5.4.5</b> Final evaluation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#overall-model-interpretation-1"><i class="fa fa-check"></i><b>5.5</b> Overall model interpretation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#melanin-binding-regression-4"><i class="fa fa-check"></i><b>5.5.1</b> Melanin binding (regression)</a></li>
<li class="chapter" data-level="5.5.2" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#cell-penetration-classification-4"><i class="fa fa-check"></i><b>5.5.2</b> Cell-penetration (classification)</a></li>
<li class="chapter" data-level="5.5.3" data-path="id_05_adversarial_computational_control.html"><a href="id_05_adversarial_computational_control.html#toxicity-classification-4"><i class="fa fa-check"></i><b>5.5.3</b> Toxicity (classification)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html"><i class="fa fa-check"></i><b>6</b> Small data set demo</a>
<ul>
<li class="chapter" data-level="6.1" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#setup"><i class="fa fa-check"></i><b>6.1</b> Setup</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#load-libraries"><i class="fa fa-check"></i><b>6.1.1</b> Load libraries</a></li>
<li class="chapter" data-level="6.1.2" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#aic-functions-1"><i class="fa fa-check"></i><b>6.1.2</b> AIC functions</a></li>
<li class="chapter" data-level="6.1.3" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#model-parameters"><i class="fa fa-check"></i><b>6.1.3</b> Model parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#variable-reduction-3"><i class="fa fa-check"></i><b>6.2</b> Variable reduction</a></li>
<li class="chapter" data-level="6.3" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#model-training-6"><i class="fa fa-check"></i><b>6.3</b> Model training</a></li>
<li class="chapter" data-level="6.4" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#run-pipeline"><i class="fa fa-check"></i><b>6.4</b> Run pipeline</a></li>
<li class="chapter" data-level="6.5" data-path="id_06_small_data_set_demo.html"><a href="id_06_small_data_set_demo.html#session-info"><i class="fa fa-check"></i><b>6.5</b> Session info</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multifunctional peptide engineering</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="id_04_model_validation_and_interpretation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Model validation and interpretation<a href="id_04_model_validation_and_interpretation.html#id_04_model_validation_and_interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb77"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb77-1"><a href="id_04_model_validation_and_interpretation.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(h2o)</span>
<span id="cb77-2"><a href="id_04_model_validation_and_interpretation.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb77-3"><a href="id_04_model_validation_and_interpretation.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb77-4"><a href="id_04_model_validation_and_interpretation.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb77-5"><a href="id_04_model_validation_and_interpretation.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb77-6"><a href="id_04_model_validation_and_interpretation.html#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">use_condaenv</span>(<span class="st">&quot;/Users/renee/Library/r-miniconda/envs/peptide_engineering/bin/python&quot;</span>)</span>
<span id="cb77-7"><a href="id_04_model_validation_and_interpretation.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb77-8"><a href="id_04_model_validation_and_interpretation.html#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb77-9"><a href="id_04_model_validation_and_interpretation.html#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb77-10"><a href="id_04_model_validation_and_interpretation.html#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb77-11"><a href="id_04_model_validation_and_interpretation.html#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb77-12"><a href="id_04_model_validation_and_interpretation.html#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb78-1"><a href="id_04_model_validation_and_interpretation.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> h2o</span>
<span id="cb78-2"><a href="id_04_model_validation_and_interpretation.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb78-3"><a href="id_04_model_validation_and_interpretation.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb78-4"><a href="id_04_model_validation_and_interpretation.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb78-5"><a href="id_04_model_validation_and_interpretation.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb78-6"><a href="id_04_model_validation_and_interpretation.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> session_info</span></code></pre></div>
<div id="model-validation" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Model validation<a href="id_04_model_validation_and_interpretation.html#model-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="melaning-binding" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Melaning binding<a href="id_04_model_validation_and_interpretation.html#melaning-binding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb79-1"><a href="id_04_model_validation_and_interpretation.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ================</span></span>
<span id="cb79-2"><a href="id_04_model_validation_and_interpretation.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted values</span></span>
<span id="cb79-3"><a href="id_04_model_validation_and_interpretation.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ================</span></span>
<span id="cb79-4"><a href="id_04_model_validation_and_interpretation.html#cb79-4" aria-hidden="true" tabindex="-1"></a>mb_pred_ <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb79-5"><a href="id_04_model_validation_and_interpretation.html#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb79-6"><a href="id_04_model_validation_and_interpretation.html#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.0202</span>, <span class="fl">1.3650</span>, <span class="fl">2.1745</span>, <span class="fl">2.3456</span>, <span class="fl">2.5907</span>, <span class="fl">2.6903</span>, <span class="fl">2.9842</span>, <span class="fl">3.1325</span>, <span class="fl">3.5015</span>, <span class="fl">3.6640</span>, <span class="fl">3.7181</span>, <span class="fl">4.0701</span>,</span>
<span id="cb79-7"><a href="id_04_model_validation_and_interpretation.html#cb79-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.3223</span>, <span class="fl">1.5153</span>, <span class="fl">2.1196</span>, <span class="fl">2.4047</span>, <span class="fl">2.5032</span>, <span class="fl">2.8177</span>, <span class="fl">3.0653</span>, <span class="fl">3.1491</span>, <span class="fl">3.5578</span>, <span class="fl">3.6465</span>, <span class="fl">3.5599</span>, <span class="fl">3.9509</span>,</span>
<span id="cb79-8"><a href="id_04_model_validation_and_interpretation.html#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6579</span>, <span class="fl">2.1797</span>, <span class="fl">1.9685</span>, <span class="fl">2.3709</span>, <span class="fl">2.6702</span>, <span class="fl">3.0694</span>, <span class="fl">2.9323</span>, <span class="fl">3.3150</span>, <span class="fl">3.4798</span>, <span class="fl">3.5661</span>, <span class="fl">3.6981</span>, <span class="fl">3.9730</span>,</span>
<span id="cb79-9"><a href="id_04_model_validation_and_interpretation.html#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.0589</span>, <span class="fl">1.3490</span>, <span class="fl">2.4402</span>, <span class="fl">2.1269</span>, <span class="fl">2.5097</span>, <span class="fl">2.6128</span>, <span class="fl">2.9359</span>, <span class="fl">3.3530</span>, <span class="fl">3.8094</span>, <span class="fl">3.5260</span>, <span class="fl">3.7525</span>, <span class="fl">3.8405</span>,</span>
<span id="cb79-10"><a href="id_04_model_validation_and_interpretation.html#cb79-10" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6532</span>, <span class="fl">1.3684</span>, <span class="fl">2.6170</span>, <span class="fl">2.5270</span>, <span class="fl">2.5228</span>, <span class="fl">2.9967</span>, <span class="fl">3.1125</span>, <span class="fl">3.2106</span>, <span class="fl">3.5952</span>, <span class="fl">3.7345</span>, <span class="fl">3.7353</span>, <span class="fl">3.8400</span>,</span>
<span id="cb79-11"><a href="id_04_model_validation_and_interpretation.html#cb79-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.2941</span>, <span class="fl">1.1896</span>, <span class="fl">2.1987</span>, <span class="fl">2.7585</span>, <span class="fl">3.1348</span>, <span class="fl">2.9791</span>, <span class="fl">3.2625</span>, <span class="fl">3.0559</span>, <span class="fl">3.5153</span>, <span class="fl">3.6829</span>, <span class="fl">3.9875</span>, <span class="fl">4.0330</span>,</span>
<span id="cb79-12"><a href="id_04_model_validation_and_interpretation.html#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0156</span>, <span class="fl">1.1113</span>, <span class="fl">1.9551</span>, <span class="fl">2.3677</span>, <span class="fl">2.4250</span>, <span class="fl">4.0111</span>, <span class="fl">3.4891</span>, <span class="fl">3.6521</span>, <span class="fl">3.6634</span>, <span class="fl">3.2731</span>, <span class="fl">3.4504</span>, <span class="fl">3.7587</span>,</span>
<span id="cb79-13"><a href="id_04_model_validation_and_interpretation.html#cb79-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0209</span>, <span class="fl">1.9146</span>, <span class="fl">2.2865</span>, <span class="fl">2.5308</span>, <span class="fl">2.7193</span>, <span class="fl">3.0322</span>, <span class="fl">3.1020</span>, <span class="fl">3.3582</span>, <span class="fl">3.2993</span>, <span class="fl">3.8534</span>, <span class="fl">4.9542</span>, <span class="fl">3.5464</span></span>
<span id="cb79-14"><a href="id_04_model_validation_and_interpretation.html#cb79-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-15"><a href="id_04_model_validation_and_interpretation.html#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb79-16"><a href="id_04_model_validation_and_interpretation.html#cb79-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-17"><a href="id_04_model_validation_and_interpretation.html#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="id_04_model_validation_and_interpretation.html#cb79-18" aria-hidden="true" tabindex="-1"></a>new_mb_pred_ <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-19"><a href="id_04_model_validation_and_interpretation.html#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="fl">3.9318</span>, <span class="fl">3.9366</span>, <span class="fl">3.5531</span>, <span class="fl">3.4385</span>, <span class="fl">3.8434</span>, <span class="fl">3.3893</span>, <span class="fl">4.4159</span>, <span class="fl">4.7549</span>, <span class="fl">4.0004</span>, <span class="fl">3.2785</span>,</span>
<span id="cb79-20"><a href="id_04_model_validation_and_interpretation.html#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="fl">4.5784</span>, <span class="fl">4.6026</span>, <span class="fl">3.6229</span>, <span class="fl">3.8261</span>, <span class="fl">3.6111</span>, <span class="fl">5.0536</span>, <span class="fl">4.8169</span>, <span class="fl">5.9021</span>, <span class="fl">4.0992</span>, <span class="fl">4.3451</span>,</span>
<span id="cb79-21"><a href="id_04_model_validation_and_interpretation.html#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="fl">5.9626</span>, <span class="fl">4.2730</span>, <span class="fl">4.4115</span>, <span class="fl">4.8889</span>, <span class="fl">4.3264</span>, <span class="fl">4.4830</span>, <span class="fl">4.2847</span>, <span class="fl">4.6585</span>, <span class="fl">4.4568</span>, <span class="fl">4.8513</span>,</span>
<span id="cb79-22"><a href="id_04_model_validation_and_interpretation.html#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="fl">4.1523</span></span>
<span id="cb79-23"><a href="id_04_model_validation_and_interpretation.html#cb79-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-24"><a href="id_04_model_validation_and_interpretation.html#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="id_04_model_validation_and_interpretation.html#cb79-25" aria-hidden="true" tabindex="-1"></a>mb_pred <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(mb_pred_), new_mb_pred_)</span>
<span id="cb79-26"><a href="id_04_model_validation_and_interpretation.html#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">127</span>) {</span>
<span id="cb79-27"><a href="id_04_model_validation_and_interpretation.html#cb79-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (mb_pred[i] <span class="sc">&lt;</span> <span class="dv">0</span>) mb_pred[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb79-28"><a href="id_04_model_validation_and_interpretation.html#cb79-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-29"><a href="id_04_model_validation_and_interpretation.html#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-scale to 0-100</span></span>
<span id="cb79-30"><a href="id_04_model_validation_and_interpretation.html#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_mb_train_test_splits.RData&quot;</span>)</span>
<span id="cb79-31"><a href="id_04_model_validation_and_interpretation.html#cb79-31" aria-hidden="true" tabindex="-1"></a>mb_pred <span class="ot">&lt;-</span> <span class="fu">rescale</span>(mb_pred, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">from =</span> <span class="fu">range</span>(mb_data<span class="sc">$</span>log_intensity))</span>
<span id="cb79-32"><a href="id_04_model_validation_and_interpretation.html#cb79-32" aria-hidden="true" tabindex="-1"></a>mb_pred[mb_pred <span class="sc">&gt;</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb79-33"><a href="id_04_model_validation_and_interpretation.html#cb79-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-34"><a href="id_04_model_validation_and_interpretation.html#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================</span></span>
<span id="cb79-35"><a href="id_04_model_validation_and_interpretation.html#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Experimental values</span></span>
<span id="cb79-36"><a href="id_04_model_validation_and_interpretation.html#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================</span></span>
<span id="cb79-37"><a href="id_04_model_validation_and_interpretation.html#cb79-37" aria-hidden="true" tabindex="-1"></a>replicate_1_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb79-38"><a href="id_04_model_validation_and_interpretation.html#cb79-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb79-39"><a href="id_04_model_validation_and_interpretation.html#cb79-39" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.9775</span>, <span class="fl">50.1718</span>, <span class="fl">39.9822</span>, <span class="fl">66.0486</span>, <span class="fl">46.0249</span>, <span class="fl">40.8353</span>, <span class="fl">58.6552</span>, <span class="fl">72.8258</span>, <span class="fl">55.1955</span>, <span class="fl">59.8874</span>, <span class="fl">78.4182</span>, <span class="fl">77.8258</span>,</span>
<span id="cb79-40"><a href="id_04_model_validation_and_interpretation.html#cb79-40" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">3.6197</span>, <span class="fl">25.3377</span>, <span class="fl">56.6884</span>, <span class="fl">58.1339</span>, <span class="sc">-</span><span class="fl">0.8945</span>, <span class="fl">26.5936</span>, <span class="fl">64.4609</span>, <span class="fl">63.2050</span>, <span class="fl">68.3472</span>, <span class="fl">71.3566</span>, <span class="fl">80.4325</span>, <span class="fl">70.3140</span>,</span>
<span id="cb79-41"><a href="id_04_model_validation_and_interpretation.html#cb79-41" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">34.7571</span>, <span class="fl">26.0249</span>, <span class="fl">52.3519</span>, <span class="fl">70.4562</span>, <span class="fl">63.1813</span>, <span class="fl">69.1291</span>, <span class="fl">73.1339</span>, <span class="fl">65.6220</span>, <span class="fl">73.9396</span>, <span class="fl">76.5699</span>, <span class="fl">75.1955</span>, <span class="fl">76.0249</span>,</span>
<span id="cb79-42"><a href="id_04_model_validation_and_interpretation.html#cb79-42" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">1.3922</span>, <span class="fl">35.4325</span>, <span class="fl">4.0344</span>, <span class="fl">16.4514</span>, <span class="fl">28.4656</span>, <span class="fl">38.9870</span>, <span class="fl">71.5699</span>, <span class="fl">66.8306</span>, <span class="fl">71.0723</span>, <span class="fl">45.0059</span>, <span class="fl">83.4182</span>, <span class="fl">75.9301</span>,</span>
<span id="cb79-43"><a href="id_04_model_validation_and_interpretation.html#cb79-43" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">6.0604</span>, <span class="fl">19.9111</span>, <span class="fl">20.2666</span>, <span class="fl">39.2476</span>, <span class="fl">36.3329</span>, <span class="fl">70.1955</span>, <span class="fl">73.9633</span>, <span class="fl">72.4467</span>, <span class="fl">75.5746</span>, <span class="fl">59.9348</span>, <span class="fl">55.4799</span>, <span class="fl">75.8590</span>,</span>
<span id="cb79-44"><a href="id_04_model_validation_and_interpretation.html#cb79-44" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.9727</span>, <span class="fl">28.0628</span>, <span class="sc">-</span><span class="fl">29.7097</span>, <span class="fl">35.4562</span>, <span class="fl">58.8211</span>, <span class="fl">49.7927</span>, <span class="fl">61.7121</span>, <span class="fl">77.8732</span>, <span class="fl">77.2097</span>, <span class="fl">77.2571</span>, <span class="fl">54.8874</span>, <span class="fl">76.0249</span>,</span>
<span id="cb79-45"><a href="id_04_model_validation_and_interpretation.html#cb79-45" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">23.3353</span>, <span class="fl">33.2998</span>, <span class="fl">45.9064</span>, <span class="fl">36.1671</span>, <span class="fl">36.4751</span>, <span class="fl">74.5557</span>, <span class="fl">70.6220</span>, <span class="fl">48.2998</span>, <span class="fl">69.6742</span>, <span class="fl">76.9727</span>, <span class="fl">65.1244</span>, <span class="fl">75.9064</span>,</span>
<span id="cb79-46"><a href="id_04_model_validation_and_interpretation.html#cb79-46" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2.2571</span>, <span class="fl">27.1860</span>, <span class="sc">-</span><span class="fl">1.6055</span>, <span class="fl">42.3519</span>, <span class="fl">48.7500</span>, <span class="fl">47.8969</span>, <span class="fl">62.2334</span>, <span class="fl">70.6220</span>, <span class="fl">79.7927</span>, <span class="fl">75.9538</span>, <span class="fl">77.4467</span>, <span class="fl">81.0960</span></span>
<span id="cb79-47"><a href="id_04_model_validation_and_interpretation.html#cb79-47" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-48"><a href="id_04_model_validation_and_interpretation.html#cb79-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb79-49"><a href="id_04_model_validation_and_interpretation.html#cb79-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-50"><a href="id_04_model_validation_and_interpretation.html#cb79-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-51"><a href="id_04_model_validation_and_interpretation.html#cb79-51" aria-hidden="true" tabindex="-1"></a>replicate_1_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb79-52"><a href="id_04_model_validation_and_interpretation.html#cb79-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb79-53"><a href="id_04_model_validation_and_interpretation.html#cb79-53" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">7.7192</span>, <span class="fl">54.0818</span>, <span class="fl">45.1007</span>, <span class="fl">62.8495</span>, <span class="fl">50.1481</span>, <span class="fl">37.6126</span>, <span class="fl">59.5083</span>, <span class="fl">71.7121</span>, <span class="fl">57.7073</span>, <span class="fl">59.4135</span>, <span class="fl">77.0201</span>, <span class="fl">82.3756</span>,</span>
<span id="cb79-54"><a href="id_04_model_validation_and_interpretation.html#cb79-54" aria-hidden="true" tabindex="-1"></a>    <span class="fl">21.4277</span>, <span class="fl">10.8353</span>, <span class="fl">54.6268</span>, <span class="fl">65.7168</span>, <span class="fl">15.6220</span>, <span class="fl">35.1007</span>, <span class="fl">64.8637</span>, <span class="fl">67.8258</span>, <span class="fl">66.5225</span>, <span class="fl">72.7073</span>, <span class="fl">83.1576</span>, <span class="fl">72.7784</span>,</span>
<span id="cb79-55"><a href="id_04_model_validation_and_interpretation.html#cb79-55" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">53.7855</span>, <span class="fl">2.6600</span>, <span class="fl">42.8732</span>, <span class="fl">32.9443</span>, <span class="fl">48.1576</span>, <span class="fl">71.0960</span>, <span class="fl">73.4656</span>, <span class="fl">66.9964</span>, <span class="fl">72.1386</span>, <span class="fl">78.6789</span>, <span class="fl">78.7500</span>, <span class="fl">77.1386</span>,</span>
<span id="cb79-56"><a href="id_04_model_validation_and_interpretation.html#cb79-56" aria-hidden="true" tabindex="-1"></a>    <span class="fl">34.9822</span>, <span class="fl">37.1623</span>, <span class="fl">25.8590</span>, <span class="fl">34.7453</span>, <span class="fl">36.9964</span>, <span class="fl">54.2239</span>, <span class="fl">72.8969</span>, <span class="fl">67.5415</span>, <span class="fl">73.5604</span>, <span class="fl">52.8021</span>, <span class="fl">88.1339</span>, <span class="fl">80.0296</span>,</span>
<span id="cb79-57"><a href="id_04_model_validation_and_interpretation.html#cb79-57" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.1434</span>, <span class="fl">30.6694</span>, <span class="fl">32.8969</span>, <span class="fl">45.5983</span>, <span class="fl">48.6552</span>, <span class="fl">70.5036</span>, <span class="fl">74.7927</span>, <span class="fl">76.0249</span>, <span class="fl">75.5983</span>, <span class="fl">62.6600</span>, <span class="fl">61.3803</span>, <span class="fl">81.4277</span>,</span>
<span id="cb79-58"><a href="id_04_model_validation_and_interpretation.html#cb79-58" aria-hidden="true" tabindex="-1"></a>    <span class="fl">27.4467</span>, <span class="fl">30.3614</span>, <span class="fl">24.8164</span>, <span class="fl">25.8116</span>, <span class="fl">63.9633</span>, <span class="fl">49.7927</span>, <span class="fl">60.6457</span>, <span class="fl">79.8637</span>, <span class="fl">77.3282</span>, <span class="fl">79.8164</span>, <span class="fl">55.0770</span>, <span class="fl">77.1386</span>,</span>
<span id="cb79-59"><a href="id_04_model_validation_and_interpretation.html#cb79-59" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7.9206</span>, <span class="fl">44.0107</span>, <span class="fl">57.2571</span>, <span class="fl">50.1955</span>, <span class="fl">45.6220</span>, <span class="fl">76.2618</span>, <span class="fl">71.7358</span>, <span class="fl">51.6410</span>, <span class="fl">72.9680</span>, <span class="fl">76.6410</span>, <span class="fl">64.1291</span>, <span class="fl">76.5225</span>,</span>
<span id="cb79-60"><a href="id_04_model_validation_and_interpretation.html#cb79-60" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">3.7618</span>, <span class="fl">32.5178</span>, <span class="fl">28.9159</span>, <span class="fl">47.3756</span>, <span class="fl">50.5983</span>, <span class="fl">49.4609</span>, <span class="fl">62.7547</span>, <span class="fl">71.7358</span>, <span class="fl">83.3709</span>, <span class="fl">81.7832</span>, <span class="fl">83.3235</span>, <span class="fl">82.9917</span></span>
<span id="cb79-61"><a href="id_04_model_validation_and_interpretation.html#cb79-61" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-62"><a href="id_04_model_validation_and_interpretation.html#cb79-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb79-63"><a href="id_04_model_validation_and_interpretation.html#cb79-63" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-64"><a href="id_04_model_validation_and_interpretation.html#cb79-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-65"><a href="id_04_model_validation_and_interpretation.html#cb79-65" aria-hidden="true" tabindex="-1"></a>replicate_2_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb79-66"><a href="id_04_model_validation_and_interpretation.html#cb79-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb79-67"><a href="id_04_model_validation_and_interpretation.html#cb79-67" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">21.6291</span>, <span class="fl">12.7784</span>, <span class="fl">51.7595</span>, <span class="fl">30.0770</span>, <span class="fl">33.6078</span>, <span class="fl">28.2524</span>, <span class="fl">47.4467</span>, <span class="fl">51.8780</span>, <span class="fl">45.4088</span>, <span class="fl">64.9585</span>, <span class="fl">64.9585</span>, <span class="fl">69.3187</span>,</span>
<span id="cb79-68"><a href="id_04_model_validation_and_interpretation.html#cb79-68" aria-hidden="true" tabindex="-1"></a>    <span class="fl">24.2476</span>, <span class="fl">7.0675</span>, <span class="fl">56.8780</span>, <span class="fl">71.7595</span>, <span class="fl">25.8116</span>, <span class="fl">40.1481</span>, <span class="fl">69.2476</span>, <span class="fl">71.3803</span>, <span class="fl">74.9585</span>, <span class="fl">73.1813</span>, <span class="fl">81.8069</span>, <span class="fl">74.8400</span>,</span>
<span id="cb79-69"><a href="id_04_model_validation_and_interpretation.html#cb79-69" aria-hidden="true" tabindex="-1"></a>    <span class="fl">44.5557</span>, <span class="fl">31.2618</span>, <span class="fl">43.6552</span>, <span class="fl">39.0818</span>, <span class="fl">48.3235</span>, <span class="fl">67.8495</span>, <span class="fl">76.2855</span>, <span class="fl">64.5557</span>, <span class="fl">74.5083</span>, <span class="fl">76.0723</span>, <span class="fl">75.4799</span>, <span class="fl">75.5746</span>,</span>
<span id="cb79-70"><a href="id_04_model_validation_and_interpretation.html#cb79-70" aria-hidden="true" tabindex="-1"></a>    <span class="fl">17.3045</span>, <span class="fl">45.8590</span>, <span class="sc">-</span><span class="fl">7.5533</span>, <span class="fl">34.7690</span>, <span class="fl">28.3945</span>, <span class="fl">41.9491</span>, <span class="fl">73.3709</span>, <span class="fl">69.8874</span>, <span class="fl">70.1244</span>, <span class="fl">62.9206</span>, <span class="fl">71.8306</span>, <span class="fl">78.6552</span>,</span>
<span id="cb79-71"><a href="id_04_model_validation_and_interpretation.html#cb79-71" aria-hidden="true" tabindex="-1"></a>    <span class="fl">17.0675</span>, <span class="fl">34.8874</span>, <span class="fl">19.2002</span>, <span class="fl">35.7168</span>, <span class="fl">43.5130</span>, <span class="fl">2.1386</span>, <span class="fl">70.8353</span>, <span class="fl">50.4325</span>, <span class="fl">73.8922</span>, <span class="fl">68.7974</span>, <span class="fl">76.4277</span>, <span class="fl">77.3756</span>,</span>
<span id="cb79-72"><a href="id_04_model_validation_and_interpretation.html#cb79-72" aria-hidden="true" tabindex="-1"></a>    <span class="fl">51.4751</span>, <span class="fl">2.5652</span>, <span class="fl">13.2998</span>, <span class="fl">25.7405</span>, <span class="fl">58.7500</span>, <span class="fl">50.5036</span>, <span class="fl">64.6979</span>, <span class="fl">76.6410</span>, <span class="fl">67.4467</span>, <span class="fl">80.3614</span>, <span class="fl">63.3945</span>, <span class="fl">75.5746</span>,</span>
<span id="cb79-73"><a href="id_04_model_validation_and_interpretation.html#cb79-73" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">41.2500</span>, <span class="fl">44.1528</span>, <span class="fl">51.4040</span>, <span class="fl">35.3377</span>, <span class="fl">57.3993</span>, <span class="fl">78.3945</span>, <span class="fl">72.7784</span>, <span class="fl">56.4751</span>, <span class="fl">75.5746</span>, <span class="fl">74.5320</span>, <span class="fl">68.5604</span>, <span class="fl">75.0533</span>,</span>
<span id="cb79-74"><a href="id_04_model_validation_and_interpretation.html#cb79-74" aria-hidden="true" tabindex="-1"></a>    <span class="fl">15.5036</span>, <span class="fl">31.6173</span>, <span class="fl">11.4040</span>, <span class="fl">49.9111</span>, <span class="fl">49.6505</span>, <span class="fl">48.0865</span>, <span class="fl">61.4040</span>, <span class="fl">72.7784</span>, <span class="fl">79.9822</span>, <span class="fl">77.9443</span>, <span class="fl">71.5699</span>, <span class="fl">79.8164</span></span>
<span id="cb79-75"><a href="id_04_model_validation_and_interpretation.html#cb79-75" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-76"><a href="id_04_model_validation_and_interpretation.html#cb79-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb79-77"><a href="id_04_model_validation_and_interpretation.html#cb79-77" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-78"><a href="id_04_model_validation_and_interpretation.html#cb79-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-79"><a href="id_04_model_validation_and_interpretation.html#cb79-79" aria-hidden="true" tabindex="-1"></a>replicate_2_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb79-80"><a href="id_04_model_validation_and_interpretation.html#cb79-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb79-81"><a href="id_04_model_validation_and_interpretation.html#cb79-81" aria-hidden="true" tabindex="-1"></a>    <span class="fl">13.5367</span>, <span class="fl">25.8827</span>, <span class="fl">48.0628</span>, <span class="fl">76.2855</span>, <span class="fl">58.0628</span>, <span class="fl">54.2713</span>, <span class="fl">69.7927</span>, <span class="fl">78.9633</span>, <span class="fl">55.6457</span>, <span class="fl">78.2287</span>, <span class="fl">80.5983</span>, <span class="fl">83.6789</span>,</span>
<span id="cb79-82"><a href="id_04_model_validation_and_interpretation.html#cb79-82" aria-hidden="true" tabindex="-1"></a>    <span class="fl">51.5699</span>, <span class="fl">6.1671</span>, <span class="fl">50.8116</span>, <span class="fl">73.3472</span>, <span class="fl">28.4419</span>, <span class="fl">26.0960</span>, <span class="fl">73.4893</span>, <span class="fl">76.5699</span>, <span class="fl">74.5320</span>, <span class="fl">78.7263</span>, <span class="fl">85.4799</span>, <span class="fl">80.1718</span>,</span>
<span id="cb79-83"><a href="id_04_model_validation_and_interpretation.html#cb79-83" aria-hidden="true" tabindex="-1"></a>    <span class="fl">41.7595</span>, <span class="fl">48.1339</span>, <span class="fl">39.0818</span>, <span class="fl">43.8211</span>, <span class="fl">47.9917</span>, <span class="fl">65.2429</span>, <span class="fl">79.1765</span>, <span class="fl">73.6078</span>, <span class="fl">78.5604</span>, <span class="fl">82.7547</span>, <span class="fl">81.2855</span>, <span class="fl">82.6126</span>,</span>
<span id="cb79-84"><a href="id_04_model_validation_and_interpretation.html#cb79-84" aria-hidden="true" tabindex="-1"></a>    <span class="fl">38.0154</span>, <span class="fl">30.6931</span>, <span class="fl">42.3045</span>, <span class="fl">41.2145</span>, <span class="fl">30.7642</span>, <span class="fl">57.1386</span>, <span class="fl">75.6220</span>, <span class="fl">70.5746</span>, <span class="fl">72.1386</span>, <span class="fl">66.0960</span>, <span class="fl">78.2287</span>, <span class="fl">80.9775</span>,</span>
<span id="cb79-85"><a href="id_04_model_validation_and_interpretation.html#cb79-85" aria-hidden="true" tabindex="-1"></a>    <span class="fl">19.6742</span>, <span class="fl">25.1481</span>, <span class="fl">36.0012</span>, <span class="fl">28.8685</span>, <span class="fl">33.3472</span>, <span class="fl">70.0533</span>, <span class="fl">73.1102</span>, <span class="fl">55.5509</span>, <span class="fl">73.3945</span>, <span class="fl">74.7216</span>, <span class="fl">80.4325</span>, <span class="fl">80.8827</span>,</span>
<span id="cb79-86"><a href="id_04_model_validation_and_interpretation.html#cb79-86" aria-hidden="true" tabindex="-1"></a>    <span class="fl">46.7832</span>, <span class="fl">28.2050</span>, <span class="fl">30.6220</span>, <span class="fl">30.2903</span>, <span class="fl">60.5036</span>, <span class="fl">34.1291</span>, <span class="fl">66.9964</span>, <span class="fl">77.6363</span>, <span class="fl">76.3803</span>, <span class="fl">85.6694</span>, <span class="fl">68.1102</span>, <span class="fl">82.6126</span>,</span>
<span id="cb79-87"><a href="id_04_model_validation_and_interpretation.html#cb79-87" aria-hidden="true" tabindex="-1"></a>    <span class="fl">6.4040</span>, <span class="fl">24.1528</span>, <span class="fl">64.3661</span>, <span class="fl">47.6126</span>, <span class="fl">63.5604</span>, <span class="fl">81.3566</span>, <span class="fl">79.8164</span>, <span class="fl">61.2382</span>, <span class="fl">78.0628</span>, <span class="fl">78.5604</span>, <span class="fl">70.7405</span>, <span class="fl">76.9017</span>,</span>
<span id="cb79-88"><a href="id_04_model_validation_and_interpretation.html#cb79-88" aria-hidden="true" tabindex="-1"></a>    <span class="fl">25.3140</span>, <span class="fl">42.5889</span>, <span class="fl">40.6694</span>, <span class="fl">50.2192</span>, <span class="fl">53.0154</span>, <span class="fl">47.0912</span>, <span class="fl">66.6173</span>, <span class="fl">79.8164</span>, <span class="fl">83.3709</span>, <span class="fl">82.6363</span>, <span class="fl">77.1623</span>, <span class="fl">84.3898</span></span>
<span id="cb79-89"><a href="id_04_model_validation_and_interpretation.html#cb79-89" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-90"><a href="id_04_model_validation_and_interpretation.html#cb79-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb79-91"><a href="id_04_model_validation_and_interpretation.html#cb79-91" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-92"><a href="id_04_model_validation_and_interpretation.html#cb79-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-93"><a href="id_04_model_validation_and_interpretation.html#cb79-93" aria-hidden="true" tabindex="-1"></a>replicate_1_1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(replicate_1_1)</span>
<span id="cb79-94"><a href="id_04_model_validation_and_interpretation.html#cb79-94" aria-hidden="true" tabindex="-1"></a>replicate_1_2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(replicate_1_2)</span>
<span id="cb79-95"><a href="id_04_model_validation_and_interpretation.html#cb79-95" aria-hidden="true" tabindex="-1"></a>replicate_2_1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(replicate_2_1)</span>
<span id="cb79-96"><a href="id_04_model_validation_and_interpretation.html#cb79-96" aria-hidden="true" tabindex="-1"></a>replicate_2_2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(replicate_2_2)</span>
<span id="cb79-97"><a href="id_04_model_validation_and_interpretation.html#cb79-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-98"><a href="id_04_model_validation_and_interpretation.html#cb79-98" aria-hidden="true" tabindex="-1"></a>mb_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb79-99"><a href="id_04_model_validation_and_interpretation.html#cb79-99" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">96</span>) {</span>
<span id="cb79-100"><a href="id_04_model_validation_and_interpretation.html#cb79-100" aria-hidden="true" tabindex="-1"></a>  res_ <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(</span>
<span id="cb79-101"><a href="id_04_model_validation_and_interpretation.html#cb79-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(<span class="fu">c</span>(replicate_1_1[i], replicate_1_2[i])),</span>
<span id="cb79-102"><a href="id_04_model_validation_and_interpretation.html#cb79-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(<span class="fu">c</span>(replicate_2_1[i], replicate_2_2[i]))</span>
<span id="cb79-103"><a href="id_04_model_validation_and_interpretation.html#cb79-103" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb79-104"><a href="id_04_model_validation_and_interpretation.html#cb79-104" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (res_ <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb79-105"><a href="id_04_model_validation_and_interpretation.html#cb79-105" aria-hidden="true" tabindex="-1"></a>    mb_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(mb_true_, res_)</span>
<span id="cb79-106"><a href="id_04_model_validation_and_interpretation.html#cb79-106" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb79-107"><a href="id_04_model_validation_and_interpretation.html#cb79-107" aria-hidden="true" tabindex="-1"></a>    mb_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(mb_true_, <span class="cn">NA</span>)</span>
<span id="cb79-108"><a href="id_04_model_validation_and_interpretation.html#cb79-108" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-109"><a href="id_04_model_validation_and_interpretation.html#cb79-109" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-110"><a href="id_04_model_validation_and_interpretation.html#cb79-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-111"><a href="id_04_model_validation_and_interpretation.html#cb79-111" aria-hidden="true" tabindex="-1"></a>new_replicate_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-112"><a href="id_04_model_validation_and_interpretation.html#cb79-112" aria-hidden="true" tabindex="-1"></a>  <span class="fl">79.9064</span>, <span class="fl">80.2179</span>, <span class="fl">75.9474</span>, <span class="fl">79.1975</span>, <span class="fl">71.6238</span>, <span class="fl">53.5235</span>, <span class="fl">83.5678</span>, <span class="fl">81.2452</span>, <span class="fl">74.2512</span>, <span class="fl">68.4291</span>,</span>
<span id="cb79-113"><a href="id_04_model_validation_and_interpretation.html#cb79-113" aria-hidden="true" tabindex="-1"></a>  <span class="fl">90.2855</span>, <span class="fl">89.2512</span>, <span class="fl">92.8356</span>, <span class="fl">80.2853</span>, <span class="fl">62.0912</span>, <span class="fl">89.2853</span>, <span class="fl">70.1267</span>, <span class="fl">90.2891</span>, <span class="fl">63.2853</span>, <span class="fl">70.6812</span>,</span>
<span id="cb79-114"><a href="id_04_model_validation_and_interpretation.html#cb79-114" aria-hidden="true" tabindex="-1"></a>  <span class="fl">89.2582</span>, <span class="fl">85.2567</span>, <span class="fl">78.3682</span>, <span class="fl">90.5732</span>, <span class="fl">82.5253</span>, <span class="fl">84.2912</span>, <span class="fl">82.5923</span>, <span class="fl">90.8613</span>, <span class="fl">73.2862</span>, <span class="fl">90.4823</span>,</span>
<span id="cb79-115"><a href="id_04_model_validation_and_interpretation.html#cb79-115" aria-hidden="true" tabindex="-1"></a>  <span class="fl">59.2715</span></span>
<span id="cb79-116"><a href="id_04_model_validation_and_interpretation.html#cb79-116" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-117"><a href="id_04_model_validation_and_interpretation.html#cb79-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-118"><a href="id_04_model_validation_and_interpretation.html#cb79-118" aria-hidden="true" tabindex="-1"></a>new_replicate_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-119"><a href="id_04_model_validation_and_interpretation.html#cb79-119" aria-hidden="true" tabindex="-1"></a>  <span class="fl">77.6257</span>, <span class="fl">82.2692</span>, <span class="fl">71.8684</span>, <span class="fl">79.1338</span>, <span class="fl">67.7994</span>, <span class="fl">52.3258</span>, <span class="fl">88.2912</span>, <span class="fl">79.6823</span>, <span class="fl">78.5257</span>, <span class="fl">62.5212</span>,</span>
<span id="cb79-120"><a href="id_04_model_validation_and_interpretation.html#cb79-120" aria-hidden="true" tabindex="-1"></a>  <span class="fl">81.2842</span>, <span class="fl">83.5812</span>, <span class="fl">90.2512</span>, <span class="fl">73.4821</span>, <span class="fl">63.6843</span>, <span class="fl">88.2965</span>, <span class="fl">72.0582</span>, <span class="fl">93.1925</span>, <span class="fl">62.9142</span>, <span class="fl">78.0396</span>,</span>
<span id="cb79-121"><a href="id_04_model_validation_and_interpretation.html#cb79-121" aria-hidden="true" tabindex="-1"></a>  <span class="fl">86.9323</span>, <span class="fl">82.5323</span>, <span class="fl">72.6429</span>, <span class="fl">83.6736</span>, <span class="fl">89.5191</span>, <span class="fl">86.8432</span>, <span class="fl">81.5171</span>, <span class="fl">92.1856</span>, <span class="fl">92.6736</span>, <span class="fl">93.9124</span>,</span>
<span id="cb79-122"><a href="id_04_model_validation_and_interpretation.html#cb79-122" aria-hidden="true" tabindex="-1"></a>  <span class="fl">95.3929</span></span>
<span id="cb79-123"><a href="id_04_model_validation_and_interpretation.html#cb79-123" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-124"><a href="id_04_model_validation_and_interpretation.html#cb79-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-125"><a href="id_04_model_validation_and_interpretation.html#cb79-125" aria-hidden="true" tabindex="-1"></a>new_replicate_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-126"><a href="id_04_model_validation_and_interpretation.html#cb79-126" aria-hidden="true" tabindex="-1"></a>  <span class="fl">79.7602</span>, <span class="fl">83.5192</span>, <span class="fl">74.6645</span>, <span class="fl">80.8854</span>, <span class="fl">67.3918</span>, <span class="fl">49.5821</span>, <span class="fl">93.1263</span>, <span class="fl">84.2590</span>, <span class="fl">76.9253</span>, <span class="fl">60.4827</span>,</span>
<span id="cb79-127"><a href="id_04_model_validation_and_interpretation.html#cb79-127" aria-hidden="true" tabindex="-1"></a>  <span class="fl">93.4825</span>, <span class="fl">85.9901</span>, <span class="fl">88.5705</span>, <span class="fl">79.0125</span>, <span class="fl">60.1825</span>, <span class="fl">90.5812</span>, <span class="fl">71.2281</span>, <span class="fl">89.9251</span>, <span class="fl">64.2681</span>, <span class="fl">72.5712</span>,</span>
<span id="cb79-128"><a href="id_04_model_validation_and_interpretation.html#cb79-128" aria-hidden="true" tabindex="-1"></a>  <span class="fl">83.9235</span>, <span class="fl">84.2719</span>, <span class="fl">71.1281</span>, <span class="fl">95.2182</span>, <span class="fl">90.0191</span>, <span class="fl">89.1812</span>, <span class="fl">82.7195</span>, <span class="fl">89.9501</span>, <span class="fl">83.8581</span>, <span class="fl">85.3725</span>,</span>
<span id="cb79-129"><a href="id_04_model_validation_and_interpretation.html#cb79-129" aria-hidden="true" tabindex="-1"></a>  <span class="fl">93.2801</span></span>
<span id="cb79-130"><a href="id_04_model_validation_and_interpretation.html#cb79-130" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-131"><a href="id_04_model_validation_and_interpretation.html#cb79-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-132"><a href="id_04_model_validation_and_interpretation.html#cb79-132" aria-hidden="true" tabindex="-1"></a>new_mb_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb79-133"><a href="id_04_model_validation_and_interpretation.html#cb79-133" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>) {</span>
<span id="cb79-134"><a href="id_04_model_validation_and_interpretation.html#cb79-134" aria-hidden="true" tabindex="-1"></a>  res_ <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(new_replicate_1[i], new_replicate_2[i], new_replicate_3[i]))</span>
<span id="cb79-135"><a href="id_04_model_validation_and_interpretation.html#cb79-135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (res_ <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb79-136"><a href="id_04_model_validation_and_interpretation.html#cb79-136" aria-hidden="true" tabindex="-1"></a>    new_mb_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(new_mb_true_, res_)</span>
<span id="cb79-137"><a href="id_04_model_validation_and_interpretation.html#cb79-137" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb79-138"><a href="id_04_model_validation_and_interpretation.html#cb79-138" aria-hidden="true" tabindex="-1"></a>    new_mb_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(new_mb_true_, <span class="cn">NA</span>)</span>
<span id="cb79-139"><a href="id_04_model_validation_and_interpretation.html#cb79-139" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-140"><a href="id_04_model_validation_and_interpretation.html#cb79-140" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-141"><a href="id_04_model_validation_and_interpretation.html#cb79-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-142"><a href="id_04_model_validation_and_interpretation.html#cb79-142" aria-hidden="true" tabindex="-1"></a>mb_true <span class="ot">&lt;-</span> <span class="fu">c</span>(mb_true_, new_mb_true_)</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb80-1"><a href="id_04_model_validation_and_interpretation.html#cb80-1" aria-hidden="true" tabindex="-1"></a>mb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mb_pred =</span> mb_pred, <span class="at">mb_true =</span> mb_true)</span>
<span id="cb80-2"><a href="id_04_model_validation_and_interpretation.html#cb80-2" aria-hidden="true" tabindex="-1"></a>mb_df <span class="ot">&lt;-</span> mb_df[<span class="fu">complete.cases</span>(mb_df), ]</span>
<span id="cb80-3"><a href="id_04_model_validation_and_interpretation.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="id_04_model_validation_and_interpretation.html#cb80-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(mb_df,</span>
<span id="cb80-5"><a href="id_04_model_validation_and_interpretation.html#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;mb_pred&quot;</span>, <span class="at">y =</span> <span class="st">&quot;mb_true&quot;</span>,</span>
<span id="cb80-6"><a href="id_04_model_validation_and_interpretation.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">stroke =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb80-7"><a href="id_04_model_validation_and_interpretation.html#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.int.level =</span> <span class="fl">0.95</span>, <span class="at">cor.coef =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-8"><a href="id_04_model_validation_and_interpretation.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>),</span>
<span id="cb80-9"><a href="id_04_model_validation_and_interpretation.html#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor.coeff.args =</span> <span class="fu">list</span>(</span>
<span id="cb80-10"><a href="id_04_model_validation_and_interpretation.html#cb80-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="dv">2</span>, <span class="at">label.y =</span> <span class="dv">95</span>, <span class="at">label.sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb80-11"><a href="id_04_model_validation_and_interpretation.html#cb80-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">4.5</span></span>
<span id="cb80-12"><a href="id_04_model_validation_and_interpretation.html#cb80-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-13"><a href="id_04_model_validation_and_interpretation.html#cb80-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb80-14"><a href="id_04_model_validation_and_interpretation.html#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb80-15"><a href="id_04_model_validation_and_interpretation.html#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb80-16"><a href="id_04_model_validation_and_interpretation.html#cb80-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-17"><a href="id_04_model_validation_and_interpretation.html#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-18"><a href="id_04_model_validation_and_interpretation.html#cb80-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-19"><a href="id_04_model_validation_and_interpretation.html#cb80-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-20"><a href="id_04_model_validation_and_interpretation.html#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-21"><a href="id_04_model_validation_and_interpretation.html#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb80-22"><a href="id_04_model_validation_and_interpretation.html#cb80-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb80-23"><a href="id_04_model_validation_and_interpretation.html#cb80-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb80-24"><a href="id_04_model_validation_and_interpretation.html#cb80-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb80-25"><a href="id_04_model_validation_and_interpretation.html#cb80-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-26"><a href="id_04_model_validation_and_interpretation.html#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted peptide bound</span><span class="sc">\n</span><span class="st">to b-mNPs (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-27"><a href="id_04_model_validation_and_interpretation.html#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Measured peptide bound</span><span class="sc">\n</span><span class="st">to mNPs (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-28"><a href="id_04_model_validation_and_interpretation.html#cb80-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">105</span>) <span class="sc">+</span></span>
<span id="cb80-29"><a href="id_04_model_validation_and_interpretation.html#cb80-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">105</span>)</span></code></pre></div>
<p><img src="figures/Fig%203%20mb%20validation.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="melanin-binding-and-cell-penetration" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Melanin binding and cell-penetration<a href="id_04_model_validation_and_interpretation.html#melanin-binding-and-cell-penetration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb81-1"><a href="id_04_model_validation_and_interpretation.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ================</span></span>
<span id="cb81-2"><a href="id_04_model_validation_and_interpretation.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted values</span></span>
<span id="cb81-3"><a href="id_04_model_validation_and_interpretation.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ================</span></span>
<span id="cb81-4"><a href="id_04_model_validation_and_interpretation.html#cb81-4" aria-hidden="true" tabindex="-1"></a>cpp_pred_ <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-5"><a href="id_04_model_validation_and_interpretation.html#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-6"><a href="id_04_model_validation_and_interpretation.html#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-7"><a href="id_04_model_validation_and_interpretation.html#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-8"><a href="id_04_model_validation_and_interpretation.html#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-9"><a href="id_04_model_validation_and_interpretation.html#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-10"><a href="id_04_model_validation_and_interpretation.html#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-11"><a href="id_04_model_validation_and_interpretation.html#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-12"><a href="id_04_model_validation_and_interpretation.html#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-13"><a href="id_04_model_validation_and_interpretation.html#cb81-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span></span>
<span id="cb81-14"><a href="id_04_model_validation_and_interpretation.html#cb81-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-15"><a href="id_04_model_validation_and_interpretation.html#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-16"><a href="id_04_model_validation_and_interpretation.html#cb81-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-17"><a href="id_04_model_validation_and_interpretation.html#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="id_04_model_validation_and_interpretation.html#cb81-18" aria-hidden="true" tabindex="-1"></a>new_cpp_pred_ <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-19"><a href="id_04_model_validation_and_interpretation.html#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-20"><a href="id_04_model_validation_and_interpretation.html#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-21"><a href="id_04_model_validation_and_interpretation.html#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>,</span>
<span id="cb81-22"><a href="id_04_model_validation_and_interpretation.html#cb81-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CPP&quot;</span></span>
<span id="cb81-23"><a href="id_04_model_validation_and_interpretation.html#cb81-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-24"><a href="id_04_model_validation_and_interpretation.html#cb81-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-25"><a href="id_04_model_validation_and_interpretation.html#cb81-25" aria-hidden="true" tabindex="-1"></a>cpp_pred <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(cpp_pred_), new_cpp_pred_)</span>
<span id="cb81-26"><a href="id_04_model_validation_and_interpretation.html#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="id_04_model_validation_and_interpretation.html#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================</span></span>
<span id="cb81-28"><a href="id_04_model_validation_and_interpretation.html#cb81-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Experimental values</span></span>
<span id="cb81-29"><a href="id_04_model_validation_and_interpretation.html#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================</span></span>
<span id="cb81-30"><a href="id_04_model_validation_and_interpretation.html#cb81-30" aria-hidden="true" tabindex="-1"></a>non_induced_replicate_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-31"><a href="id_04_model_validation_and_interpretation.html#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-32"><a href="id_04_model_validation_and_interpretation.html#cb81-32" aria-hidden="true" tabindex="-1"></a>    <span class="fl">31.3344</span>, <span class="fl">24.1344</span>, <span class="fl">25.3344</span>, <span class="fl">45.4944</span>, <span class="fl">16.0944</span>, <span class="fl">146.6544</span>, <span class="fl">20.2944</span>, <span class="fl">18.9744</span>, <span class="fl">15.3744</span>, <span class="fl">12.0144</span>, <span class="fl">19.8144</span>, <span class="fl">15.3744</span>,</span>
<span id="cb81-33"><a href="id_04_model_validation_and_interpretation.html#cb81-33" aria-hidden="true" tabindex="-1"></a>    <span class="fl">20.8944</span>, <span class="fl">20.1744</span>, <span class="fl">17.2944</span>, <span class="fl">63.1344</span>, <span class="fl">15.6144</span>, <span class="fl">15.6144</span>, <span class="fl">32.4144</span>, <span class="fl">16.5744</span>, <span class="fl">17.7744</span>, <span class="fl">12.1344</span>, <span class="fl">14.7744</span>, <span class="fl">55.9344</span>,</span>
<span id="cb81-34"><a href="id_04_model_validation_and_interpretation.html#cb81-34" aria-hidden="true" tabindex="-1"></a>    <span class="fl">19.4544</span>, <span class="fl">21.3744</span>, <span class="fl">29.1744</span>, <span class="fl">25.9344</span>, <span class="fl">89.5344</span>, <span class="fl">14.8944</span>, <span class="fl">19.9344</span>, <span class="fl">11.4144</span>, <span class="fl">29.5344</span>, <span class="fl">13.5744</span>, <span class="fl">13.3344</span>, <span class="fl">33.9744</span>,</span>
<span id="cb81-35"><a href="id_04_model_validation_and_interpretation.html#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="fl">13.2144</span>, <span class="fl">8.1744</span>, <span class="fl">29.7744</span>, <span class="sc">-</span><span class="fl">24.8256</span>, <span class="fl">14.2944</span>, <span class="fl">18.4944</span>, <span class="fl">15.7344</span>, <span class="fl">14.6544</span>, <span class="fl">14.1744</span>, <span class="fl">10.9344</span>, <span class="fl">9.1344</span>, <span class="fl">55.6944</span>,</span>
<span id="cb81-36"><a href="id_04_model_validation_and_interpretation.html#cb81-36" aria-hidden="true" tabindex="-1"></a>    <span class="fl">13.9344</span>, <span class="fl">12.8544</span>, <span class="fl">36.7344</span>, <span class="fl">20.8944</span>, <span class="fl">15.2544</span>, <span class="fl">17.5344</span>, <span class="fl">13.3344</span>, <span class="fl">17.4144</span>, <span class="fl">20.7744</span>, <span class="fl">10.9344</span>, <span class="fl">15.8544</span>, <span class="fl">19.4544</span>,</span>
<span id="cb81-37"><a href="id_04_model_validation_and_interpretation.html#cb81-37" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10.4544</span>, <span class="fl">20.2944</span>, <span class="fl">25.9344</span>, <span class="fl">19.9344</span>, <span class="fl">18.8544</span>, <span class="fl">15.8544</span>, <span class="fl">15.7344</span>, <span class="fl">20.2944</span>, <span class="fl">13.4544</span>, <span class="fl">7.5744</span>, <span class="fl">11.7744</span>, <span class="fl">33.9744</span>,</span>
<span id="cb81-38"><a href="id_04_model_validation_and_interpretation.html#cb81-38" aria-hidden="true" tabindex="-1"></a>    <span class="fl">17.7744</span>, <span class="fl">24.8544</span>, <span class="fl">23.6544</span>, <span class="fl">19.5744</span>, <span class="fl">19.9344</span>, <span class="fl">77.5344</span>, <span class="fl">24.0144</span>, <span class="fl">24.8544</span>, <span class="fl">24.4944</span>, <span class="fl">29.5344</span>, <span class="fl">31.5744</span>, <span class="fl">53.8944</span>,</span>
<span id="cb81-39"><a href="id_04_model_validation_and_interpretation.html#cb81-39" aria-hidden="true" tabindex="-1"></a>    <span class="fl">9.7344</span>, <span class="fl">10.5744</span>, <span class="fl">25.3344</span>, <span class="fl">15.7344</span>, <span class="fl">27.9744</span>, <span class="fl">27.4944</span>, <span class="fl">19.6944</span>, <span class="fl">19.4544</span>, <span class="fl">27.4944</span>, <span class="fl">24.4944</span>, <span class="fl">24.6144</span>, <span class="fl">26.2944</span></span>
<span id="cb81-40"><a href="id_04_model_validation_and_interpretation.html#cb81-40" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-41"><a href="id_04_model_validation_and_interpretation.html#cb81-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-42"><a href="id_04_model_validation_and_interpretation.html#cb81-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-43"><a href="id_04_model_validation_and_interpretation.html#cb81-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-44"><a href="id_04_model_validation_and_interpretation.html#cb81-44" aria-hidden="true" tabindex="-1"></a>non_induced_replicate_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-45"><a href="id_04_model_validation_and_interpretation.html#cb81-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-46"><a href="id_04_model_validation_and_interpretation.html#cb81-46" aria-hidden="true" tabindex="-1"></a>    <span class="fl">30.3744</span>, <span class="fl">28.4544</span>, <span class="fl">26.1744</span>, <span class="fl">30.0144</span>, <span class="fl">25.6944</span>, <span class="fl">131.5344</span>, <span class="fl">31.8144</span>, <span class="fl">21.9744</span>, <span class="fl">30.4944</span>, <span class="fl">20.2944</span>, <span class="fl">17.7744</span>, <span class="fl">26.7744</span>,</span>
<span id="cb81-47"><a href="id_04_model_validation_and_interpretation.html#cb81-47" aria-hidden="true" tabindex="-1"></a>    <span class="fl">27.4944</span>, <span class="fl">20.6544</span>, <span class="fl">21.3744</span>, <span class="fl">44.2944</span>, <span class="fl">23.6544</span>, <span class="fl">28.5744</span>, <span class="fl">26.5344</span>, <span class="fl">22.0944</span>, <span class="fl">26.7744</span>, <span class="fl">17.5344</span>, <span class="fl">18.9744</span>, <span class="fl">63.0144</span>,</span>
<span id="cb81-48"><a href="id_04_model_validation_and_interpretation.html#cb81-48" aria-hidden="true" tabindex="-1"></a>    <span class="fl">25.6944</span>, <span class="fl">22.8144</span>, <span class="fl">27.6144</span>, <span class="fl">26.7744</span>, <span class="fl">88.9344</span>, <span class="fl">30.8544</span>, <span class="fl">24.1344</span>, <span class="fl">10.9344</span>, <span class="fl">19.9344</span>, <span class="fl">19.5744</span>, <span class="fl">21.4944</span>, <span class="fl">25.2144</span>,</span>
<span id="cb81-49"><a href="id_04_model_validation_and_interpretation.html#cb81-49" aria-hidden="true" tabindex="-1"></a>    <span class="fl">12.9744</span>, <span class="fl">15.0144</span>, <span class="fl">17.7744</span>, <span class="fl">14.8944</span>, <span class="fl">13.5744</span>, <span class="fl">24.4944</span>, <span class="fl">27.6144</span>, <span class="fl">13.9344</span>, <span class="fl">23.1744</span>, <span class="fl">17.7744</span>, <span class="fl">15.7344</span>, <span class="fl">45.6144</span>,</span>
<span id="cb81-50"><a href="id_04_model_validation_and_interpretation.html#cb81-50" aria-hidden="true" tabindex="-1"></a>    <span class="fl">16.0944</span>, <span class="fl">23.1744</span>, <span class="fl">17.7744</span>, <span class="fl">15.7344</span>, <span class="fl">20.6544</span>, <span class="fl">27.6144</span>, <span class="fl">34.0944</span>, <span class="fl">24.6144</span>, <span class="fl">22.8144</span>, <span class="fl">14.4144</span>, <span class="fl">26.7744</span>, <span class="fl">25.6944</span>,</span>
<span id="cb81-51"><a href="id_04_model_validation_and_interpretation.html#cb81-51" aria-hidden="true" tabindex="-1"></a>    <span class="fl">12.0144</span>, <span class="fl">31.8144</span>, <span class="fl">16.4544</span>, <span class="fl">21.6144</span>, <span class="fl">30.2544</span>, <span class="fl">18.7344</span>, <span class="fl">24.9744</span>, <span class="fl">29.7744</span>, <span class="fl">15.1344</span>, <span class="fl">15.1344</span>, <span class="fl">27.8544</span>, <span class="fl">25.2144</span>,</span>
<span id="cb81-52"><a href="id_04_model_validation_and_interpretation.html#cb81-52" aria-hidden="true" tabindex="-1"></a>    <span class="fl">23.2944</span>, <span class="fl">28.2144</span>, <span class="fl">30.6144</span>, <span class="fl">22.0944</span>, <span class="fl">19.9344</span>, <span class="fl">63.0144</span>, <span class="fl">22.8144</span>, <span class="fl">22.2144</span>, <span class="fl">21.6144</span>, <span class="fl">19.9344</span>, <span class="fl">23.0544</span>, <span class="fl">30.9744</span>,</span>
<span id="cb81-53"><a href="id_04_model_validation_and_interpretation.html#cb81-53" aria-hidden="true" tabindex="-1"></a>    <span class="fl">14.0544</span>, <span class="fl">23.7744</span>, <span class="fl">20.6544</span>, <span class="fl">11.0544</span>, <span class="fl">23.8944</span>, <span class="fl">31.4544</span>, <span class="fl">20.6544</span>, <span class="fl">15.4944</span>, <span class="fl">31.4544</span>, <span class="fl">26.0544</span>, <span class="fl">33.0144</span>, <span class="fl">37.0944</span></span>
<span id="cb81-54"><a href="id_04_model_validation_and_interpretation.html#cb81-54" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-55"><a href="id_04_model_validation_and_interpretation.html#cb81-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-56"><a href="id_04_model_validation_and_interpretation.html#cb81-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-57"><a href="id_04_model_validation_and_interpretation.html#cb81-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-58"><a href="id_04_model_validation_and_interpretation.html#cb81-58" aria-hidden="true" tabindex="-1"></a>non_induced_replicate_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-59"><a href="id_04_model_validation_and_interpretation.html#cb81-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-60"><a href="id_04_model_validation_and_interpretation.html#cb81-60" aria-hidden="true" tabindex="-1"></a>    <span class="fl">27.3744</span>, <span class="fl">16.3344</span>, <span class="fl">17.5344</span>, <span class="fl">33.7344</span>, <span class="fl">13.8144</span>, <span class="fl">110.8944</span>, <span class="fl">33.4944</span>, <span class="fl">37.2144</span>, <span class="fl">34.8144</span>, <span class="fl">20.8944</span>, <span class="fl">39.4944</span>, <span class="fl">36.1344</span>,</span>
<span id="cb81-61"><a href="id_04_model_validation_and_interpretation.html#cb81-61" aria-hidden="true" tabindex="-1"></a>    <span class="fl">15.9744</span>, <span class="fl">13.4544</span>, <span class="fl">18.6144</span>, <span class="fl">28.2144</span>, <span class="fl">13.0944</span>, <span class="fl">12.8544</span>, <span class="fl">46.3344</span>, <span class="fl">27.6144</span>, <span class="fl">64.6944</span>, <span class="fl">3.4944</span>, <span class="fl">25.5744</span>, <span class="fl">40.8144</span>,</span>
<span id="cb81-62"><a href="id_04_model_validation_and_interpretation.html#cb81-62" aria-hidden="true" tabindex="-1"></a>    <span class="fl">13.8144</span>, <span class="fl">13.5744</span>, <span class="fl">35.7744</span>, <span class="fl">16.4544</span>, <span class="fl">54.4944</span>, <span class="fl">14.2944</span>, <span class="fl">30.7344</span>, <span class="fl">23.6544</span>, <span class="fl">41.0544</span>, <span class="fl">8.5344</span>, <span class="fl">23.1744</span>, <span class="fl">52.2144</span>,</span>
<span id="cb81-63"><a href="id_04_model_validation_and_interpretation.html#cb81-63" aria-hidden="true" tabindex="-1"></a>    <span class="fl">32.5344</span>, <span class="fl">19.4544</span>, <span class="fl">27.2544</span>, <span class="fl">27.1344</span>, <span class="fl">20.5344</span>, <span class="fl">27.3744</span>, <span class="fl">30.6144</span>, <span class="fl">25.6944</span>, <span class="fl">27.1344</span>, <span class="fl">28.3344</span>, <span class="fl">29.4144</span>, <span class="fl">27.3744</span>,</span>
<span id="cb81-64"><a href="id_04_model_validation_and_interpretation.html#cb81-64" aria-hidden="true" tabindex="-1"></a>    <span class="fl">30.0144</span>, <span class="fl">19.5744</span>, <span class="fl">31.3344</span>, <span class="fl">31.9344</span>, <span class="fl">25.6944</span>, <span class="fl">26.7744</span>, <span class="fl">36.4944</span>, <span class="fl">25.8144</span>, <span class="fl">35.2944</span>, <span class="fl">7.8144</span>, <span class="fl">45.1344</span>, <span class="fl">21.7344</span>,</span>
<span id="cb81-65"><a href="id_04_model_validation_and_interpretation.html#cb81-65" aria-hidden="true" tabindex="-1"></a>    <span class="fl">19.4544</span>, <span class="fl">33.4944</span>, <span class="fl">22.8144</span>, <span class="fl">19.8144</span>, <span class="fl">21.9744</span>, <span class="fl">22.8144</span>, <span class="fl">24.8544</span>, <span class="fl">29.4144</span>, <span class="fl">31.3344</span>, <span class="fl">33.3744</span>, <span class="fl">42.9744</span>, <span class="fl">52.2144</span>,</span>
<span id="cb81-66"><a href="id_04_model_validation_and_interpretation.html#cb81-66" aria-hidden="true" tabindex="-1"></a>    <span class="fl">12.4944</span>, <span class="fl">15.3744</span>, <span class="fl">27.3744</span>, <span class="fl">10.4544</span>, <span class="fl">7.9344</span>, <span class="fl">64.3344</span>, <span class="fl">36.0144</span>, <span class="fl">68.7744</span>, <span class="fl">27.6144</span>, <span class="fl">41.0544</span>, <span class="fl">47.5344</span>, <span class="fl">70.2144</span>,</span>
<span id="cb81-67"><a href="id_04_model_validation_and_interpretation.html#cb81-67" aria-hidden="true" tabindex="-1"></a>    <span class="fl">20.4144</span>, <span class="fl">10.8144</span>, <span class="fl">28.0944</span>, <span class="fl">20.5344</span>, <span class="fl">29.0544</span>, <span class="fl">37.2144</span>, <span class="fl">27.9744</span>, <span class="fl">14.1744</span>, <span class="fl">37.2144</span>, <span class="fl">29.4144</span>, <span class="fl">23.1744</span>, <span class="fl">25.5744</span></span>
<span id="cb81-68"><a href="id_04_model_validation_and_interpretation.html#cb81-68" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-69"><a href="id_04_model_validation_and_interpretation.html#cb81-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-70"><a href="id_04_model_validation_and_interpretation.html#cb81-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-71"><a href="id_04_model_validation_and_interpretation.html#cb81-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-72"><a href="id_04_model_validation_and_interpretation.html#cb81-72" aria-hidden="true" tabindex="-1"></a>non_induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-73"><a href="id_04_model_validation_and_interpretation.html#cb81-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">96</span>) {</span>
<span id="cb81-74"><a href="id_04_model_validation_and_interpretation.html#cb81-74" aria-hidden="true" tabindex="-1"></a>  res_ <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(non_induced_replicate_1[i], non_induced_replicate_2[i], non_induced_replicate_3[i]))</span>
<span id="cb81-75"><a href="id_04_model_validation_and_interpretation.html#cb81-75" aria-hidden="true" tabindex="-1"></a>  non_induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(non_induced_true_, res_)</span>
<span id="cb81-76"><a href="id_04_model_validation_and_interpretation.html#cb81-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-77"><a href="id_04_model_validation_and_interpretation.html#cb81-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-78"><a href="id_04_model_validation_and_interpretation.html#cb81-78" aria-hidden="true" tabindex="-1"></a>induced_replicate_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-79"><a href="id_04_model_validation_and_interpretation.html#cb81-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-80"><a href="id_04_model_validation_and_interpretation.html#cb81-80" aria-hidden="true" tabindex="-1"></a>    <span class="fl">171.4944</span>, <span class="fl">32.1744</span>, <span class="fl">23.6544</span>, <span class="fl">24.7344</span>, <span class="fl">47.1744</span>, <span class="fl">404.5344</span>, <span class="fl">224.2944</span>, <span class="fl">71.8944</span>, <span class="fl">442.4544</span>, <span class="fl">394.5744</span>, <span class="fl">294.8544</span>, <span class="fl">464.8944</span>,</span>
<span id="cb81-81"><a href="id_04_model_validation_and_interpretation.html#cb81-81" aria-hidden="true" tabindex="-1"></a>    <span class="fl">39.4944</span>, <span class="fl">24.2544</span>, <span class="fl">59.4144</span>, <span class="fl">55.6944</span>, <span class="fl">31.9344</span>, <span class="fl">182.2944</span>, <span class="fl">195.2544</span>, <span class="fl">434.1744</span>, <span class="fl">486.8544</span>, <span class="fl">406.8144</span>, <span class="fl">25.4544</span>, <span class="fl">524.5344</span>,</span>
<span id="cb81-82"><a href="id_04_model_validation_and_interpretation.html#cb81-82" aria-hidden="true" tabindex="-1"></a>    <span class="fl">28.8144</span>, <span class="fl">76.2144</span>, <span class="fl">160.6944</span>, <span class="fl">32.6544</span>, <span class="fl">424.8144</span>, <span class="fl">60.4944</span>, <span class="fl">474.1344</span>, <span class="fl">281.2944</span>, <span class="fl">240.2544</span>, <span class="fl">226.8144</span>, <span class="fl">386.1744</span>, <span class="fl">235.2144</span>,</span>
<span id="cb81-83"><a href="id_04_model_validation_and_interpretation.html#cb81-83" aria-hidden="true" tabindex="-1"></a>    <span class="fl">20.7744</span>, <span class="fl">28.9344</span>, <span class="fl">43.6944</span>, <span class="fl">34.2144</span>, <span class="fl">20.6544</span>, <span class="fl">45.9744</span>, <span class="fl">297.0144</span>, <span class="fl">30.9744</span>, <span class="fl">540.3744</span>, <span class="fl">235.4544</span>, <span class="fl">618.3744</span>, <span class="fl">395.7744</span>,</span>
<span id="cb81-84"><a href="id_04_model_validation_and_interpretation.html#cb81-84" aria-hidden="true" tabindex="-1"></a>    <span class="fl">24.7344</span>, <span class="fl">13.9344</span>, <span class="fl">30.2544</span>, <span class="fl">23.5344</span>, <span class="fl">14.8944</span>, <span class="fl">17.1744</span>, <span class="fl">40.5744</span>, <span class="fl">132.4944</span>, <span class="fl">410.4144</span>, <span class="fl">53.2944</span>, <span class="fl">352.8144</span>, <span class="fl">427.2144</span>,</span>
<span id="cb81-85"><a href="id_04_model_validation_and_interpretation.html#cb81-85" aria-hidden="true" tabindex="-1"></a>    <span class="fl">13.3344</span>, <span class="fl">224.2944</span>, <span class="fl">28.2144</span>, <span class="fl">48.0144</span>, <span class="fl">62.5344</span>, <span class="fl">25.6944</span>, <span class="fl">352.6944</span>, <span class="fl">245.6544</span>, <span class="fl">80.8944</span>, <span class="fl">313.5744</span>, <span class="fl">414.6144</span>, <span class="fl">235.2144</span>,</span>
<span id="cb81-86"><a href="id_04_model_validation_and_interpretation.html#cb81-86" aria-hidden="true" tabindex="-1"></a>    <span class="fl">20.8944</span>, <span class="fl">29.8944</span>, <span class="fl">36.9744</span>, <span class="fl">19.6944</span>, <span class="fl">12.7344</span>, <span class="fl">422.1744</span>, <span class="fl">341.8944</span>, <span class="fl">120.2544</span>, <span class="fl">333.6144</span>, <span class="fl">281.2944</span>, <span class="fl">534.7344</span>, <span class="fl">356.2944</span>,</span>
<span id="cb81-87"><a href="id_04_model_validation_and_interpretation.html#cb81-87" aria-hidden="true" tabindex="-1"></a>    <span class="fl">15.7344</span>, <span class="fl">66.4944</span>, <span class="fl">33.3744</span>, <span class="fl">21.0144</span>, <span class="fl">73.5744</span>, <span class="fl">17.8944</span>, <span class="fl">108.9744</span>, <span class="fl">116.1744</span>, <span class="fl">618.3744</span>, <span class="fl">538.0944</span>, <span class="fl">554.0544</span>, <span class="fl">502.4544</span></span>
<span id="cb81-88"><a href="id_04_model_validation_and_interpretation.html#cb81-88" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-89"><a href="id_04_model_validation_and_interpretation.html#cb81-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-90"><a href="id_04_model_validation_and_interpretation.html#cb81-90" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-91"><a href="id_04_model_validation_and_interpretation.html#cb81-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-92"><a href="id_04_model_validation_and_interpretation.html#cb81-92" aria-hidden="true" tabindex="-1"></a>induced_replicate_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-93"><a href="id_04_model_validation_and_interpretation.html#cb81-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-94"><a href="id_04_model_validation_and_interpretation.html#cb81-94" aria-hidden="true" tabindex="-1"></a>    <span class="fl">39.1344</span>, <span class="fl">30.1344</span>, <span class="fl">34.5744</span>, <span class="fl">367.2144</span>, <span class="fl">36.7344</span>, <span class="fl">185.4144</span>, <span class="fl">192.9744</span>, <span class="fl">434.2944</span>, <span class="fl">376.2144</span>, <span class="fl">305.4144</span>, <span class="fl">192.9744</span>, <span class="fl">420.6144</span>,</span>
<span id="cb81-95"><a href="id_04_model_validation_and_interpretation.html#cb81-95" aria-hidden="true" tabindex="-1"></a>    <span class="fl">41.4144</span>, <span class="fl">19.4544</span>, <span class="fl">101.6544</span>, <span class="fl">370.0944</span>, <span class="fl">43.9344</span>, <span class="fl">231.1344</span>, <span class="fl">110.1744</span>, <span class="fl">476.8944</span>, <span class="fl">395.6544</span>, <span class="fl">315.6144</span>, <span class="fl">75.9744</span>, <span class="fl">435.2544</span>,</span>
<span id="cb81-96"><a href="id_04_model_validation_and_interpretation.html#cb81-96" aria-hidden="true" tabindex="-1"></a>    <span class="fl">26.8944</span>, <span class="fl">60.6144</span>, <span class="fl">29.8944</span>, <span class="fl">200.1744</span>, <span class="fl">460.5744</span>, <span class="fl">265.9344</span>, <span class="fl">541.6944</span>, <span class="fl">310.2144</span>, <span class="fl">282.6144</span>, <span class="fl">404.4144</span>, <span class="fl">168.9744</span>, <span class="fl">196.2144</span>,</span>
<span id="cb81-97"><a href="id_04_model_validation_and_interpretation.html#cb81-97" aria-hidden="true" tabindex="-1"></a>    <span class="fl">12.6144</span>, <span class="fl">137.7744</span>, <span class="fl">16.0944</span>, <span class="fl">16.2144</span>, <span class="fl">47.8944</span>, <span class="fl">24.7344</span>, <span class="fl">274.4544</span>, <span class="fl">62.0544</span>, <span class="fl">247.9344</span>, <span class="fl">209.2944</span>, <span class="fl">393.4944</span>, <span class="fl">423.3744</span>,</span>
<span id="cb81-98"><a href="id_04_model_validation_and_interpretation.html#cb81-98" aria-hidden="true" tabindex="-1"></a>    <span class="fl">22.2144</span>, <span class="fl">21.3744</span>, <span class="fl">11.1744</span>, <span class="fl">9.1344</span>, <span class="fl">128.4144</span>, <span class="fl">19.6944</span>, <span class="fl">58.9344</span>, <span class="fl">233.1744</span>, <span class="fl">437.4144</span>, <span class="fl">58.6944</span>, <span class="fl">361.0944</span>, <span class="fl">458.8944</span>,</span>
<span id="cb81-99"><a href="id_04_model_validation_and_interpretation.html#cb81-99" aria-hidden="true" tabindex="-1"></a>    <span class="fl">16.8144</span>, <span class="fl">33.3744</span>, <span class="fl">12.3744</span>, <span class="fl">24.3744</span>, <span class="fl">134.1744</span>, <span class="fl">25.9344</span>, <span class="fl">364.4544</span>, <span class="fl">207.8544</span>, <span class="fl">91.2144</span>, <span class="fl">383.6544</span>, <span class="fl">434.0544</span>, <span class="fl">196.2144</span>,</span>
<span id="cb81-100"><a href="id_04_model_validation_and_interpretation.html#cb81-100" aria-hidden="true" tabindex="-1"></a>    <span class="fl">11.8944</span>, <span class="fl">21.7344</span>, <span class="fl">17.4144</span>, <span class="fl">16.8144</span>, <span class="fl">19.9344</span>, <span class="fl">525.4944</span>, <span class="fl">422.4144</span>, <span class="fl">519.9744</span>, <span class="fl">379.5744</span>, <span class="fl">282.6144</span>, <span class="fl">616.9344</span>, <span class="fl">450.0144</span>,</span>
<span id="cb81-101"><a href="id_04_model_validation_and_interpretation.html#cb81-101" aria-hidden="true" tabindex="-1"></a>    <span class="fl">19.2144</span>, <span class="fl">42.7344</span>, <span class="fl">19.4544</span>, <span class="fl">25.9344</span>, <span class="fl">54.7344</span>, <span class="fl">42.9744</span>, <span class="fl">73.2144</span>, <span class="fl">135.4944</span>, <span class="fl">524.0544</span>, <span class="fl">471.7344</span>, <span class="fl">528.4944</span>, <span class="fl">511.0944</span></span>
<span id="cb81-102"><a href="id_04_model_validation_and_interpretation.html#cb81-102" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-103"><a href="id_04_model_validation_and_interpretation.html#cb81-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-104"><a href="id_04_model_validation_and_interpretation.html#cb81-104" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-105"><a href="id_04_model_validation_and_interpretation.html#cb81-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-106"><a href="id_04_model_validation_and_interpretation.html#cb81-106" aria-hidden="true" tabindex="-1"></a>induced_replicate_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb81-107"><a href="id_04_model_validation_and_interpretation.html#cb81-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb81-108"><a href="id_04_model_validation_and_interpretation.html#cb81-108" aria-hidden="true" tabindex="-1"></a>    <span class="fl">30.3744</span>, <span class="fl">20.2944</span>, <span class="fl">233.8944</span>, <span class="fl">83.8944</span>, <span class="fl">24.2544</span>, <span class="fl">25.3344</span>, <span class="fl">136.2144</span>, <span class="fl">374.8944</span>, <span class="fl">334.5744</span>, <span class="fl">399.6144</span>, <span class="fl">383.6544</span>, <span class="fl">544.6944</span>,</span>
<span id="cb81-109"><a href="id_04_model_validation_and_interpretation.html#cb81-109" aria-hidden="true" tabindex="-1"></a>    <span class="fl">18.9744</span>, <span class="fl">21.1344</span>, <span class="fl">20.0544</span>, <span class="fl">401.7744</span>, <span class="fl">22.6944</span>, <span class="fl">62.7744</span>, <span class="fl">51.4944</span>, <span class="fl">430.6944</span>, <span class="fl">303.7344</span>, <span class="fl">466.6944</span>, <span class="fl">329.6544</span>, <span class="fl">567.7344</span>,</span>
<span id="cb81-110"><a href="id_04_model_validation_and_interpretation.html#cb81-110" aria-hidden="true" tabindex="-1"></a>    <span class="fl">21.8544</span>, <span class="fl">75.3744</span>, <span class="fl">51.9744</span>, <span class="fl">150.3744</span>, <span class="fl">411.4944</span>, <span class="fl">122.0544</span>, <span class="fl">458.2944</span>, <span class="fl">127.8144</span>, <span class="fl">38.4144</span>, <span class="fl">269.8944</span>, <span class="fl">51.9744</span>, <span class="fl">366.9744</span>,</span>
<span id="cb81-111"><a href="id_04_model_validation_and_interpretation.html#cb81-111" aria-hidden="true" tabindex="-1"></a>    <span class="fl">12.1344</span>, <span class="fl">6.6144</span>, <span class="fl">8.8944</span>, <span class="fl">16.8144</span>, <span class="fl">13.3344</span>, <span class="fl">24.4944</span>, <span class="fl">276.9744</span>, <span class="fl">77.4144</span>, <span class="fl">163.6944</span>, <span class="fl">297.8544</span>, <span class="fl">423.9744</span>, <span class="fl">492.8544</span>,</span>
<span id="cb81-112"><a href="id_04_model_validation_and_interpretation.html#cb81-112" aria-hidden="true" tabindex="-1"></a>    <span class="fl">13.9344</span>, <span class="fl">1.9344</span>, <span class="fl">10.4544</span>, <span class="fl">10.5744</span>, <span class="fl">19.0944</span>, <span class="fl">17.6544</span>, <span class="fl">33.0144</span>, <span class="fl">86.7744</span>, <span class="fl">43.2144</span>, <span class="fl">316.0944</span>, <span class="fl">382.8144</span>, <span class="fl">351.9744</span>,</span>
<span id="cb81-113"><a href="id_04_model_validation_and_interpretation.html#cb81-113" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.4544</span>, <span class="fl">136.2144</span>, <span class="fl">9.9744</span>, <span class="fl">13.4544</span>, <span class="fl">101.5344</span>, <span class="fl">18.1344</span>, <span class="fl">403.9344</span>, <span class="fl">183.0144</span>, <span class="fl">389.7744</span>, <span class="fl">70.4544</span>, <span class="fl">444.1344</span>, <span class="fl">149.2944</span>,</span>
<span id="cb81-114"><a href="id_04_model_validation_and_interpretation.html#cb81-114" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7.5744</span>, <span class="fl">15.3744</span>, <span class="fl">141.7344</span>, <span class="fl">15.0144</span>, <span class="fl">12.1344</span>, <span class="fl">423.4944</span>, <span class="fl">422.7744</span>, <span class="fl">94.8144</span>, <span class="fl">269.8944</span>, <span class="fl">289.2144</span>, <span class="fl">473.7744</span>, <span class="fl">364.5744</span>,</span>
<span id="cb81-115"><a href="id_04_model_validation_and_interpretation.html#cb81-115" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.8544</span>, <span class="fl">25.5744</span>, <span class="fl">14.4144</span>, <span class="fl">8.4144</span>, <span class="fl">37.3344</span>, <span class="fl">37.2144</span>, <span class="fl">250.5744</span>, <span class="fl">159.3744</span>, <span class="fl">608.5344</span>, <span class="fl">466.2144</span>, <span class="fl">524.4144</span>, <span class="fl">510.4944</span></span>
<span id="cb81-116"><a href="id_04_model_validation_and_interpretation.html#cb81-116" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-117"><a href="id_04_model_validation_and_interpretation.html#cb81-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb81-118"><a href="id_04_model_validation_and_interpretation.html#cb81-118" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-119"><a href="id_04_model_validation_and_interpretation.html#cb81-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-120"><a href="id_04_model_validation_and_interpretation.html#cb81-120" aria-hidden="true" tabindex="-1"></a>induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-121"><a href="id_04_model_validation_and_interpretation.html#cb81-121" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">96</span>) {</span>
<span id="cb81-122"><a href="id_04_model_validation_and_interpretation.html#cb81-122" aria-hidden="true" tabindex="-1"></a>  res_ <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(induced_replicate_1[i], induced_replicate_2[i], induced_replicate_3[i]))</span>
<span id="cb81-123"><a href="id_04_model_validation_and_interpretation.html#cb81-123" aria-hidden="true" tabindex="-1"></a>  induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(induced_true_, res_)</span>
<span id="cb81-124"><a href="id_04_model_validation_and_interpretation.html#cb81-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-125"><a href="id_04_model_validation_and_interpretation.html#cb81-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-126"><a href="id_04_model_validation_and_interpretation.html#cb81-126" aria-hidden="true" tabindex="-1"></a>new_non_induced_replicate_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-127"><a href="id_04_model_validation_and_interpretation.html#cb81-127" aria-hidden="true" tabindex="-1"></a>  <span class="fl">94.6865</span>, <span class="fl">84.2145</span>, <span class="fl">58.6890</span>, <span class="fl">69.1610</span>, <span class="fl">35.1270</span>, <span class="fl">12.4261</span>, <span class="fl">19.8169</span>, <span class="fl">12.4261</span>, <span class="fl">12.4368</span>, <span class="fl">19.8169</span>,</span>
<span id="cb81-128"><a href="id_04_model_validation_and_interpretation.html#cb81-128" aria-hidden="true" tabindex="-1"></a>  <span class="fl">12.4261</span>, <span class="fl">19.8169</span>, <span class="fl">12.4368</span>, <span class="fl">10.1149</span>, <span class="fl">8.6644</span>,  <span class="fl">38.8384</span>, <span class="fl">12.0117</span>, <span class="fl">23.1802</span>, <span class="fl">9.9236</span>,  <span class="fl">10.7153</span>,</span>
<span id="cb81-129"><a href="id_04_model_validation_and_interpretation.html#cb81-129" aria-hidden="true" tabindex="-1"></a>  <span class="fl">55.7665</span>, <span class="fl">14.1476</span>, <span class="fl">24.8167</span>, <span class="fl">11.4644</span>, <span class="fl">21.2568</span>, <span class="fl">41.3144</span>, <span class="fl">11.8948</span>, <span class="fl">17.2878</span>, <span class="fl">21.1505</span>, <span class="fl">12.9894</span>,</span>
<span id="cb81-130"><a href="id_04_model_validation_and_interpretation.html#cb81-130" aria-hidden="true" tabindex="-1"></a>  <span class="fl">20.8902</span></span>
<span id="cb81-131"><a href="id_04_model_validation_and_interpretation.html#cb81-131" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-132"><a href="id_04_model_validation_and_interpretation.html#cb81-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-133"><a href="id_04_model_validation_and_interpretation.html#cb81-133" aria-hidden="true" tabindex="-1"></a>new_non_induced_replicate_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-134"><a href="id_04_model_validation_and_interpretation.html#cb81-134" aria-hidden="true" tabindex="-1"></a>  <span class="fl">88.1415</span>, <span class="fl">77.0150</span>, <span class="fl">52.1440</span>, <span class="fl">43.6355</span>, <span class="fl">35.1270</span>, <span class="fl">11.6132</span>, <span class="fl">28.8335</span>, <span class="fl">11.6132</span>, <span class="fl">13.2019</span>, <span class="fl">28.8335</span>,</span>
<span id="cb81-135"><a href="id_04_model_validation_and_interpretation.html#cb81-135" aria-hidden="true" tabindex="-1"></a>  <span class="fl">11.6132</span>, <span class="fl">28.8335</span>, <span class="fl">13.2019</span>, <span class="fl">11.6717</span>, <span class="fl">10.0671</span>, <span class="fl">30.3106</span>, <span class="fl">13.4888</span>, <span class="fl">34.5612</span>, <span class="fl">12.9309</span>, <span class="fl">12.6759</span>,</span>
<span id="cb81-136"><a href="id_04_model_validation_and_interpretation.html#cb81-136" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.8393</span>, <span class="fl">17.0753</span>, <span class="fl">38.7481</span>, <span class="fl">11.7673</span>, <span class="fl">24.1153</span>, <span class="fl">35.5229</span>, <span class="fl">13.7651</span>, <span class="fl">22.8933</span>, <span class="fl">25.4702</span>, <span class="fl">14.9234</span>,</span>
<span id="cb81-137"><a href="id_04_model_validation_and_interpretation.html#cb81-137" aria-hidden="true" tabindex="-1"></a>  <span class="fl">29.0832</span></span>
<span id="cb81-138"><a href="id_04_model_validation_and_interpretation.html#cb81-138" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-139"><a href="id_04_model_validation_and_interpretation.html#cb81-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-140"><a href="id_04_model_validation_and_interpretation.html#cb81-140" aria-hidden="true" tabindex="-1"></a>new_non_induced_replicate_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-141"><a href="id_04_model_validation_and_interpretation.html#cb81-141" aria-hidden="true" tabindex="-1"></a>  <span class="fl">64.5795</span>, <span class="fl">63.2705</span>, <span class="fl">48.2170</span>, <span class="fl">52.1440</span>, <span class="fl">27.9275</span>, <span class="fl">15.0881</span>, <span class="fl">40.0817</span>, <span class="fl">15.0881</span>, <span class="fl">13.9936</span>, <span class="fl">40.0817</span>,</span>
<span id="cb81-142"><a href="id_04_model_validation_and_interpretation.html#cb81-142" aria-hidden="true" tabindex="-1"></a>  <span class="fl">15.0881</span>, <span class="fl">40.0817</span>, <span class="fl">13.9936</span>, <span class="fl">8.5847</span>, <span class="fl">13.4835</span>, <span class="fl">64.9266</span>, <span class="fl">13.2444</span>, <span class="fl">56.1065</span>, <span class="fl">10.6090</span>, <span class="fl">13.8660</span>,</span>
<span id="cb81-143"><a href="id_04_model_validation_and_interpretation.html#cb81-143" aria-hidden="true" tabindex="-1"></a>  <span class="fl">69.1400</span>, <span class="fl">21.0974</span>, <span class="fl">67.0891</span>, <span class="fl">10.8056</span>, <span class="fl">25.8900</span>, <span class="fl">55.3361</span>, <span class="fl">16.4695</span>, <span class="fl">24.6201</span>, <span class="fl">42.7755</span>, <span class="fl">14.1317</span>,</span>
<span id="cb81-144"><a href="id_04_model_validation_and_interpretation.html#cb81-144" aria-hidden="true" tabindex="-1"></a>  <span class="fl">49.6828</span></span>
<span id="cb81-145"><a href="id_04_model_validation_and_interpretation.html#cb81-145" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-146"><a href="id_04_model_validation_and_interpretation.html#cb81-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-147"><a href="id_04_model_validation_and_interpretation.html#cb81-147" aria-hidden="true" tabindex="-1"></a>new_non_induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-148"><a href="id_04_model_validation_and_interpretation.html#cb81-148" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>) {</span>
<span id="cb81-149"><a href="id_04_model_validation_and_interpretation.html#cb81-149" aria-hidden="true" tabindex="-1"></a>  res_ <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(new_non_induced_replicate_1[i], new_non_induced_replicate_2[i], new_non_induced_replicate_3[i]))</span>
<span id="cb81-150"><a href="id_04_model_validation_and_interpretation.html#cb81-150" aria-hidden="true" tabindex="-1"></a>  new_non_induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(new_non_induced_true_, res_)</span>
<span id="cb81-151"><a href="id_04_model_validation_and_interpretation.html#cb81-151" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-152"><a href="id_04_model_validation_and_interpretation.html#cb81-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-153"><a href="id_04_model_validation_and_interpretation.html#cb81-153" aria-hidden="true" tabindex="-1"></a>new_induced_replicate_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-154"><a href="id_04_model_validation_and_interpretation.html#cb81-154" aria-hidden="true" tabindex="-1"></a>  <span class="fl">775.3412</span>, <span class="fl">608.3964</span>, <span class="fl">376.3855</span>, <span class="fl">403.2684</span>, <span class="fl">450.2610</span>, <span class="fl">104.3842</span>, <span class="fl">610.9376</span>, <span class="fl">104.3842</span>, <span class="fl">206.0770</span>, <span class="fl">610.9376</span>,</span>
<span id="cb81-155"><a href="id_04_model_validation_and_interpretation.html#cb81-155" aria-hidden="true" tabindex="-1"></a>  <span class="fl">104.3842</span>, <span class="fl">610.9376</span>, <span class="fl">206.0770</span>, <span class="fl">61.42746</span>, <span class="fl">63.9640</span>, <span class="fl">725.5767</span>, <span class="fl">182.7868</span>, <span class="fl">436.4094</span>, <span class="fl">89.5931</span>, <span class="fl">105.8666</span>,</span>
<span id="cb81-156"><a href="id_04_model_validation_and_interpretation.html#cb81-156" aria-hidden="true" tabindex="-1"></a>  <span class="fl">643.6163</span>, <span class="fl">295.6471</span>, <span class="fl">536.2245</span>, <span class="fl">141.8066</span>, <span class="fl">415.8205</span>, <span class="fl">549.5332</span>, <span class="fl">258.9823</span>, <span class="fl">532.0408</span>, <span class="fl">386.370</span>, <span class="fl">313.6335</span>,</span>
<span id="cb81-157"><a href="id_04_model_validation_and_interpretation.html#cb81-157" aria-hidden="true" tabindex="-1"></a>  <span class="fl">596.1610</span></span>
<span id="cb81-158"><a href="id_04_model_validation_and_interpretation.html#cb81-158" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-159"><a href="id_04_model_validation_and_interpretation.html#cb81-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-160"><a href="id_04_model_validation_and_interpretation.html#cb81-160" aria-hidden="true" tabindex="-1"></a>new_induced_replicate_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-161"><a href="id_04_model_validation_and_interpretation.html#cb81-161" aria-hidden="true" tabindex="-1"></a>  <span class="fl">720.8794</span>, <span class="fl">670.3267</span>, <span class="fl">402.6897</span>, <span class="fl">361.0000</span>, <span class="fl">423.5832</span>, <span class="fl">95.4568</span>, <span class="fl">353.5596</span>, <span class="fl">95.4568</span>, <span class="fl">173.0359</span>, <span class="fl">353.5596</span>,</span>
<span id="cb81-162"><a href="id_04_model_validation_and_interpretation.html#cb81-162" aria-hidden="true" tabindex="-1"></a>  <span class="fl">95.4568</span>, <span class="fl">353.5596</span>, <span class="fl">173.0359</span>, <span class="fl">70.6842</span>, <span class="fl">58.2979</span>, <span class="fl">560.2724</span>, <span class="fl">235.8898</span>, <span class="fl">367.2965</span>, <span class="fl">83.7953</span>, <span class="fl">102.8688</span>,</span>
<span id="cb81-163"><a href="id_04_model_validation_and_interpretation.html#cb81-163" aria-hidden="true" tabindex="-1"></a>  <span class="fl">552.6956</span>, <span class="fl">249.6267</span>, <span class="fl">461.8738</span>, <span class="fl">114.8928</span>, <span class="fl">335.8037</span>, <span class="fl">455.3512</span>, <span class="fl">205.2205</span>, <span class="fl">327.7658</span>, <span class="fl">417.4017</span>, <span class="fl">186.3116</span>,</span>
<span id="cb81-164"><a href="id_04_model_validation_and_interpretation.html#cb81-164" aria-hidden="true" tabindex="-1"></a>  <span class="fl">851.0120</span></span>
<span id="cb81-165"><a href="id_04_model_validation_and_interpretation.html#cb81-165" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-166"><a href="id_04_model_validation_and_interpretation.html#cb81-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-167"><a href="id_04_model_validation_and_interpretation.html#cb81-167" aria-hidden="true" tabindex="-1"></a>new_induced_replicate_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb81-168"><a href="id_04_model_validation_and_interpretation.html#cb81-168" aria-hidden="true" tabindex="-1"></a>  <span class="fl">783.3711</span>, <span class="fl">690.3612</span>, <span class="fl">393.6819</span>, <span class="fl">493.6712</span>, <span class="fl">480.9125</span>, <span class="fl">86.2659</span>, <span class="fl">417.0393</span>, <span class="fl">86.2659</span>, <span class="fl">159.3978</span>, <span class="fl">417.0393</span>,</span>
<span id="cb81-169"><a href="id_04_model_validation_and_interpretation.html#cb81-169" aria-hidden="true" tabindex="-1"></a>  <span class="fl">86.2659</span>, <span class="fl">417.0393</span>, <span class="fl">159.3978</span>, <span class="fl">60.1427</span>, <span class="fl">53.6201</span>, <span class="fl">512.8355</span>, <span class="fl">120.0977</span>, <span class="fl">394.4739</span>, <span class="fl">100.9911</span>, <span class="fl">112.4550</span>,</span>
<span id="cb81-170"><a href="id_04_model_validation_and_interpretation.html#cb81-170" aria-hidden="true" tabindex="-1"></a>  <span class="fl">577.1388</span>, <span class="fl">243.4006</span>, <span class="fl">552.0697</span>, <span class="fl">118.0552</span>, <span class="fl">376.5862</span>, <span class="fl">513.8896</span>, <span class="fl">224.0635</span>, <span class="fl">387.4242</span>, <span class="fl">380.8028</span>, <span class="fl">221.7246</span>,</span>
<span id="cb81-171"><a href="id_04_model_validation_and_interpretation.html#cb81-171" aria-hidden="true" tabindex="-1"></a>  <span class="fl">766.4130</span></span>
<span id="cb81-172"><a href="id_04_model_validation_and_interpretation.html#cb81-172" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-173"><a href="id_04_model_validation_and_interpretation.html#cb81-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-174"><a href="id_04_model_validation_and_interpretation.html#cb81-174" aria-hidden="true" tabindex="-1"></a>new_induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-175"><a href="id_04_model_validation_and_interpretation.html#cb81-175" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>) {</span>
<span id="cb81-176"><a href="id_04_model_validation_and_interpretation.html#cb81-176" aria-hidden="true" tabindex="-1"></a>  res_ <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(new_induced_replicate_1[i], new_induced_replicate_2[i], new_induced_replicate_3[i]))</span>
<span id="cb81-177"><a href="id_04_model_validation_and_interpretation.html#cb81-177" aria-hidden="true" tabindex="-1"></a>  new_induced_true_ <span class="ot">&lt;-</span> <span class="fu">c</span>(new_induced_true_, res_)</span>
<span id="cb81-178"><a href="id_04_model_validation_and_interpretation.html#cb81-178" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-179"><a href="id_04_model_validation_and_interpretation.html#cb81-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-180"><a href="id_04_model_validation_and_interpretation.html#cb81-180" aria-hidden="true" tabindex="-1"></a>cpp_true_non_induced <span class="ot">&lt;-</span> <span class="fu">c</span>(non_induced_true_, new_non_induced_true_)</span>
<span id="cb81-181"><a href="id_04_model_validation_and_interpretation.html#cb81-181" aria-hidden="true" tabindex="-1"></a>cpp_true_induced <span class="ot">&lt;-</span> <span class="fu">c</span>(induced_true_, new_induced_true_)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb82-1"><a href="id_04_model_validation_and_interpretation.html#cb82-1" aria-hidden="true" tabindex="-1"></a>mb_cp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb82-2"><a href="id_04_model_validation_and_interpretation.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mb_true =</span> <span class="fu">rep</span>(mb_true, <span class="dv">2</span>),</span>
<span id="cb82-3"><a href="id_04_model_validation_and_interpretation.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpp_true =</span> <span class="fu">c</span>(cpp_true_non_induced, cpp_true_induced),</span>
<span id="cb82-4"><a href="id_04_model_validation_and_interpretation.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mb_pred =</span> <span class="fu">rep</span>(mb_pred, <span class="dv">2</span>),</span>
<span id="cb82-5"><a href="id_04_model_validation_and_interpretation.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpp_pred =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(cpp_pred, <span class="dv">2</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Non-CPP&quot;</span>, <span class="st">&quot;CPP&quot;</span>)),</span>
<span id="cb82-6"><a href="id_04_model_validation_and_interpretation.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cell_group =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(</span>
<span id="cb82-7"><a href="id_04_model_validation_and_interpretation.html#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">&quot;Non-induced&quot;</span>, <span class="fu">length</span>(cpp_true_non_induced)),</span>
<span id="cb82-8"><a href="id_04_model_validation_and_interpretation.html#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">&quot;Induced&quot;</span>, <span class="fu">length</span>(cpp_true_induced))</span>
<span id="cb82-9"><a href="id_04_model_validation_and_interpretation.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb82-10"><a href="id_04_model_validation_and_interpretation.html#cb82-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="melanin-induced-cells" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Melanin-induced cells<a href="id_04_model_validation_and_interpretation.html#melanin-induced-cells" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb83-1"><a href="id_04_model_validation_and_interpretation.html#cb83-1" aria-hidden="true" tabindex="-1"></a>mb_cp_df<span class="sc">$</span>log_cpp_true <span class="ot">&lt;-</span> <span class="fu">log10</span>(mb_cp_df<span class="sc">$</span>cpp_true)</span>
<span id="cb83-2"><a href="id_04_model_validation_and_interpretation.html#cb83-2" aria-hidden="true" tabindex="-1"></a>p2_1 <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(mb_cp_df[mb_cp_df<span class="sc">$</span>cell_group <span class="sc">==</span> <span class="st">&quot;Induced&quot;</span>, ],</span>
<span id="cb83-3"><a href="id_04_model_validation_and_interpretation.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;mb_true&quot;</span>, <span class="at">y =</span> <span class="st">&quot;log_cpp_true&quot;</span>,</span>
<span id="cb83-4"><a href="id_04_model_validation_and_interpretation.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cpp_pred&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;cpp_pred&quot;</span>,</span>
<span id="cb83-5"><a href="id_04_model_validation_and_interpretation.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.int.level =</span> <span class="fl">0.95</span>, <span class="at">cor.coef =</span> <span class="cn">TRUE</span>,</span>
<span id="cb83-6"><a href="id_04_model_validation_and_interpretation.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>),</span>
<span id="cb83-7"><a href="id_04_model_validation_and_interpretation.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor.coeff.args =</span> <span class="fu">list</span>(</span>
<span id="cb83-8"><a href="id_04_model_validation_and_interpretation.html#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="fl">2.2</span>, <span class="at">label.y =</span> <span class="fl">2.85</span>, <span class="at">label.sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb83-9"><a href="id_04_model_validation_and_interpretation.html#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb83-10"><a href="id_04_model_validation_and_interpretation.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-11"><a href="id_04_model_validation_and_interpretation.html#cb83-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb83-12"><a href="id_04_model_validation_and_interpretation.html#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cpp_pred) <span class="sc">+</span></span>
<span id="cb83-13"><a href="id_04_model_validation_and_interpretation.html#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#d62728&quot;</span>)) <span class="sc">+</span></span>
<span id="cb83-14"><a href="id_04_model_validation_and_interpretation.html#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb83-15"><a href="id_04_model_validation_and_interpretation.html#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb83-16"><a href="id_04_model_validation_and_interpretation.html#cb83-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.63</span>, <span class="dv">3</span>),</span>
<span id="cb83-17"><a href="id_04_model_validation_and_interpretation.html#cb83-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">log10</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>)),</span>
<span id="cb83-18"><a href="id_04_model_validation_and_interpretation.html#cb83-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">sapply</span>(</span>
<span id="cb83-19"><a href="id_04_model_validation_and_interpretation.html#cb83-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb83-20"><a href="id_04_model_validation_and_interpretation.html#cb83-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span>
<span id="cb83-21"><a href="id_04_model_validation_and_interpretation.html#cb83-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-22"><a href="id_04_model_validation_and_interpretation.html#cb83-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-23"><a href="id_04_model_validation_and_interpretation.html#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">&quot;l&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-24"><a href="id_04_model_validation_and_interpretation.html#cb83-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-25"><a href="id_04_model_validation_and_interpretation.html#cb83-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-26"><a href="id_04_model_validation_and_interpretation.html#cb83-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb83-27"><a href="id_04_model_validation_and_interpretation.html#cb83-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-28"><a href="id_04_model_validation_and_interpretation.html#cb83-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-29"><a href="id_04_model_validation_and_interpretation.html#cb83-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb83-30"><a href="id_04_model_validation_and_interpretation.html#cb83-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb83-31"><a href="id_04_model_validation_and_interpretation.html#cb83-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb83-32"><a href="id_04_model_validation_and_interpretation.html#cb83-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb83-33"><a href="id_04_model_validation_and_interpretation.html#cb83-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-34"><a href="id_04_model_validation_and_interpretation.html#cb83-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">22</span>)</span>
<span id="cb83-35"><a href="id_04_model_validation_and_interpretation.html#cb83-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-36"><a href="id_04_model_validation_and_interpretation.html#cb83-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Peptide bound to mNPs (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-37"><a href="id_04_model_validation_and_interpretation.html#cb83-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Peptide (pMol / 100K cells)&quot;</span>)</span>
<span id="cb83-38"><a href="id_04_model_validation_and_interpretation.html#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="id_04_model_validation_and_interpretation.html#cb83-39" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb83-40"><a href="id_04_model_validation_and_interpretation.html#cb83-40" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">seed =</span> <span class="dv">16</span>)</span>
<span id="cb83-41"><a href="id_04_model_validation_and_interpretation.html#cb83-41" aria-hidden="true" tabindex="-1"></a>p2_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mb_cp_df[mb_cp_df<span class="sc">$</span>cell_group <span class="sc">==</span> <span class="st">&quot;Induced&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> cpp_pred, <span class="at">y =</span> log_cpp_true)) <span class="sc">+</span></span>
<span id="cb83-42"><a href="id_04_model_validation_and_interpretation.html#cb83-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> cpp_pred), <span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-43"><a href="id_04_model_validation_and_interpretation.html#cb83-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cpp_pred, <span class="at">shape =</span> cpp_pred),</span>
<span id="cb83-44"><a href="id_04_model_validation_and_interpretation.html#cb83-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb83-45"><a href="id_04_model_validation_and_interpretation.html#cb83-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">priority =</span> <span class="st">&quot;random&quot;</span></span>
<span id="cb83-46"><a href="id_04_model_validation_and_interpretation.html#cb83-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-47"><a href="id_04_model_validation_and_interpretation.html#cb83-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(</span>
<span id="cb83-48"><a href="id_04_model_validation_and_interpretation.html#cb83-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">label.x.npc =</span> <span class="fl">0.2</span>,</span>
<span id="cb83-49"><a href="id_04_model_validation_and_interpretation.html#cb83-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.y =</span> <span class="fl">2.92</span>, <span class="at">hide.ns =</span> <span class="cn">TRUE</span></span>
<span id="cb83-50"><a href="id_04_model_validation_and_interpretation.html#cb83-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-51"><a href="id_04_model_validation_and_interpretation.html#cb83-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(</span>
<span id="cb83-52"><a href="id_04_model_validation_and_interpretation.html#cb83-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p.format&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">label.x.npc =</span> <span class="fl">0.2</span>,</span>
<span id="cb83-53"><a href="id_04_model_validation_and_interpretation.html#cb83-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.y =</span> <span class="fl">2.82</span>, <span class="at">hide.ns =</span> <span class="cn">TRUE</span></span>
<span id="cb83-54"><a href="id_04_model_validation_and_interpretation.html#cb83-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-55"><a href="id_04_model_validation_and_interpretation.html#cb83-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#cae6fa&quot;</span>, <span class="st">&quot;#f5b8b8&quot;</span>)) <span class="sc">+</span></span>
<span id="cb83-56"><a href="id_04_model_validation_and_interpretation.html#cb83-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#d62728&quot;</span>)) <span class="sc">+</span></span>
<span id="cb83-57"><a href="id_04_model_validation_and_interpretation.html#cb83-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb83-58"><a href="id_04_model_validation_and_interpretation.html#cb83-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">21</span>))), <span class="at">shape =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-59"><a href="id_04_model_validation_and_interpretation.html#cb83-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb83-60"><a href="id_04_model_validation_and_interpretation.html#cb83-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.63</span>, <span class="dv">3</span>),</span>
<span id="cb83-61"><a href="id_04_model_validation_and_interpretation.html#cb83-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">log10</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>)),</span>
<span id="cb83-62"><a href="id_04_model_validation_and_interpretation.html#cb83-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb83-63"><a href="id_04_model_validation_and_interpretation.html#cb83-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-64"><a href="id_04_model_validation_and_interpretation.html#cb83-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">&quot;l&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-65"><a href="id_04_model_validation_and_interpretation.html#cb83-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-66"><a href="id_04_model_validation_and_interpretation.html#cb83-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb83-67"><a href="id_04_model_validation_and_interpretation.html#cb83-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-68"><a href="id_04_model_validation_and_interpretation.html#cb83-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-69"><a href="id_04_model_validation_and_interpretation.html#cb83-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb83-70"><a href="id_04_model_validation_and_interpretation.html#cb83-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb83-71"><a href="id_04_model_validation_and_interpretation.html#cb83-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb83-72"><a href="id_04_model_validation_and_interpretation.html#cb83-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb83-73"><a href="id_04_model_validation_and_interpretation.html#cb83-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-74"><a href="id_04_model_validation_and_interpretation.html#cb83-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-75"><a href="id_04_model_validation_and_interpretation.html#cb83-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-76"><a href="id_04_model_validation_and_interpretation.html#cb83-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">1.15</span>, <span class="fl">0.15</span>, <span class="fl">0.53</span>, <span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb83-77"><a href="id_04_model_validation_and_interpretation.html#cb83-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.05</span>),</span>
<span id="cb83-78"><a href="id_04_model_validation_and_interpretation.html#cb83-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb83-79"><a href="id_04_model_validation_and_interpretation.html#cb83-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)</span>
<span id="cb83-80"><a href="id_04_model_validation_and_interpretation.html#cb83-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-81"><a href="id_04_model_validation_and_interpretation.html#cb83-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-82"><a href="id_04_model_validation_and_interpretation.html#cb83-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb83-83"><a href="id_04_model_validation_and_interpretation.html#cb83-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-84"><a href="id_04_model_validation_and_interpretation.html#cb83-84" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(p2_1, p2_2, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">2.39</span>, <span class="fl">1.02</span>))</span></code></pre></div>
<p><img src="figures/Fig%203%20mb%20vs%20cpp%20induced%20cells.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="non-melanin-induced-cells" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Non-melanin induced cells<a href="id_04_model_validation_and_interpretation.html#non-melanin-induced-cells" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb84-1"><a href="id_04_model_validation_and_interpretation.html#cb84-1" aria-hidden="true" tabindex="-1"></a>p3_1 <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(mb_cp_df[mb_cp_df<span class="sc">$</span>cell_group <span class="sc">==</span> <span class="st">&quot;Non-induced&quot;</span>, ],</span>
<span id="cb84-2"><a href="id_04_model_validation_and_interpretation.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;mb_true&quot;</span>, <span class="at">y =</span> <span class="st">&quot;log_cpp_true&quot;</span>,</span>
<span id="cb84-3"><a href="id_04_model_validation_and_interpretation.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cpp_pred&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;cpp_pred&quot;</span>,</span>
<span id="cb84-4"><a href="id_04_model_validation_and_interpretation.html#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.int.level =</span> <span class="fl">0.95</span>, <span class="at">cor.coef =</span> <span class="cn">TRUE</span>,</span>
<span id="cb84-5"><a href="id_04_model_validation_and_interpretation.html#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>),</span>
<span id="cb84-6"><a href="id_04_model_validation_and_interpretation.html#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor.coeff.args =</span> <span class="fu">list</span>(</span>
<span id="cb84-7"><a href="id_04_model_validation_and_interpretation.html#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="fl">2.2</span>, <span class="at">label.y =</span> <span class="fl">2.85</span>, <span class="at">label.sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb84-8"><a href="id_04_model_validation_and_interpretation.html#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb84-9"><a href="id_04_model_validation_and_interpretation.html#cb84-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-10"><a href="id_04_model_validation_and_interpretation.html#cb84-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb84-11"><a href="id_04_model_validation_and_interpretation.html#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cpp_pred) <span class="sc">+</span></span>
<span id="cb84-12"><a href="id_04_model_validation_and_interpretation.html#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#d62728&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-13"><a href="id_04_model_validation_and_interpretation.html#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb84-14"><a href="id_04_model_validation_and_interpretation.html#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb84-15"><a href="id_04_model_validation_and_interpretation.html#cb84-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.63</span>, <span class="dv">3</span>),</span>
<span id="cb84-16"><a href="id_04_model_validation_and_interpretation.html#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">log10</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>)),</span>
<span id="cb84-17"><a href="id_04_model_validation_and_interpretation.html#cb84-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">sapply</span>(</span>
<span id="cb84-18"><a href="id_04_model_validation_and_interpretation.html#cb84-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb84-19"><a href="id_04_model_validation_and_interpretation.html#cb84-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-20"><a href="id_04_model_validation_and_interpretation.html#cb84-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-21"><a href="id_04_model_validation_and_interpretation.html#cb84-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-22"><a href="id_04_model_validation_and_interpretation.html#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">&quot;l&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-23"><a href="id_04_model_validation_and_interpretation.html#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-24"><a href="id_04_model_validation_and_interpretation.html#cb84-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-25"><a href="id_04_model_validation_and_interpretation.html#cb84-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb84-26"><a href="id_04_model_validation_and_interpretation.html#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-27"><a href="id_04_model_validation_and_interpretation.html#cb84-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-28"><a href="id_04_model_validation_and_interpretation.html#cb84-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb84-29"><a href="id_04_model_validation_and_interpretation.html#cb84-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb84-30"><a href="id_04_model_validation_and_interpretation.html#cb84-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb84-31"><a href="id_04_model_validation_and_interpretation.html#cb84-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb84-32"><a href="id_04_model_validation_and_interpretation.html#cb84-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-33"><a href="id_04_model_validation_and_interpretation.html#cb84-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">22</span>)</span>
<span id="cb84-34"><a href="id_04_model_validation_and_interpretation.html#cb84-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-35"><a href="id_04_model_validation_and_interpretation.html#cb84-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Peptide bound to mNPs (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-36"><a href="id_04_model_validation_and_interpretation.html#cb84-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Peptide (pMol / 100K cells)&quot;</span>)</span>
<span id="cb84-37"><a href="id_04_model_validation_and_interpretation.html#cb84-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-38"><a href="id_04_model_validation_and_interpretation.html#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb84-39"><a href="id_04_model_validation_and_interpretation.html#cb84-39" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">seed =</span> <span class="dv">16</span>)</span>
<span id="cb84-40"><a href="id_04_model_validation_and_interpretation.html#cb84-40" aria-hidden="true" tabindex="-1"></a>p3_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mb_cp_df[mb_cp_df<span class="sc">$</span>cell_group <span class="sc">==</span> <span class="st">&quot;Non-induced&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> cpp_pred, <span class="at">y =</span> log_cpp_true)) <span class="sc">+</span></span>
<span id="cb84-41"><a href="id_04_model_validation_and_interpretation.html#cb84-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> cpp_pred), <span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb84-42"><a href="id_04_model_validation_and_interpretation.html#cb84-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cpp_pred, <span class="at">shape =</span> cpp_pred),</span>
<span id="cb84-43"><a href="id_04_model_validation_and_interpretation.html#cb84-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb84-44"><a href="id_04_model_validation_and_interpretation.html#cb84-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">priority =</span> <span class="st">&quot;random&quot;</span></span>
<span id="cb84-45"><a href="id_04_model_validation_and_interpretation.html#cb84-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-46"><a href="id_04_model_validation_and_interpretation.html#cb84-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(</span>
<span id="cb84-47"><a href="id_04_model_validation_and_interpretation.html#cb84-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">label.x.npc =</span> <span class="fl">0.2</span>,</span>
<span id="cb84-48"><a href="id_04_model_validation_and_interpretation.html#cb84-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.y =</span> <span class="fl">2.92</span>, <span class="at">hide.ns =</span> <span class="cn">TRUE</span></span>
<span id="cb84-49"><a href="id_04_model_validation_and_interpretation.html#cb84-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-50"><a href="id_04_model_validation_and_interpretation.html#cb84-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(</span>
<span id="cb84-51"><a href="id_04_model_validation_and_interpretation.html#cb84-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p.format&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">label.x.npc =</span> <span class="fl">0.2</span>,</span>
<span id="cb84-52"><a href="id_04_model_validation_and_interpretation.html#cb84-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.y =</span> <span class="fl">2.82</span>, <span class="at">hide.ns =</span> <span class="cn">TRUE</span></span>
<span id="cb84-53"><a href="id_04_model_validation_and_interpretation.html#cb84-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-54"><a href="id_04_model_validation_and_interpretation.html#cb84-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#cae6fa&quot;</span>, <span class="st">&quot;#f5b8b8&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-55"><a href="id_04_model_validation_and_interpretation.html#cb84-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#d62728&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-56"><a href="id_04_model_validation_and_interpretation.html#cb84-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb84-57"><a href="id_04_model_validation_and_interpretation.html#cb84-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">21</span>))), <span class="at">shape =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-58"><a href="id_04_model_validation_and_interpretation.html#cb84-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb84-59"><a href="id_04_model_validation_and_interpretation.html#cb84-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.63</span>, <span class="dv">3</span>),</span>
<span id="cb84-60"><a href="id_04_model_validation_and_interpretation.html#cb84-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">log10</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>)),</span>
<span id="cb84-61"><a href="id_04_model_validation_and_interpretation.html#cb84-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="dv">10</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb84-62"><a href="id_04_model_validation_and_interpretation.html#cb84-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-63"><a href="id_04_model_validation_and_interpretation.html#cb84-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">&quot;l&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-64"><a href="id_04_model_validation_and_interpretation.html#cb84-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-65"><a href="id_04_model_validation_and_interpretation.html#cb84-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb84-66"><a href="id_04_model_validation_and_interpretation.html#cb84-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-67"><a href="id_04_model_validation_and_interpretation.html#cb84-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-68"><a href="id_04_model_validation_and_interpretation.html#cb84-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb84-69"><a href="id_04_model_validation_and_interpretation.html#cb84-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb84-70"><a href="id_04_model_validation_and_interpretation.html#cb84-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb84-71"><a href="id_04_model_validation_and_interpretation.html#cb84-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb84-72"><a href="id_04_model_validation_and_interpretation.html#cb84-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-73"><a href="id_04_model_validation_and_interpretation.html#cb84-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-74"><a href="id_04_model_validation_and_interpretation.html#cb84-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-75"><a href="id_04_model_validation_and_interpretation.html#cb84-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">1.15</span>, <span class="fl">0.15</span>, <span class="fl">0.53</span>, <span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb84-76"><a href="id_04_model_validation_and_interpretation.html#cb84-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.05</span>),</span>
<span id="cb84-77"><a href="id_04_model_validation_and_interpretation.html#cb84-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb84-78"><a href="id_04_model_validation_and_interpretation.html#cb84-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)</span>
<span id="cb84-79"><a href="id_04_model_validation_and_interpretation.html#cb84-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-80"><a href="id_04_model_validation_and_interpretation.html#cb84-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-81"><a href="id_04_model_validation_and_interpretation.html#cb84-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb84-82"><a href="id_04_model_validation_and_interpretation.html#cb84-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-83"><a href="id_04_model_validation_and_interpretation.html#cb84-83" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(p3_1, p3_2, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">2.39</span>, <span class="fl">1.02</span>))</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%205%20mb%20vs%20cpp%20non-induced%20cells.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="overall-model-interpretation" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Overall model interpretation<a href="id_04_model_validation_and_interpretation.html#overall-model-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="melanin-binding-regression-2" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Melanin binding (regression)<a href="id_04_model_validation_and_interpretation.html#melanin-binding-regression-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb85-1"><a href="id_04_model_validation_and_interpretation.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save train and test sets in csv format</span></span>
<span id="cb85-2"><a href="id_04_model_validation_and_interpretation.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_mb_train_test_splits.RData&quot;</span>)</span>
<span id="cb85-3"><a href="id_04_model_validation_and_interpretation.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb85-4"><a href="id_04_model_validation_and_interpretation.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  prefix <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;outer_&quot;</span>, i)</span>
<span id="cb85-5"><a href="id_04_model_validation_and_interpretation.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  exp_dir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/Users/renee/Downloads/melanin_binding/&quot;</span>, prefix)</span>
<span id="cb85-6"><a href="id_04_model_validation_and_interpretation.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(outer_splits[[i]]<span class="sc">$</span>train, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/train_set.csv&quot;</span>))</span>
<span id="cb85-7"><a href="id_04_model_validation_and_interpretation.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(outer_splits[[i]]<span class="sc">$</span>test, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/test_set.csv&quot;</span>))</span>
<span id="cb85-8"><a href="id_04_model_validation_and_interpretation.html#cb85-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-9"><a href="id_04_model_validation_and_interpretation.html#cb85-9" aria-hidden="true" tabindex="-1"></a>exp_dir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/Users/renee/Downloads/melanin_binding/whole_data_set&quot;</span>)</span>
<span id="cb85-10"><a href="id_04_model_validation_and_interpretation.html#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(mb_data, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/train_set.csv&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb86-1"><a href="id_04_model_validation_and_interpretation.html#cb86-1" aria-hidden="true" tabindex="-1"></a>h2o.init(nthreads<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb86-2"><a href="id_04_model_validation_and_interpretation.html#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="id_04_model_validation_and_interpretation.html#cb86-3" aria-hidden="true" tabindex="-1"></a>dir_path <span class="op">=</span> <span class="st">&#39;/Users/renee/Downloads/melanin_binding&#39;</span></span>
<span id="cb86-4"><a href="id_04_model_validation_and_interpretation.html#cb86-4" aria-hidden="true" tabindex="-1"></a>model_names <span class="op">=</span> [<span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_2&#39;</span>, <span class="st">&#39;superlearner_iter_2&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, </span>
<span id="cb86-5"><a href="id_04_model_validation_and_interpretation.html#cb86-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, </span>
<span id="cb86-6"><a href="id_04_model_validation_and_interpretation.html#cb86-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;superlearner_iter_4&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>]</span>
<span id="cb86-7"><a href="id_04_model_validation_and_interpretation.html#cb86-7" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> []</span>
<span id="cb86-8"><a href="id_04_model_validation_and_interpretation.html#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb86-9"><a href="id_04_model_validation_and_interpretation.html#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Iter &#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;:&#39;</span>)</span>
<span id="cb86-10"><a href="id_04_model_validation_and_interpretation.html#cb86-10" aria-hidden="true" tabindex="-1"></a>    train <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/train_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb86-11"><a href="id_04_model_validation_and_interpretation.html#cb86-11" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> train.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb86-12"><a href="id_04_model_validation_and_interpretation.html#cb86-12" aria-hidden="true" tabindex="-1"></a>    test <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/test_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb86-13"><a href="id_04_model_validation_and_interpretation.html#cb86-13" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> test.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb86-14"><a href="id_04_model_validation_and_interpretation.html#cb86-14" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> h2o.load_model(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/&#39;</span> <span class="op">+</span> model_names[i])</span>
<span id="cb86-15"><a href="id_04_model_validation_and_interpretation.html#cb86-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> model_predict_(data):</span>
<span id="cb86-16"><a href="id_04_model_validation_and_interpretation.html#cb86-16" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb86-17"><a href="id_04_model_validation_and_interpretation.html#cb86-17" aria-hidden="true" tabindex="-1"></a>        h2o_data <span class="op">=</span> h2o.H2OFrame(data)</span>
<span id="cb86-18"><a href="id_04_model_validation_and_interpretation.html#cb86-18" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> model.predict(h2o_data)</span>
<span id="cb86-19"><a href="id_04_model_validation_and_interpretation.html#cb86-19" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> res.as_data_frame()</span>
<span id="cb86-20"><a href="id_04_model_validation_and_interpretation.html#cb86-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(res)</span>
<span id="cb86-21"><a href="id_04_model_validation_and_interpretation.html#cb86-21" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">1</span>)</span>
<span id="cb86-22"><a href="id_04_model_validation_and_interpretation.html#cb86-22" aria-hidden="true" tabindex="-1"></a>    X_train_ <span class="op">=</span> X_train.iloc[np.random.choice(X_train.shape[<span class="dv">0</span>], <span class="dv">100</span>, replace<span class="op">=</span><span class="va">False</span>), :]</span>
<span id="cb86-23"><a href="id_04_model_validation_and_interpretation.html#cb86-23" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> shap.KernelExplainer(model_predict_, X_train_, link<span class="op">=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb86-24"><a href="id_04_model_validation_and_interpretation.html#cb86-24" aria-hidden="true" tabindex="-1"></a>    shap_values <span class="op">=</span> explainer.shap_values(X_test, nsamples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb86-25"><a href="id_04_model_validation_and_interpretation.html#cb86-25" aria-hidden="true" tabindex="-1"></a>    shap_res.append(shap_values)</span>
<span id="cb86-26"><a href="id_04_model_validation_and_interpretation.html#cb86-26" aria-hidden="true" tabindex="-1"></a>    h2o.remove_all()</span>
<span id="cb86-27"><a href="id_04_model_validation_and_interpretation.html#cb86-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-28"><a href="id_04_model_validation_and_interpretation.html#cb86-28" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> pd.DataFrame(np.vstack(shap_res), columns<span class="op">=</span>X_train.columns)</span>
<span id="cb86-29"><a href="id_04_model_validation_and_interpretation.html#cb86-29" aria-hidden="true" tabindex="-1"></a>shap_res.to_csv(<span class="st">&#39;./other_data/mb_shap_values_cv_data_sets.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb87-1"><a href="id_04_model_validation_and_interpretation.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_mb_train_test_splits.RData&quot;</span>)</span>
<span id="cb87-2"><a href="id_04_model_validation_and_interpretation.html#cb87-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(outer_splits, <span class="cf">function</span>(x) x<span class="sc">$</span>test[<span class="sc">-</span><span class="fu">ncol</span>(mb_data)]))</span>
<span id="cb87-3"><a href="id_04_model_validation_and_interpretation.html#cb87-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">rank</span>(x))</span>
<span id="cb87-4"><a href="id_04_model_validation_and_interpretation.html#cb87-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">rescale</span>(x, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)))</span>
<span id="cb87-5"><a href="id_04_model_validation_and_interpretation.html#cb87-5" aria-hidden="true" tabindex="-1"></a>shap_values <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">&quot;./other_data/mb_shap_values_cv_data_sets.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>))</span>
<span id="cb87-6"><a href="id_04_model_validation_and_interpretation.html#cb87-6" aria-hidden="true" tabindex="-1"></a>shap_values <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rescale</span>(shap_values, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">from =</span> <span class="fu">range</span>(mb_data<span class="sc">$</span>log_intensity)))</span>
<span id="cb87-7"><a href="id_04_model_validation_and_interpretation.html#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="id_04_model_validation_and_interpretation.html#cb87-8" aria-hidden="true" tabindex="-1"></a>var_diff <span class="ot">&lt;-</span> <span class="fu">apply</span>(shap_values, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb87-9"><a href="id_04_model_validation_and_interpretation.html#cb87-9" aria-hidden="true" tabindex="-1"></a>var_diff <span class="ot">&lt;-</span> var_diff[<span class="fu">order</span>(<span class="sc">-</span>var_diff)]</span>
<span id="cb87-10"><a href="id_04_model_validation_and_interpretation.html#cb87-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb87-11"><a href="id_04_model_validation_and_interpretation.html#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">melt</span>(shap_values)<span class="sc">$</span>variable,</span>
<span id="cb87-12"><a href="id_04_model_validation_and_interpretation.html#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">shap =</span> <span class="fu">melt</span>(shap_values)<span class="sc">$</span>value,</span>
<span id="cb87-13"><a href="id_04_model_validation_and_interpretation.html#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable_value =</span> <span class="fu">melt</span>(data)<span class="sc">$</span>value</span>
<span id="cb87-14"><a href="id_04_model_validation_and_interpretation.html#cb87-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb88-1"><a href="id_04_model_validation_and_interpretation.html#cb88-1" aria-hidden="true" tabindex="-1"></a>top_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(var_diff)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb88-2"><a href="id_04_model_validation_and_interpretation.html#cb88-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>variable <span class="sc">%in%</span> top_vars, ]</span>
<span id="cb88-3"><a href="id_04_model_validation_and_interpretation.html#cb88-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>variable, <span class="at">levels =</span> <span class="fu">rev</span>(top_vars), <span class="at">labels =</span> <span class="fu">rev</span>(top_vars))</span>
<span id="cb88-4"><a href="id_04_model_validation_and_interpretation.html#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="id_04_model_validation_and_interpretation.html#cb88-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> shap, <span class="at">y =</span> variable)) <span class="sc">+</span></span>
<span id="cb88-6"><a href="id_04_model_validation_and_interpretation.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> top_vars, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-7"><a href="id_04_model_validation_and_interpretation.html#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-8"><a href="id_04_model_validation_and_interpretation.html#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable_value), <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="st">&quot;auto&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb88-9"><a href="id_04_model_validation_and_interpretation.html#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#d62728&quot;</span>, <span class="at">midpoint =</span> <span class="dv">50</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>)) <span class="sc">+</span></span>
<span id="cb88-10"><a href="id_04_model_validation_and_interpretation.html#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb88-11"><a href="id_04_model_validation_and_interpretation.html#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb88-12"><a href="id_04_model_validation_and_interpretation.html#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="fl">1.5</span>, <span class="dv">8</span>, <span class="fl">1.5</span>, <span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb88-13"><a href="id_04_model_validation_and_interpretation.html#cb88-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-14"><a href="id_04_model_validation_and_interpretation.html#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-15"><a href="id_04_model_validation_and_interpretation.html#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-16"><a href="id_04_model_validation_and_interpretation.html#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-17"><a href="id_04_model_validation_and_interpretation.html#cb88-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb88-18"><a href="id_04_model_validation_and_interpretation.html#cb88-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb88-19"><a href="id_04_model_validation_and_interpretation.html#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb88-20"><a href="id_04_model_validation_and_interpretation.html#cb88-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb88-21"><a href="id_04_model_validation_and_interpretation.html#cb88-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb88-22"><a href="id_04_model_validation_and_interpretation.html#cb88-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb88-23"><a href="id_04_model_validation_and_interpretation.html#cb88-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb88-24"><a href="id_04_model_validation_and_interpretation.html#cb88-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb88-25"><a href="id_04_model_validation_and_interpretation.html#cb88-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span></span>
<span id="cb88-26"><a href="id_04_model_validation_and_interpretation.html#cb88-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-27"><a href="id_04_model_validation_and_interpretation.html#cb88-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb88-28"><a href="id_04_model_validation_and_interpretation.html#cb88-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="st">&quot;Variable</span><span class="sc">\n</span><span class="st">value</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">ticks =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">10</span>, <span class="at">barwidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb88-29"><a href="id_04_model_validation_and_interpretation.html#cb88-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb88-30"><a href="id_04_model_validation_and_interpretation.html#cb88-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-31"><a href="id_04_model_validation_and_interpretation.html#cb88-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;SHAP value</span><span class="sc">\n</span><span class="st">(variable contribution to model prediction)&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-32"><a href="id_04_model_validation_and_interpretation.html#cb88-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-33"><a href="id_04_model_validation_and_interpretation.html#cb88-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Melanin binding&quot;</span>)</span></code></pre></div>
<p><img src="figures/Fig%204%20mb.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="cell-penetration-classification-2" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Cell-penetration (classification)<a href="id_04_model_validation_and_interpretation.html#cell-penetration-classification-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb89-1"><a href="id_04_model_validation_and_interpretation.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save train and test sets in csv format</span></span>
<span id="cb89-2"><a href="id_04_model_validation_and_interpretation.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_cpp_train_test_splits.RData&quot;</span>)</span>
<span id="cb89-3"><a href="id_04_model_validation_and_interpretation.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb89-4"><a href="id_04_model_validation_and_interpretation.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  prefix <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;outer_&quot;</span>, i)</span>
<span id="cb89-5"><a href="id_04_model_validation_and_interpretation.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  exp_dir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/Users/renee/Downloads/cell_penetration/&quot;</span>, prefix)</span>
<span id="cb89-6"><a href="id_04_model_validation_and_interpretation.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(outer_splits[[i]]<span class="sc">$</span>train, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/train_set.csv&quot;</span>))</span>
<span id="cb89-7"><a href="id_04_model_validation_and_interpretation.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(outer_splits[[i]]<span class="sc">$</span>test, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/test_set.csv&quot;</span>))</span>
<span id="cb89-8"><a href="id_04_model_validation_and_interpretation.html#cb89-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-9"><a href="id_04_model_validation_and_interpretation.html#cb89-9" aria-hidden="true" tabindex="-1"></a>exp_dir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/Users/renee/Downloads/cell_penetration/whole_data_set&quot;</span>)</span>
<span id="cb89-10"><a href="id_04_model_validation_and_interpretation.html#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(cpp_data, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/train_set.csv&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb90-1"><a href="id_04_model_validation_and_interpretation.html#cb90-1" aria-hidden="true" tabindex="-1"></a>h2o.init(nthreads<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb90-2"><a href="id_04_model_validation_and_interpretation.html#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="id_04_model_validation_and_interpretation.html#cb90-3" aria-hidden="true" tabindex="-1"></a>dir_path <span class="op">=</span> <span class="st">&#39;/Users/renee/Downloads/cell_penetration&#39;</span></span>
<span id="cb90-4"><a href="id_04_model_validation_and_interpretation.html#cb90-4" aria-hidden="true" tabindex="-1"></a>model_names <span class="op">=</span> [<span class="st">&#39;GBM_model_1669777615732_57632&#39;</span>, <span class="st">&#39;GBM_model_1669777615732_225117&#39;</span>, <span class="st">&#39;GBM_model_1669777615732_387368&#39;</span>, </span>
<span id="cb90-5"><a href="id_04_model_validation_and_interpretation.html#cb90-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;GBM_model_1669777615732_552677&#39;</span>, <span class="st">&#39;GBM_model_1669777615732_717390&#39;</span>, <span class="st">&#39;GBM_model_1669777538393_67146&#39;</span>,  </span>
<span id="cb90-6"><a href="id_04_model_validation_and_interpretation.html#cb90-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;GBM_model_1669777538393_246060&#39;</span>, <span class="st">&#39;GBM_model_1669777538393_420437&#39;</span>, <span class="st">&#39;GBM_model_1669777538393_602358&#39;</span>, </span>
<span id="cb90-7"><a href="id_04_model_validation_and_interpretation.html#cb90-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;GBM_model_1669777538393_782798&#39;</span>]</span>
<span id="cb90-8"><a href="id_04_model_validation_and_interpretation.html#cb90-8" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> []</span>
<span id="cb90-9"><a href="id_04_model_validation_and_interpretation.html#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb90-10"><a href="id_04_model_validation_and_interpretation.html#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Iter &#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;:&#39;</span>)</span>
<span id="cb90-11"><a href="id_04_model_validation_and_interpretation.html#cb90-11" aria-hidden="true" tabindex="-1"></a>    train <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/train_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb90-12"><a href="id_04_model_validation_and_interpretation.html#cb90-12" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> train.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-13"><a href="id_04_model_validation_and_interpretation.html#cb90-13" aria-hidden="true" tabindex="-1"></a>    test <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/test_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb90-14"><a href="id_04_model_validation_and_interpretation.html#cb90-14" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> test.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-15"><a href="id_04_model_validation_and_interpretation.html#cb90-15" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> h2o.load_model(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/&#39;</span> <span class="op">+</span> model_names[i])</span>
<span id="cb90-16"><a href="id_04_model_validation_and_interpretation.html#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> model_predict_(data):</span>
<span id="cb90-17"><a href="id_04_model_validation_and_interpretation.html#cb90-17" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb90-18"><a href="id_04_model_validation_and_interpretation.html#cb90-18" aria-hidden="true" tabindex="-1"></a>        h2o_data <span class="op">=</span> h2o.H2OFrame(data)</span>
<span id="cb90-19"><a href="id_04_model_validation_and_interpretation.html#cb90-19" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> model.predict(h2o_data)</span>
<span id="cb90-20"><a href="id_04_model_validation_and_interpretation.html#cb90-20" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> res.as_data_frame().iloc[:,<span class="dv">2</span>]</span>
<span id="cb90-21"><a href="id_04_model_validation_and_interpretation.html#cb90-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(res)</span>
<span id="cb90-22"><a href="id_04_model_validation_and_interpretation.html#cb90-22" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">1</span>)</span>
<span id="cb90-23"><a href="id_04_model_validation_and_interpretation.html#cb90-23" aria-hidden="true" tabindex="-1"></a>    X_train_ <span class="op">=</span> X_train.iloc[np.random.choice(X_train.shape[<span class="dv">0</span>], <span class="dv">100</span>, replace<span class="op">=</span><span class="va">False</span>), :]</span>
<span id="cb90-24"><a href="id_04_model_validation_and_interpretation.html#cb90-24" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> shap.KernelExplainer(model_predict_, X_train_, link<span class="op">=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb90-25"><a href="id_04_model_validation_and_interpretation.html#cb90-25" aria-hidden="true" tabindex="-1"></a>    shap_values <span class="op">=</span> explainer.shap_values(X_test, nsamples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb90-26"><a href="id_04_model_validation_and_interpretation.html#cb90-26" aria-hidden="true" tabindex="-1"></a>    shap_res.append(shap_values)</span>
<span id="cb90-27"><a href="id_04_model_validation_and_interpretation.html#cb90-27" aria-hidden="true" tabindex="-1"></a>    h2o.remove_all()</span>
<span id="cb90-28"><a href="id_04_model_validation_and_interpretation.html#cb90-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-29"><a href="id_04_model_validation_and_interpretation.html#cb90-29" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> pd.DataFrame(np.vstack(shap_res), columns<span class="op">=</span>X_train.columns)</span>
<span id="cb90-30"><a href="id_04_model_validation_and_interpretation.html#cb90-30" aria-hidden="true" tabindex="-1"></a>shap_res.to_csv(<span class="st">&#39;./other_data/cpp_shap_values_cv_data_sets.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb91-1"><a href="id_04_model_validation_and_interpretation.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_cpp_train_test_splits.RData&quot;</span>)</span>
<span id="cb91-2"><a href="id_04_model_validation_and_interpretation.html#cb91-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(outer_splits, <span class="cf">function</span>(x) x<span class="sc">$</span>test[<span class="sc">-</span><span class="fu">ncol</span>(cpp_data)]))</span>
<span id="cb91-3"><a href="id_04_model_validation_and_interpretation.html#cb91-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">rank</span>(x))</span>
<span id="cb91-4"><a href="id_04_model_validation_and_interpretation.html#cb91-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">rescale</span>(x, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)))</span>
<span id="cb91-5"><a href="id_04_model_validation_and_interpretation.html#cb91-5" aria-hidden="true" tabindex="-1"></a>shap_values <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/cpp_shap_values_cv_data_sets.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb91-6"><a href="id_04_model_validation_and_interpretation.html#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="id_04_model_validation_and_interpretation.html#cb91-7" aria-hidden="true" tabindex="-1"></a>var_diff <span class="ot">&lt;-</span> <span class="fu">apply</span>(shap_values, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb91-8"><a href="id_04_model_validation_and_interpretation.html#cb91-8" aria-hidden="true" tabindex="-1"></a>var_diff <span class="ot">&lt;-</span> var_diff[<span class="fu">order</span>(<span class="sc">-</span>var_diff)]</span>
<span id="cb91-9"><a href="id_04_model_validation_and_interpretation.html#cb91-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb91-10"><a href="id_04_model_validation_and_interpretation.html#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">melt</span>(shap_values)<span class="sc">$</span>variable,</span>
<span id="cb91-11"><a href="id_04_model_validation_and_interpretation.html#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">shap =</span> <span class="fu">melt</span>(shap_values)<span class="sc">$</span>value,</span>
<span id="cb91-12"><a href="id_04_model_validation_and_interpretation.html#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable_value =</span> <span class="fu">melt</span>(data)<span class="sc">$</span>value</span>
<span id="cb91-13"><a href="id_04_model_validation_and_interpretation.html#cb91-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb92-1"><a href="id_04_model_validation_and_interpretation.html#cb92-1" aria-hidden="true" tabindex="-1"></a>top_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(var_diff)[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb92-2"><a href="id_04_model_validation_and_interpretation.html#cb92-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>variable <span class="sc">%in%</span> top_vars, ]</span>
<span id="cb92-3"><a href="id_04_model_validation_and_interpretation.html#cb92-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>variable, <span class="at">levels =</span> <span class="fu">rev</span>(top_vars), <span class="at">labels =</span> <span class="fu">rev</span>(top_vars))</span>
<span id="cb92-4"><a href="id_04_model_validation_and_interpretation.html#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="id_04_model_validation_and_interpretation.html#cb92-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> shap, <span class="at">y =</span> variable)) <span class="sc">+</span></span>
<span id="cb92-6"><a href="id_04_model_validation_and_interpretation.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> top_vars, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-7"><a href="id_04_model_validation_and_interpretation.html#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb92-8"><a href="id_04_model_validation_and_interpretation.html#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable_value), <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="st">&quot;auto&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb92-9"><a href="id_04_model_validation_and_interpretation.html#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#d62728&quot;</span>, <span class="at">midpoint =</span> <span class="dv">50</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>)) <span class="sc">+</span></span>
<span id="cb92-10"><a href="id_04_model_validation_and_interpretation.html#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb92-11"><a href="id_04_model_validation_and_interpretation.html#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb92-12"><a href="id_04_model_validation_and_interpretation.html#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="fl">1.5</span>, <span class="dv">8</span>, <span class="fl">1.5</span>, <span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb92-13"><a href="id_04_model_validation_and_interpretation.html#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb92-14"><a href="id_04_model_validation_and_interpretation.html#cb92-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb92-15"><a href="id_04_model_validation_and_interpretation.html#cb92-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb92-16"><a href="id_04_model_validation_and_interpretation.html#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb92-17"><a href="id_04_model_validation_and_interpretation.html#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb92-18"><a href="id_04_model_validation_and_interpretation.html#cb92-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb92-19"><a href="id_04_model_validation_and_interpretation.html#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb92-20"><a href="id_04_model_validation_and_interpretation.html#cb92-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb92-21"><a href="id_04_model_validation_and_interpretation.html#cb92-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb92-22"><a href="id_04_model_validation_and_interpretation.html#cb92-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb92-23"><a href="id_04_model_validation_and_interpretation.html#cb92-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb92-24"><a href="id_04_model_validation_and_interpretation.html#cb92-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb92-25"><a href="id_04_model_validation_and_interpretation.html#cb92-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span></span>
<span id="cb92-26"><a href="id_04_model_validation_and_interpretation.html#cb92-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb92-27"><a href="id_04_model_validation_and_interpretation.html#cb92-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb92-28"><a href="id_04_model_validation_and_interpretation.html#cb92-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="st">&quot;Variable</span><span class="sc">\n</span><span class="st">value</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">ticks =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">10</span>, <span class="at">barwidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb92-29"><a href="id_04_model_validation_and_interpretation.html#cb92-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb92-30"><a href="id_04_model_validation_and_interpretation.html#cb92-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb92-31"><a href="id_04_model_validation_and_interpretation.html#cb92-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;SHAP value</span><span class="sc">\n</span><span class="st">(variable contribution to model prediction)&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-32"><a href="id_04_model_validation_and_interpretation.html#cb92-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-33"><a href="id_04_model_validation_and_interpretation.html#cb92-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Cell-penetration&quot;</span>)</span></code></pre></div>
<p><img src="figures/Fig%204%20cpp.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="toxicity-classification-2" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Toxicity (classification)<a href="id_04_model_validation_and_interpretation.html#toxicity-classification-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb93-1"><a href="id_04_model_validation_and_interpretation.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save train and test sets in csv format</span></span>
<span id="cb93-2"><a href="id_04_model_validation_and_interpretation.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_tx_train_test_splits.RData&quot;</span>)</span>
<span id="cb93-3"><a href="id_04_model_validation_and_interpretation.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb93-4"><a href="id_04_model_validation_and_interpretation.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  prefix <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;outer_&quot;</span>, i)</span>
<span id="cb93-5"><a href="id_04_model_validation_and_interpretation.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  exp_dir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/Users/renee/Downloads/toxicity/&quot;</span>, prefix)</span>
<span id="cb93-6"><a href="id_04_model_validation_and_interpretation.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(outer_splits[[i]]<span class="sc">$</span>train, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/train_set.csv&quot;</span>))</span>
<span id="cb93-7"><a href="id_04_model_validation_and_interpretation.html#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(outer_splits[[i]]<span class="sc">$</span>test, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/test_set.csv&quot;</span>))</span>
<span id="cb93-8"><a href="id_04_model_validation_and_interpretation.html#cb93-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-9"><a href="id_04_model_validation_and_interpretation.html#cb93-9" aria-hidden="true" tabindex="-1"></a>exp_dir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/Users/renee/Downloads/toxicity/whole_data_set&quot;</span>)</span>
<span id="cb93-10"><a href="id_04_model_validation_and_interpretation.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tx_data, <span class="at">file =</span> <span class="fu">paste0</span>(exp_dir, <span class="st">&quot;/train_set.csv&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb94-1"><a href="id_04_model_validation_and_interpretation.html#cb94-1" aria-hidden="true" tabindex="-1"></a>h2o.init(nthreads<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb94-2"><a href="id_04_model_validation_and_interpretation.html#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="id_04_model_validation_and_interpretation.html#cb94-3" aria-hidden="true" tabindex="-1"></a>dir_path <span class="op">=</span> <span class="st">&#39;/Users/renee/Downloads/toxicity&#39;</span></span>
<span id="cb94-4"><a href="id_04_model_validation_and_interpretation.html#cb94-4" aria-hidden="true" tabindex="-1"></a>model_names <span class="op">=</span> [<span class="st">&#39;superlearner_iter_4&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>,</span>
<span id="cb94-5"><a href="id_04_model_validation_and_interpretation.html#cb94-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_4&#39;</span>,</span>
<span id="cb94-6"><a href="id_04_model_validation_and_interpretation.html#cb94-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;superlearner_iter_3&#39;</span>, <span class="st">&#39;superlearner_iter_4&#39;</span>]</span>
<span id="cb94-7"><a href="id_04_model_validation_and_interpretation.html#cb94-7" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> []</span>
<span id="cb94-8"><a href="id_04_model_validation_and_interpretation.html#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb94-9"><a href="id_04_model_validation_and_interpretation.html#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;Iter &#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;:&#39;</span>)</span>
<span id="cb94-10"><a href="id_04_model_validation_and_interpretation.html#cb94-10" aria-hidden="true" tabindex="-1"></a>    train <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/train_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb94-11"><a href="id_04_model_validation_and_interpretation.html#cb94-11" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> train.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb94-12"><a href="id_04_model_validation_and_interpretation.html#cb94-12" aria-hidden="true" tabindex="-1"></a>    test <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/test_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb94-13"><a href="id_04_model_validation_and_interpretation.html#cb94-13" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> test.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb94-14"><a href="id_04_model_validation_and_interpretation.html#cb94-14" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> h2o.load_model(dir_path <span class="op">+</span> <span class="st">&#39;/outer_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">&#39;/&#39;</span> <span class="op">+</span> model_names[i])</span>
<span id="cb94-15"><a href="id_04_model_validation_and_interpretation.html#cb94-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> model_predict_(data):</span>
<span id="cb94-16"><a href="id_04_model_validation_and_interpretation.html#cb94-16" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb94-17"><a href="id_04_model_validation_and_interpretation.html#cb94-17" aria-hidden="true" tabindex="-1"></a>        h2o_data <span class="op">=</span> h2o.H2OFrame(data)</span>
<span id="cb94-18"><a href="id_04_model_validation_and_interpretation.html#cb94-18" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> model.predict(h2o_data)</span>
<span id="cb94-19"><a href="id_04_model_validation_and_interpretation.html#cb94-19" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> res.as_data_frame().iloc[:,<span class="dv">2</span>] <span class="co"># 0:toxic; 1:non-toxic </span></span>
<span id="cb94-20"><a href="id_04_model_validation_and_interpretation.html#cb94-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(res)</span>
<span id="cb94-21"><a href="id_04_model_validation_and_interpretation.html#cb94-21" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">1</span>)</span>
<span id="cb94-22"><a href="id_04_model_validation_and_interpretation.html#cb94-22" aria-hidden="true" tabindex="-1"></a>    X_train_ <span class="op">=</span> X_train.iloc[np.random.choice(X_train.shape[<span class="dv">0</span>], <span class="dv">100</span>, replace<span class="op">=</span><span class="va">False</span>), :]</span>
<span id="cb94-23"><a href="id_04_model_validation_and_interpretation.html#cb94-23" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> shap.KernelExplainer(model_predict_, X_train_, link<span class="op">=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb94-24"><a href="id_04_model_validation_and_interpretation.html#cb94-24" aria-hidden="true" tabindex="-1"></a>    shap_values <span class="op">=</span> explainer.shap_values(X_test, nsamples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb94-25"><a href="id_04_model_validation_and_interpretation.html#cb94-25" aria-hidden="true" tabindex="-1"></a>    shap_res.append(shap_values)</span>
<span id="cb94-26"><a href="id_04_model_validation_and_interpretation.html#cb94-26" aria-hidden="true" tabindex="-1"></a>    h2o.remove_all()</span>
<span id="cb94-27"><a href="id_04_model_validation_and_interpretation.html#cb94-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-28"><a href="id_04_model_validation_and_interpretation.html#cb94-28" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> pd.DataFrame(np.vstack(shap_res), columns<span class="op">=</span>X_train.columns)</span>
<span id="cb94-29"><a href="id_04_model_validation_and_interpretation.html#cb94-29" aria-hidden="true" tabindex="-1"></a>shap_res.to_csv(<span class="st">&#39;./other_data/tx_shap_values_cv_data_sets.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb95-1"><a href="id_04_model_validation_and_interpretation.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/var_reduct_tx_train_test_splits.RData&quot;</span>)</span>
<span id="cb95-2"><a href="id_04_model_validation_and_interpretation.html#cb95-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(outer_splits, <span class="cf">function</span>(x) x<span class="sc">$</span>test[<span class="sc">-</span><span class="fu">ncol</span>(tx_data)]))</span>
<span id="cb95-3"><a href="id_04_model_validation_and_interpretation.html#cb95-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">rank</span>(x))</span>
<span id="cb95-4"><a href="id_04_model_validation_and_interpretation.html#cb95-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">rescale</span>(x, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)))</span>
<span id="cb95-5"><a href="id_04_model_validation_and_interpretation.html#cb95-5" aria-hidden="true" tabindex="-1"></a>shap_values <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/tx_shap_values_cv_data_sets.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb95-6"><a href="id_04_model_validation_and_interpretation.html#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="id_04_model_validation_and_interpretation.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb95-8"><a href="id_04_model_validation_and_interpretation.html#cb95-8" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="dv">2500</span>)</span>
<span id="cb95-9"><a href="id_04_model_validation_and_interpretation.html#cb95-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[ind, ]</span>
<span id="cb95-10"><a href="id_04_model_validation_and_interpretation.html#cb95-10" aria-hidden="true" tabindex="-1"></a>shap_values <span class="ot">&lt;-</span> shap_values[ind, ]</span>
<span id="cb95-11"><a href="id_04_model_validation_and_interpretation.html#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="id_04_model_validation_and_interpretation.html#cb95-12" aria-hidden="true" tabindex="-1"></a>var_diff <span class="ot">&lt;-</span> <span class="fu">apply</span>(shap_values, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb95-13"><a href="id_04_model_validation_and_interpretation.html#cb95-13" aria-hidden="true" tabindex="-1"></a>var_diff <span class="ot">&lt;-</span> var_diff[<span class="fu">order</span>(<span class="sc">-</span>var_diff)]</span>
<span id="cb95-14"><a href="id_04_model_validation_and_interpretation.html#cb95-14" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb95-15"><a href="id_04_model_validation_and_interpretation.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">melt</span>(shap_values)<span class="sc">$</span>variable,</span>
<span id="cb95-16"><a href="id_04_model_validation_and_interpretation.html#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">shap =</span> <span class="fu">melt</span>(shap_values)<span class="sc">$</span>value,</span>
<span id="cb95-17"><a href="id_04_model_validation_and_interpretation.html#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable_value =</span> <span class="fu">melt</span>(data)<span class="sc">$</span>value</span>
<span id="cb95-18"><a href="id_04_model_validation_and_interpretation.html#cb95-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb96-1"><a href="id_04_model_validation_and_interpretation.html#cb96-1" aria-hidden="true" tabindex="-1"></a>top_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(var_diff)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb96-2"><a href="id_04_model_validation_and_interpretation.html#cb96-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>variable <span class="sc">%in%</span> top_vars, ]</span>
<span id="cb96-3"><a href="id_04_model_validation_and_interpretation.html#cb96-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>variable, <span class="at">levels =</span> <span class="fu">rev</span>(top_vars), <span class="at">labels =</span> <span class="fu">rev</span>(top_vars))</span>
<span id="cb96-4"><a href="id_04_model_validation_and_interpretation.html#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="id_04_model_validation_and_interpretation.html#cb96-5" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> shap, <span class="at">y =</span> variable)) <span class="sc">+</span></span>
<span id="cb96-6"><a href="id_04_model_validation_and_interpretation.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> top_vars, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-7"><a href="id_04_model_validation_and_interpretation.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb96-8"><a href="id_04_model_validation_and_interpretation.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable_value), <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="st">&quot;auto&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb96-9"><a href="id_04_model_validation_and_interpretation.html#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#d62728&quot;</span>, <span class="at">midpoint =</span> <span class="dv">50</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>)) <span class="sc">+</span></span>
<span id="cb96-10"><a href="id_04_model_validation_and_interpretation.html#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-11"><a href="id_04_model_validation_and_interpretation.html#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb96-12"><a href="id_04_model_validation_and_interpretation.html#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="fl">1.5</span>, <span class="dv">8</span>, <span class="fl">1.5</span>, <span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb96-13"><a href="id_04_model_validation_and_interpretation.html#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-14"><a href="id_04_model_validation_and_interpretation.html#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-15"><a href="id_04_model_validation_and_interpretation.html#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-16"><a href="id_04_model_validation_and_interpretation.html#cb96-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-17"><a href="id_04_model_validation_and_interpretation.html#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb96-18"><a href="id_04_model_validation_and_interpretation.html#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb96-19"><a href="id_04_model_validation_and_interpretation.html#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb96-20"><a href="id_04_model_validation_and_interpretation.html#cb96-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb96-21"><a href="id_04_model_validation_and_interpretation.html#cb96-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb96-22"><a href="id_04_model_validation_and_interpretation.html#cb96-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb96-23"><a href="id_04_model_validation_and_interpretation.html#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb96-24"><a href="id_04_model_validation_and_interpretation.html#cb96-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb96-25"><a href="id_04_model_validation_and_interpretation.html#cb96-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span></span>
<span id="cb96-26"><a href="id_04_model_validation_and_interpretation.html#cb96-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-27"><a href="id_04_model_validation_and_interpretation.html#cb96-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb96-28"><a href="id_04_model_validation_and_interpretation.html#cb96-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="st">&quot;Variable</span><span class="sc">\n</span><span class="st">value</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">ticks =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">10</span>, <span class="at">barwidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb96-29"><a href="id_04_model_validation_and_interpretation.html#cb96-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb96-30"><a href="id_04_model_validation_and_interpretation.html#cb96-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-31"><a href="id_04_model_validation_and_interpretation.html#cb96-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;SHAP value</span><span class="sc">\n</span><span class="st">(variable contribution to model prediction)&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-32"><a href="id_04_model_validation_and_interpretation.html#cb96-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-33"><a href="id_04_model_validation_and_interpretation.html#cb96-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Non-toxic&quot;</span>)</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%206%20tx.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multifunctional-peptide-selection" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Multifunctional peptide selection<a href="id_04_model_validation_and_interpretation.html#multifunctional-peptide-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb97-1"><a href="id_04_model_validation_and_interpretation.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">&quot;./rdata/tsne_res.RData&quot;</span>))</span>
<span id="cb97-2"><a href="id_04_model_validation_and_interpretation.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">&quot;./rdata/var_reduct_mb_train_test_splits.RData&quot;</span>))</span>
<span id="cb97-3"><a href="id_04_model_validation_and_interpretation.html#cb97-3" aria-hidden="true" tabindex="-1"></a>tsne_df<span class="sc">$</span>mb_predict <span class="ot">&lt;-</span> <span class="fu">rescale</span>(tsne_df<span class="sc">$</span>mb_predict, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">from =</span> <span class="fu">range</span>(mb_data<span class="sc">$</span>log_intensity))</span>
<span id="cb97-4"><a href="id_04_model_validation_and_interpretation.html#cb97-4" aria-hidden="true" tabindex="-1"></a>tsne_df<span class="sc">$</span>mb_predict[tsne_df<span class="sc">$</span>mb_predict <span class="sc">&gt;</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb98-1"><a href="id_04_model_validation_and_interpretation.html#cb98-1" aria-hidden="true" tabindex="-1"></a>tsne_df_ <span class="ot">&lt;-</span> tsne_df[tsne_df<span class="sc">$</span>source <span class="sc">==</span> <span class="st">&quot;Validation control&quot;</span> <span class="sc">|</span> tsne_df<span class="sc">$</span>source <span class="sc">==</span> <span class="st">&quot;Validation set&quot;</span>, ]</span>
<span id="cb98-2"><a href="id_04_model_validation_and_interpretation.html#cb98-2" aria-hidden="true" tabindex="-1"></a>tsne_df_<span class="sc">$</span>note[tsne_df_<span class="sc">$</span>note <span class="sc">==</span> <span class="st">&quot;TAT&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb98-3"><a href="id_04_model_validation_and_interpretation.html#cb98-3" aria-hidden="true" tabindex="-1"></a>tsne_df_<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sapply</span>(tsne_df_<span class="sc">$</span>note, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.na</span>(x)) <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>))</span>
<span id="cb98-4"><a href="id_04_model_validation_and_interpretation.html#cb98-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(tsne_df_, <span class="at">x =</span> <span class="sc">~</span>in_vitro_mb_value, <span class="at">y =</span> <span class="sc">~</span>in_vitro_cp_value, <span class="at">z =</span> <span class="sc">~</span>non_tx_prob, <span class="at">text =</span> <span class="sc">~</span>note, <span class="at">color =</span> <span class="sc">~</span>color, <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">&quot;grey70&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">600</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-5"><a href="id_04_model_validation_and_interpretation.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb98-6"><a href="id_04_model_validation_and_interpretation.html#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="fl">0.5</span>)),</span>
<span id="cb98-7"><a href="id_04_model_validation_and_interpretation.html#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>, <span class="at">mode =</span> <span class="st">&quot;text+markers&quot;</span></span>
<span id="cb98-8"><a href="id_04_model_validation_and_interpretation.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb98-9"><a href="id_04_model_validation_and_interpretation.html#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb98-10"><a href="id_04_model_validation_and_interpretation.html#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb98-11"><a href="id_04_model_validation_and_interpretation.html#cb98-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb98-12"><a href="id_04_model_validation_and_interpretation.html#cb98-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Peptide bound to mNPs (%)&quot;</span>,</span>
<span id="cb98-13"><a href="id_04_model_validation_and_interpretation.html#cb98-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb98-14"><a href="id_04_model_validation_and_interpretation.html#cb98-14" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb98-15"><a href="id_04_model_validation_and_interpretation.html#cb98-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb98-16"><a href="id_04_model_validation_and_interpretation.html#cb98-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Peptide (pMol / 100K cells)&quot;</span>,</span>
<span id="cb98-17"><a href="id_04_model_validation_and_interpretation.html#cb98-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;log&quot;</span>,</span>
<span id="cb98-18"><a href="id_04_model_validation_and_interpretation.html#cb98-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">ticktext =</span> <span class="fu">list</span>(</span>
<span id="cb98-19"><a href="id_04_model_validation_and_interpretation.html#cb98-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;10&quot;</span>,</span>
<span id="cb98-20"><a href="id_04_model_validation_and_interpretation.html#cb98-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;50&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;100&quot;</span>,</span>
<span id="cb98-21"><a href="id_04_model_validation_and_interpretation.html#cb98-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;500&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;1,000&quot;</span></span>
<span id="cb98-22"><a href="id_04_model_validation_and_interpretation.html#cb98-22" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb98-23"><a href="id_04_model_validation_and_interpretation.html#cb98-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">tickvals =</span> <span class="fu">list</span>(</span>
<span id="cb98-24"><a href="id_04_model_validation_and_interpretation.html#cb98-24" aria-hidden="true" tabindex="-1"></a>          <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>,</span>
<span id="cb98-25"><a href="id_04_model_validation_and_interpretation.html#cb98-25" aria-hidden="true" tabindex="-1"></a>          <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>,</span>
<span id="cb98-26"><a href="id_04_model_validation_and_interpretation.html#cb98-26" aria-hidden="true" tabindex="-1"></a>          <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>, <span class="dv">700</span>, <span class="dv">800</span>, <span class="dv">900</span>, <span class="dv">1000</span></span>
<span id="cb98-27"><a href="id_04_model_validation_and_interpretation.html#cb98-27" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb98-28"><a href="id_04_model_validation_and_interpretation.html#cb98-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.63</span>, <span class="dv">3</span>)</span>
<span id="cb98-29"><a href="id_04_model_validation_and_interpretation.html#cb98-29" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb98-30"><a href="id_04_model_validation_and_interpretation.html#cb98-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">zaxis =</span> <span class="fu">list</span>(</span>
<span id="cb98-31"><a href="id_04_model_validation_and_interpretation.html#cb98-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Non-toxic prediction&quot;</span>,</span>
<span id="cb98-32"><a href="id_04_model_validation_and_interpretation.html#cb98-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb98-33"><a href="id_04_model_validation_and_interpretation.html#cb98-33" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb98-34"><a href="id_04_model_validation_and_interpretation.html#cb98-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb98-35"><a href="id_04_model_validation_and_interpretation.html#cb98-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span>, <span class="at">autosize =</span> <span class="cn">TRUE</span></span>
<span id="cb98-36"><a href="id_04_model_validation_and_interpretation.html#cb98-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-37"><a href="id_04_model_validation_and_interpretation.html#cb98-37" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<div id="htmlwidget-c32d25b3997f96f59bba" style="width:700px;height:600px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c32d25b3997f96f59bba">{"x":{"visdat":{"bb1439a5b362":["function () ","plotlyVisDat"]},"cur_data":"bb1439a5b362","attrs":{"bb1439a5b362":{"x":{},"y":{},"z":{},"text":{},"color":{},"colors":["grey70","black"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"marker":{"size":5,"line":{"color":"black","width":0.5}},"type":"scatter3d","mode":"text+markers","inherit":true}},"layout":{"width":700,"height":600,"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Peptide bound to mNPs (%)","range":[0,100]},"yaxis":{"title":"Peptide (pMol / 100K cells)","type":"log","ticktext":["","5","","","","","10","","","","50","","","","","100","","","","500","","","","","1,000"],"tickvals":[4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1000],"range":[0.63,3]},"zaxis":{"title":"Non-toxic prediction","range":[0,100]}},"showlegend":false,"autosize":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[82.00213675,79.7388535,86.77186667,83.27263333,61.986,90.999,82.2763,84.0203,51.81046667,73.764,74.16008772,63.811,82.64816667,89.9224,46.9609,50.50355,54.7334,67.23935,60.367275,35.728675,36.404025,44.490525,40.2429,73.364925,19.84595,58.81515,74.52605,31.79505,47.46445,66.52845,37.3578,29.32465,27.02015,48.133875,50.7642,68.015375,40.462075,78.88625,56.70615,74.6149,37.286725,42.328225,68.329375,73.992875,77.3756,67.695475,78.8981,69.74525,68.8448,75.515375,17.24525,46.2263,58.850725,73.175375,77.837675,60.5095,31.9846,74.591225,78.00355,51.913525,31.155175,63.513025,53.489325,75.248775,68.708525,71.09005,73.73815,77.677725,80.40285,65.622025,23.406375,78.51895,63.61375,27.091225,9.757125,46.57585,82.719225,63.25235,53.22275,46.054525,79.5794,31.919425,82.073475,16.16115,27.654,54.7512,22.227475,9.828225,12.3519,33.4775,22.2986,68.4301,74.786725,48.07465,71.723925,80.776075,78.29975,7.956175,81.629175,63.4892,91.13556667,88.35073333,71.13766667,89.38766667,68.93834901,89.82166667,86.27416667,81.72883333,90.55243333,88.32843333,87.3545,74.0464,77.5933,76.5674,77.64215,86.70466667,77.837675,76.095975,54.413525,74.0699,67.1386,76.676525,73.73815],"y":[656.3614333,419.3132,506.2580053,394.8582065,58.62736972,415.7436099,229.4220933,262.8914463,95.36898893,107.0634971,390.9190333,460.5121639,737.862,240.5565828,36.0544,55.2144,65.3744,275.8544,430.9344,27.5344,22.3344,80.8544,205.0944,282.8144,22.4144,158.6144,509.1744,22.4144,18.4544,142.6944,14.4144,28.6144,70.7344,32.6944,14.9344,118.9744,54.1344,412.6944,247.5344,297.0144,57.7744,17.1744,149.4944,396.3744,535.6544,239.7744,437.3344,447.2544,293.6944,491.3744,32.8544,97.3744,184.4944,44.1744,193.5744,99.4144,158.7344,187.2944,212.1744,432.2944,27.2944,373.6944,384.4144,290.4944,56.8144,395.4144,137.0144,202.3744,478.6144,366.5344,33.2944,300.3744,150.8144,17.2944,16.8544,127.7344,143.6944,144.2544,18.1744,23.2544,492.0144,10.5344,508.0144,22.8944,12.4144,60.3744,15.1744,11.9344,21.6144,44.9344,131.2944,365.5744,187.0944,31.7344,317.3344,255.8944,476.7344,20.2944,583.6544,91.45983877,399.3932599,95.36898893,179.5914095,599.5615135,451.5855667,124.9182111,460.5121639,95.36898893,179.5035634,460.5121639,376.0701281,516.7226685,64.08480688,179.5035634,457.0544,591.1502522,266.1344,390.2944,245.0144,327.6944,541.8144,284.3744,395.6944],"z":[94.1242181,96.2016397,95.4569674,97.0400116,97.4584564,95.6545494,97.3639006,97.5490159,94.3082948,96.4128403,95.6424081,97.3044899,90.8610595,90.9026062,96.521359,80.2298315,82.2226936,92.772348,87.1427575,94.8714644,9.533948,76.7701681,93.1061015,91.5329514,8.9284141,90.2555034,91.951399,65.6654295,13.2543327,97.0609721,92.7754052,95.9728883,96.4012539,94.7887826,96.3474958,94.9471226,96.9105827,97.0073541,97.5441733,86.7494647,96.1777461,95.6781982,93.4564034,88.4474646,94.4082601,96.744296,97.3259732,96.0469493,95.878681,96.5163165,97.2309755,68.9987286,96.0253414,96.6244691,95.978886,87.5613472,69.486282,97.5267081,94.5017762,94.9155727,97.4508382,94.3457361,97.4025518,97.4379233,94.8050643,94.1053895,96.5683469,95.4064538,94.6127377,97.3973976,85.8295915,88.6562682,86.8616491,96.8815211,95.3770833,90.2678973,96.4294007,74.2326571,94.8579753,96.6382599,96.3732377,26.6417455,96.0970138,96.1332037,97.2615085,95.7445338,97.2988943,97.5444871,97.4453706,33.0639789,32.2905594,97.1249253,90.090511,74.9979477,82.0129898,88.5477211,87.8384008,94.0824359,77.8012798,97.5314784,43.7100131,46.5929817,94.8532968,45.4408849,93.6110672,91.8516952,95.5913163,86.4847828,88.2168594,70.803083,97.5405322,79.5197902,76.8709341,95.7219478,97.4760226,36.9030446,97.5350407,92.5415135,96.2463497,97.5016001,97.5542943,97.2469526,95.7155414],"text":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"marker":{"color":"rgba(179,179,179,1)","size":5,"line":{"color":"black","width":0.5}},"type":"scatter3d","mode":"text+markers","name":"0","textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"frame":null},{"x":[79.09746589],"y":[759.8639],"z":[96.8683395],"text":"HR97","marker":{"color":"rgba(0,0,0,1)","size":5,"line":{"color":"black","width":0.5}},"type":"scatter3d","mode":"text+markers","name":"1","textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="explanation-of-hr97-predictions" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Explanation of HR97 predictions<a href="id_04_model_validation_and_interpretation.html#explanation-of-hr97-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="melanin-binding" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Melanin binding<a href="id_04_model_validation_and_interpretation.html#melanin-binding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb99-1"><a href="id_04_model_validation_and_interpretation.html#cb99-1" aria-hidden="true" tabindex="-1"></a>h2o.init(nthreads<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb99-2"><a href="id_04_model_validation_and_interpretation.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="id_04_model_validation_and_interpretation.html#cb99-3" aria-hidden="true" tabindex="-1"></a>dir_path <span class="op">=</span> <span class="st">&#39;/Users/renee/Downloads/melanin_binding&#39;</span></span>
<span id="cb99-4"><a href="id_04_model_validation_and_interpretation.html#cb99-4" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">&#39;superlearner_iter_3&#39;</span></span>
<span id="cb99-5"><a href="id_04_model_validation_and_interpretation.html#cb99-5" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/whole_data_set/train_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb99-6"><a href="id_04_model_validation_and_interpretation.html#cb99-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb99-7"><a href="id_04_model_validation_and_interpretation.html#cb99-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;./other_data/HR97_ml_input.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>).loc[:,X_train.columns]</span>
<span id="cb99-8"><a href="id_04_model_validation_and_interpretation.html#cb99-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> h2o.load_model(dir_path <span class="op">+</span> <span class="st">&#39;/whole_data_set/&#39;</span> <span class="op">+</span> model_name)</span>
<span id="cb99-9"><a href="id_04_model_validation_and_interpretation.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_predict_(data):</span>
<span id="cb99-10"><a href="id_04_model_validation_and_interpretation.html#cb99-10" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb99-11"><a href="id_04_model_validation_and_interpretation.html#cb99-11" aria-hidden="true" tabindex="-1"></a>    h2o_data <span class="op">=</span> h2o.H2OFrame(data)</span>
<span id="cb99-12"><a href="id_04_model_validation_and_interpretation.html#cb99-12" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> model.predict(h2o_data)</span>
<span id="cb99-13"><a href="id_04_model_validation_and_interpretation.html#cb99-13" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> res.as_data_frame()</span>
<span id="cb99-14"><a href="id_04_model_validation_and_interpretation.html#cb99-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(res)</span>
<span id="cb99-15"><a href="id_04_model_validation_and_interpretation.html#cb99-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-16"><a href="id_04_model_validation_and_interpretation.html#cb99-16" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb99-17"><a href="id_04_model_validation_and_interpretation.html#cb99-17" aria-hidden="true" tabindex="-1"></a>X_train_ <span class="op">=</span> X_train.iloc[np.random.choice(X_train.shape[<span class="dv">0</span>], <span class="dv">100</span>, replace<span class="op">=</span><span class="va">False</span>), :]</span>
<span id="cb99-18"><a href="id_04_model_validation_and_interpretation.html#cb99-18" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.KernelExplainer(model_predict_, X_train_, link<span class="op">=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb99-19"><a href="id_04_model_validation_and_interpretation.html#cb99-19" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> explainer.shap_values(X_test, nsamples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb99-20"><a href="id_04_model_validation_and_interpretation.html#cb99-20" aria-hidden="true" tabindex="-1"></a>h2o.remove_all()</span>
<span id="cb99-21"><a href="id_04_model_validation_and_interpretation.html#cb99-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-22"><a href="id_04_model_validation_and_interpretation.html#cb99-22" aria-hidden="true" tabindex="-1"></a>exp <span class="op">=</span> shap.Explanation(shap_res <span class="op">*</span> <span class="dv">100</span> <span class="op">/</span> <span class="fl">3.89063</span>, explainer.expected_value, data<span class="op">=</span>X_test.iloc[<span class="dv">0</span>:<span class="dv">1</span>, :], <span class="op">\</span></span>
<span id="cb99-23"><a href="id_04_model_validation_and_interpretation.html#cb99-23" aria-hidden="true" tabindex="-1"></a>                       feature_names<span class="op">=</span>X_train.columns)</span>
<span id="cb99-24"><a href="id_04_model_validation_and_interpretation.html#cb99-24" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb99-25"><a href="id_04_model_validation_and_interpretation.html#cb99-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb99-26"><a href="id_04_model_validation_and_interpretation.html#cb99-26" aria-hidden="true" tabindex="-1"></a>shap.plots.waterfall(exp[<span class="dv">0</span>], max_display<span class="op">=</span><span class="dv">20</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb99-27"><a href="id_04_model_validation_and_interpretation.html#cb99-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-28"><a href="id_04_model_validation_and_interpretation.html#cb99-28" aria-hidden="true" tabindex="-1"></a>yticklabels <span class="op">=</span> plt.gca().get_yticklabels()</span>
<span id="cb99-29"><a href="id_04_model_validation_and_interpretation.html#cb99-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(<span class="bu">len</span>(yticklabels) <span class="op">/</span> <span class="dv">2</span>)):</span>
<span id="cb99-30"><a href="id_04_model_validation_and_interpretation.html#cb99-30" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> yticklabels[i]</span>
<span id="cb99-31"><a href="id_04_model_validation_and_interpretation.html#cb99-31" aria-hidden="true" tabindex="-1"></a>    label_ <span class="op">=</span> label.get_text().split(<span class="st">&#39; = &#39;</span>)</span>
<span id="cb99-32"><a href="id_04_model_validation_and_interpretation.html#cb99-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(label_) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb99-33"><a href="id_04_model_validation_and_interpretation.html#cb99-33" aria-hidden="true" tabindex="-1"></a>        yticklabels[i].set_text(<span class="st">&#39; = &#39;</span> <span class="op">+</span> label_[<span class="dv">0</span>])</span>
<span id="cb99-34"><a href="id_04_model_validation_and_interpretation.html#cb99-34" aria-hidden="true" tabindex="-1"></a>    yticklabels[<span class="bu">int</span>(i <span class="op">+</span> <span class="bu">len</span>(yticklabels) <span class="op">/</span> <span class="dv">2</span>)].set_text(<span class="st">&#39; = &#39;</span>.join(label_[::<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb99-35"><a href="id_04_model_validation_and_interpretation.html#cb99-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-36"><a href="id_04_model_validation_and_interpretation.html#cb99-36" aria-hidden="true" tabindex="-1"></a>plt.gca().set_yticklabels(yticklabels)</span>
<span id="cb99-37"><a href="id_04_model_validation_and_interpretation.html#cb99-37" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(left<span class="op">=</span><span class="fl">0.33</span>, bottom<span class="op">=</span><span class="fl">0.167</span>, right<span class="op">=</span><span class="fl">0.93</span>, top<span class="op">=</span><span class="fl">0.920</span>)</span>
<span id="cb99-38"><a href="id_04_model_validation_and_interpretation.html#cb99-38" aria-hidden="true" tabindex="-1"></a>fig.set_figwidth(<span class="dv">10</span>)</span>
<span id="cb99-39"><a href="id_04_model_validation_and_interpretation.html#cb99-39" aria-hidden="true" tabindex="-1"></a>fig.set_figheight(<span class="dv">7</span>)</span>
<span id="cb99-40"><a href="id_04_model_validation_and_interpretation.html#cb99-40" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">40</span>, <span class="op">-</span><span class="fl">4.8</span>, <span class="st">&#39;SHAP value</span><span class="ch">\n</span><span class="st">(variable contribution to model prediction)&#39;</span>,</span>
<span id="cb99-41"><a href="id_04_model_validation_and_interpretation.html#cb99-41" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">&#39;center&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb99-42"><a href="id_04_model_validation_and_interpretation.html#cb99-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="figures/Fig%204%20HR97%20mb.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="cell-penetration" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Cell-penetration<a href="id_04_model_validation_and_interpretation.html#cell-penetration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb100-1"><a href="id_04_model_validation_and_interpretation.html#cb100-1" aria-hidden="true" tabindex="-1"></a>h2o.init(nthreads<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb100-2"><a href="id_04_model_validation_and_interpretation.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="id_04_model_validation_and_interpretation.html#cb100-3" aria-hidden="true" tabindex="-1"></a>dir_path <span class="op">=</span> <span class="st">&#39;/Users/renee/Downloads/cell_penetration&#39;</span></span>
<span id="cb100-4"><a href="id_04_model_validation_and_interpretation.html#cb100-4" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">&#39;GBM_model_1669777615732_886421&#39;</span></span>
<span id="cb100-5"><a href="id_04_model_validation_and_interpretation.html#cb100-5" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/whole_data_set/train_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb100-6"><a href="id_04_model_validation_and_interpretation.html#cb100-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb100-7"><a href="id_04_model_validation_and_interpretation.html#cb100-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;./other_data/HR97_ml_input.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>).loc[:,X_train.columns]</span>
<span id="cb100-8"><a href="id_04_model_validation_and_interpretation.html#cb100-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> h2o.load_model(dir_path <span class="op">+</span> <span class="st">&#39;/whole_data_set/&#39;</span> <span class="op">+</span> model_name)</span>
<span id="cb100-9"><a href="id_04_model_validation_and_interpretation.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_predict_(data):</span>
<span id="cb100-10"><a href="id_04_model_validation_and_interpretation.html#cb100-10" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb100-11"><a href="id_04_model_validation_and_interpretation.html#cb100-11" aria-hidden="true" tabindex="-1"></a>    h2o_data <span class="op">=</span> h2o.H2OFrame(data)</span>
<span id="cb100-12"><a href="id_04_model_validation_and_interpretation.html#cb100-12" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> model.predict(h2o_data)</span>
<span id="cb100-13"><a href="id_04_model_validation_and_interpretation.html#cb100-13" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> res.as_data_frame().iloc[:,<span class="dv">2</span>]</span>
<span id="cb100-14"><a href="id_04_model_validation_and_interpretation.html#cb100-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(res)</span>
<span id="cb100-15"><a href="id_04_model_validation_and_interpretation.html#cb100-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-16"><a href="id_04_model_validation_and_interpretation.html#cb100-16" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb100-17"><a href="id_04_model_validation_and_interpretation.html#cb100-17" aria-hidden="true" tabindex="-1"></a>X_train_ <span class="op">=</span> X_train.iloc[np.random.choice(X_train.shape[<span class="dv">0</span>], <span class="dv">100</span>, replace<span class="op">=</span><span class="va">False</span>), :]</span>
<span id="cb100-18"><a href="id_04_model_validation_and_interpretation.html#cb100-18" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.KernelExplainer(model_predict_, X_train_, link<span class="op">=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb100-19"><a href="id_04_model_validation_and_interpretation.html#cb100-19" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> explainer.shap_values(X_test, nsamples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb100-20"><a href="id_04_model_validation_and_interpretation.html#cb100-20" aria-hidden="true" tabindex="-1"></a>h2o.remove_all()</span>
<span id="cb100-21"><a href="id_04_model_validation_and_interpretation.html#cb100-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-22"><a href="id_04_model_validation_and_interpretation.html#cb100-22" aria-hidden="true" tabindex="-1"></a>exp <span class="op">=</span> shap.Explanation(shap_res <span class="op">*</span> <span class="dv">100</span>, explainer.expected_value <span class="op">*</span> <span class="dv">100</span>, data<span class="op">=</span>X_test.iloc[<span class="dv">0</span>:<span class="dv">1</span>, :], <span class="op">\</span></span>
<span id="cb100-23"><a href="id_04_model_validation_and_interpretation.html#cb100-23" aria-hidden="true" tabindex="-1"></a>                       feature_names<span class="op">=</span>X_train.columns)</span>
<span id="cb100-24"><a href="id_04_model_validation_and_interpretation.html#cb100-24" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb100-25"><a href="id_04_model_validation_and_interpretation.html#cb100-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb100-26"><a href="id_04_model_validation_and_interpretation.html#cb100-26" aria-hidden="true" tabindex="-1"></a>shap.plots.waterfall(exp[<span class="dv">0</span>], max_display<span class="op">=</span><span class="dv">11</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb100-27"><a href="id_04_model_validation_and_interpretation.html#cb100-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-28"><a href="id_04_model_validation_and_interpretation.html#cb100-28" aria-hidden="true" tabindex="-1"></a>yticklabels <span class="op">=</span> plt.gca().get_yticklabels()</span>
<span id="cb100-29"><a href="id_04_model_validation_and_interpretation.html#cb100-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(<span class="bu">len</span>(yticklabels) <span class="op">/</span> <span class="dv">2</span>)):</span>
<span id="cb100-30"><a href="id_04_model_validation_and_interpretation.html#cb100-30" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> yticklabels[i]</span>
<span id="cb100-31"><a href="id_04_model_validation_and_interpretation.html#cb100-31" aria-hidden="true" tabindex="-1"></a>    label_ <span class="op">=</span> label.get_text().split(<span class="st">&#39; = &#39;</span>)</span>
<span id="cb100-32"><a href="id_04_model_validation_and_interpretation.html#cb100-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(label_) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb100-33"><a href="id_04_model_validation_and_interpretation.html#cb100-33" aria-hidden="true" tabindex="-1"></a>        yticklabels[i].set_text(<span class="st">&#39; = &#39;</span> <span class="op">+</span> label_[<span class="dv">0</span>])</span>
<span id="cb100-34"><a href="id_04_model_validation_and_interpretation.html#cb100-34" aria-hidden="true" tabindex="-1"></a>    yticklabels[<span class="bu">int</span>(i <span class="op">+</span> <span class="bu">len</span>(yticklabels) <span class="op">/</span> <span class="dv">2</span>)].set_text(<span class="st">&#39; = &#39;</span>.join(label_[::<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb100-35"><a href="id_04_model_validation_and_interpretation.html#cb100-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-36"><a href="id_04_model_validation_and_interpretation.html#cb100-36" aria-hidden="true" tabindex="-1"></a>plt.gca().set_yticklabels(yticklabels)</span>
<span id="cb100-37"><a href="id_04_model_validation_and_interpretation.html#cb100-37" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(left<span class="op">=</span><span class="fl">0.32</span>, bottom<span class="op">=</span><span class="fl">0.18</span>, right<span class="op">=</span><span class="fl">0.927</span>, top<span class="op">=</span><span class="fl">0.925</span>)</span>
<span id="cb100-38"><a href="id_04_model_validation_and_interpretation.html#cb100-38" aria-hidden="true" tabindex="-1"></a>fig.set_figwidth(<span class="dv">10</span>)</span>
<span id="cb100-39"><a href="id_04_model_validation_and_interpretation.html#cb100-39" aria-hidden="true" tabindex="-1"></a>fig.set_figheight(<span class="dv">5</span>)</span>
<span id="cb100-40"><a href="id_04_model_validation_and_interpretation.html#cb100-40" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">72</span>, <span class="op">-</span><span class="fl">3.5</span>, <span class="st">&#39;SHAP value</span><span class="ch">\n</span><span class="st">(variable contribution to model prediction)&#39;</span>,</span>
<span id="cb100-41"><a href="id_04_model_validation_and_interpretation.html#cb100-41" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">&#39;center&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb100-42"><a href="id_04_model_validation_and_interpretation.html#cb100-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="figures/Fig%204%20HR97%20cpp.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="toxicity" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Toxicity<a href="id_04_model_validation_and_interpretation.html#toxicity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb101-1"><a href="id_04_model_validation_and_interpretation.html#cb101-1" aria-hidden="true" tabindex="-1"></a>h2o.init(nthreads<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb101-2"><a href="id_04_model_validation_and_interpretation.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="id_04_model_validation_and_interpretation.html#cb101-3" aria-hidden="true" tabindex="-1"></a>dir_path <span class="op">=</span> <span class="st">&#39;/Users/renee/Downloads/toxicity&#39;</span></span>
<span id="cb101-4"><a href="id_04_model_validation_and_interpretation.html#cb101-4" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">&#39;superlearner_iter_3&#39;</span></span>
<span id="cb101-5"><a href="id_04_model_validation_and_interpretation.html#cb101-5" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(dir_path <span class="op">+</span> <span class="st">&#39;/whole_data_set/train_set.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb101-6"><a href="id_04_model_validation_and_interpretation.html#cb101-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb101-7"><a href="id_04_model_validation_and_interpretation.html#cb101-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;./other_data/HR97_ml_input.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>).loc[:,X_train.columns]</span>
<span id="cb101-8"><a href="id_04_model_validation_and_interpretation.html#cb101-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> h2o.load_model(dir_path <span class="op">+</span> <span class="st">&#39;/whole_data_set/&#39;</span> <span class="op">+</span> model_name)</span>
<span id="cb101-9"><a href="id_04_model_validation_and_interpretation.html#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_predict_(data):</span>
<span id="cb101-10"><a href="id_04_model_validation_and_interpretation.html#cb101-10" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb101-11"><a href="id_04_model_validation_and_interpretation.html#cb101-11" aria-hidden="true" tabindex="-1"></a>    h2o_data <span class="op">=</span> h2o.H2OFrame(data)</span>
<span id="cb101-12"><a href="id_04_model_validation_and_interpretation.html#cb101-12" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> model.predict(h2o_data)</span>
<span id="cb101-13"><a href="id_04_model_validation_and_interpretation.html#cb101-13" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> res.as_data_frame().iloc[:,<span class="dv">2</span>]</span>
<span id="cb101-14"><a href="id_04_model_validation_and_interpretation.html#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(res)</span>
<span id="cb101-15"><a href="id_04_model_validation_and_interpretation.html#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="id_04_model_validation_and_interpretation.html#cb101-16" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb101-17"><a href="id_04_model_validation_and_interpretation.html#cb101-17" aria-hidden="true" tabindex="-1"></a>X_train_ <span class="op">=</span> X_train.iloc[np.random.choice(X_train.shape[<span class="dv">0</span>], <span class="dv">100</span>, replace<span class="op">=</span><span class="va">False</span>), :]</span>
<span id="cb101-18"><a href="id_04_model_validation_and_interpretation.html#cb101-18" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.KernelExplainer(model_predict_, X_train_, link<span class="op">=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb101-19"><a href="id_04_model_validation_and_interpretation.html#cb101-19" aria-hidden="true" tabindex="-1"></a>shap_res <span class="op">=</span> explainer.shap_values(X_test, nsamples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb101-20"><a href="id_04_model_validation_and_interpretation.html#cb101-20" aria-hidden="true" tabindex="-1"></a>h2o.remove_all()</span>
<span id="cb101-21"><a href="id_04_model_validation_and_interpretation.html#cb101-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-22"><a href="id_04_model_validation_and_interpretation.html#cb101-22" aria-hidden="true" tabindex="-1"></a>exp <span class="op">=</span> shap.Explanation(shap_res <span class="op">*</span> <span class="dv">100</span>, explainer.expected_value <span class="op">*</span> <span class="dv">100</span>, data<span class="op">=</span>X_test.iloc[<span class="dv">0</span>:<span class="dv">1</span>, :], <span class="op">\</span></span>
<span id="cb101-23"><a href="id_04_model_validation_and_interpretation.html#cb101-23" aria-hidden="true" tabindex="-1"></a>                       feature_names<span class="op">=</span>X_train.columns)</span>
<span id="cb101-24"><a href="id_04_model_validation_and_interpretation.html#cb101-24" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb101-25"><a href="id_04_model_validation_and_interpretation.html#cb101-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb101-26"><a href="id_04_model_validation_and_interpretation.html#cb101-26" aria-hidden="true" tabindex="-1"></a>shap.plots.waterfall(exp[<span class="dv">0</span>], max_display<span class="op">=</span><span class="dv">11</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb101-27"><a href="id_04_model_validation_and_interpretation.html#cb101-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-28"><a href="id_04_model_validation_and_interpretation.html#cb101-28" aria-hidden="true" tabindex="-1"></a>yticklabels <span class="op">=</span> plt.gca().get_yticklabels()</span>
<span id="cb101-29"><a href="id_04_model_validation_and_interpretation.html#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(<span class="bu">len</span>(yticklabels) <span class="op">/</span> <span class="dv">2</span>)):</span>
<span id="cb101-30"><a href="id_04_model_validation_and_interpretation.html#cb101-30" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> yticklabels[i]</span>
<span id="cb101-31"><a href="id_04_model_validation_and_interpretation.html#cb101-31" aria-hidden="true" tabindex="-1"></a>    label_ <span class="op">=</span> label.get_text().split(<span class="st">&#39; = &#39;</span>)</span>
<span id="cb101-32"><a href="id_04_model_validation_and_interpretation.html#cb101-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(label_) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb101-33"><a href="id_04_model_validation_and_interpretation.html#cb101-33" aria-hidden="true" tabindex="-1"></a>        yticklabels[i].set_text(<span class="st">&#39; = &#39;</span> <span class="op">+</span> label_[<span class="dv">0</span>])</span>
<span id="cb101-34"><a href="id_04_model_validation_and_interpretation.html#cb101-34" aria-hidden="true" tabindex="-1"></a>    yticklabels[<span class="bu">int</span>(i <span class="op">+</span> <span class="bu">len</span>(yticklabels) <span class="op">/</span> <span class="dv">2</span>)].set_text(<span class="st">&#39; = &#39;</span>.join(label_[::<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb101-35"><a href="id_04_model_validation_and_interpretation.html#cb101-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-36"><a href="id_04_model_validation_and_interpretation.html#cb101-36" aria-hidden="true" tabindex="-1"></a>plt.gca().set_yticklabels(yticklabels)</span>
<span id="cb101-37"><a href="id_04_model_validation_and_interpretation.html#cb101-37" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(left<span class="op">=</span><span class="fl">0.395</span>, bottom<span class="op">=</span><span class="fl">0.18</span>, right<span class="op">=</span><span class="fl">0.927</span>, top<span class="op">=</span><span class="fl">0.925</span>)</span>
<span id="cb101-38"><a href="id_04_model_validation_and_interpretation.html#cb101-38" aria-hidden="true" tabindex="-1"></a>fig.set_figwidth(<span class="dv">10</span>)</span>
<span id="cb101-39"><a href="id_04_model_validation_and_interpretation.html#cb101-39" aria-hidden="true" tabindex="-1"></a>fig.set_figheight(<span class="dv">5</span>)</span>
<span id="cb101-40"><a href="id_04_model_validation_and_interpretation.html#cb101-40" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">80</span>, <span class="op">-</span><span class="fl">3.5</span>, <span class="st">&#39;SHAP value</span><span class="ch">\n</span><span class="st">(variable contribution to model prediction)&#39;</span>,</span>
<span id="cb101-41"><a href="id_04_model_validation_and_interpretation.html#cb101-41" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">&#39;center&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb101-42"><a href="id_04_model_validation_and_interpretation.html#cb101-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="figures/Fig%204%20HR97%20tx.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="peptide-design-space-visualization" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Peptide design space visualization<a href="id_04_model_validation_and_interpretation.html#peptide-design-space-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb102-1"><a href="id_04_model_validation_and_interpretation.html#cb102-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tsne_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">tSNE 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">tSNE 2</span><span class="st">`</span>, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="id_04_model_validation_and_interpretation.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb102-3"><a href="id_04_model_validation_and_interpretation.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> note), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">nudge_y =</span> <span class="dv">10</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="at">force =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="id_04_model_validation_and_interpretation.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FF380D&quot;</span>, <span class="st">&quot;#0DACFF&quot;</span>, <span class="st">&quot;#7134F7&quot;</span>, <span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;#FEFA0A&quot;</span>, <span class="st">&quot;grey20&quot;</span>)) <span class="sc">+</span></span>
<span id="cb102-5"><a href="id_04_model_validation_and_interpretation.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-6"><a href="id_04_model_validation_and_interpretation.html#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb102-7"><a href="id_04_model_validation_and_interpretation.html#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb102-8"><a href="id_04_model_validation_and_interpretation.html#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb102-9"><a href="id_04_model_validation_and_interpretation.html#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb102-10"><a href="id_04_model_validation_and_interpretation.html#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-11"><a href="id_04_model_validation_and_interpretation.html#cb102-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-12"><a href="id_04_model_validation_and_interpretation.html#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-13"><a href="id_04_model_validation_and_interpretation.html#cb102-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-14"><a href="id_04_model_validation_and_interpretation.html#cb102-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb102-15"><a href="id_04_model_validation_and_interpretation.html#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb102-16"><a href="id_04_model_validation_and_interpretation.html#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-17"><a href="id_04_model_validation_and_interpretation.html#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-18"><a href="id_04_model_validation_and_interpretation.html#cb102-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-19"><a href="id_04_model_validation_and_interpretation.html#cb102-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-20"><a href="id_04_model_validation_and_interpretation.html#cb102-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-21"><a href="id_04_model_validation_and_interpretation.html#cb102-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb102-22"><a href="id_04_model_validation_and_interpretation.html#cb102-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb102-23"><a href="id_04_model_validation_and_interpretation.html#cb102-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb102-24"><a href="id_04_model_validation_and_interpretation.html#cb102-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb102-25"><a href="id_04_model_validation_and_interpretation.html#cb102-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-26"><a href="id_04_model_validation_and_interpretation.html#cb102-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb102-27"><a href="id_04_model_validation_and_interpretation.html#cb102-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-28"><a href="id_04_model_validation_and_interpretation.html#cb102-28" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tsne_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">tSNE 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">tSNE 2</span><span class="st">`</span>, <span class="at">fill =</span> mb_predict)) <span class="sc">+</span></span>
<span id="cb102-29"><a href="id_04_model_validation_and_interpretation.html#cb102-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb102-30"><a href="id_04_model_validation_and_interpretation.html#cb102-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> note), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">nudge_y =</span> <span class="dv">10</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="at">force =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb102-31"><a href="id_04_model_validation_and_interpretation.html#cb102-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;#0DACFF&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#FF380D&quot;</span>, <span class="at">midpoint =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb102-32"><a href="id_04_model_validation_and_interpretation.html#cb102-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-33"><a href="id_04_model_validation_and_interpretation.html#cb102-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb102-34"><a href="id_04_model_validation_and_interpretation.html#cb102-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb102-35"><a href="id_04_model_validation_and_interpretation.html#cb102-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb102-36"><a href="id_04_model_validation_and_interpretation.html#cb102-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb102-37"><a href="id_04_model_validation_and_interpretation.html#cb102-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-38"><a href="id_04_model_validation_and_interpretation.html#cb102-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-39"><a href="id_04_model_validation_and_interpretation.html#cb102-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-40"><a href="id_04_model_validation_and_interpretation.html#cb102-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-41"><a href="id_04_model_validation_and_interpretation.html#cb102-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb102-42"><a href="id_04_model_validation_and_interpretation.html#cb102-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb102-43"><a href="id_04_model_validation_and_interpretation.html#cb102-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-44"><a href="id_04_model_validation_and_interpretation.html#cb102-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-45"><a href="id_04_model_validation_and_interpretation.html#cb102-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-46"><a href="id_04_model_validation_and_interpretation.html#cb102-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-47"><a href="id_04_model_validation_and_interpretation.html#cb102-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb102-48"><a href="id_04_model_validation_and_interpretation.html#cb102-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb102-49"><a href="id_04_model_validation_and_interpretation.html#cb102-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb102-50"><a href="id_04_model_validation_and_interpretation.html#cb102-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.91</span>, <span class="fl">0.82</span>),</span>
<span id="cb102-51"><a href="id_04_model_validation_and_interpretation.html#cb102-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb102-52"><a href="id_04_model_validation_and_interpretation.html#cb102-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-53"><a href="id_04_model_validation_and_interpretation.html#cb102-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb102-54"><a href="id_04_model_validation_and_interpretation.html#cb102-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Predicted peptide </span><span class="sc">\n</span><span class="st"> bound to b-mNPs (%)&quot;</span>,</span>
<span id="cb102-55"><a href="id_04_model_validation_and_interpretation.html#cb102-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;left&quot;</span></span>
<span id="cb102-56"><a href="id_04_model_validation_and_interpretation.html#cb102-56" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb102-57"><a href="id_04_model_validation_and_interpretation.html#cb102-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Melanin binding prediction&quot;</span>)</span>
<span id="cb102-58"><a href="id_04_model_validation_and_interpretation.html#cb102-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-59"><a href="id_04_model_validation_and_interpretation.html#cb102-59" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tsne_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">tSNE 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">tSNE 2</span><span class="st">`</span>, <span class="at">fill =</span> cpp_predict)) <span class="sc">+</span></span>
<span id="cb102-60"><a href="id_04_model_validation_and_interpretation.html#cb102-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb102-61"><a href="id_04_model_validation_and_interpretation.html#cb102-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> note), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">nudge_y =</span> <span class="dv">10</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="at">force =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb102-62"><a href="id_04_model_validation_and_interpretation.html#cb102-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FF380D&quot;</span>, <span class="st">&quot;#0DACFF&quot;</span>)) <span class="sc">+</span></span>
<span id="cb102-63"><a href="id_04_model_validation_and_interpretation.html#cb102-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-64"><a href="id_04_model_validation_and_interpretation.html#cb102-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb102-65"><a href="id_04_model_validation_and_interpretation.html#cb102-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb102-66"><a href="id_04_model_validation_and_interpretation.html#cb102-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb102-67"><a href="id_04_model_validation_and_interpretation.html#cb102-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb102-68"><a href="id_04_model_validation_and_interpretation.html#cb102-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-69"><a href="id_04_model_validation_and_interpretation.html#cb102-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-70"><a href="id_04_model_validation_and_interpretation.html#cb102-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-71"><a href="id_04_model_validation_and_interpretation.html#cb102-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-72"><a href="id_04_model_validation_and_interpretation.html#cb102-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb102-73"><a href="id_04_model_validation_and_interpretation.html#cb102-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb102-74"><a href="id_04_model_validation_and_interpretation.html#cb102-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-75"><a href="id_04_model_validation_and_interpretation.html#cb102-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-76"><a href="id_04_model_validation_and_interpretation.html#cb102-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-77"><a href="id_04_model_validation_and_interpretation.html#cb102-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-78"><a href="id_04_model_validation_and_interpretation.html#cb102-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-79"><a href="id_04_model_validation_and_interpretation.html#cb102-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb102-80"><a href="id_04_model_validation_and_interpretation.html#cb102-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb102-81"><a href="id_04_model_validation_and_interpretation.html#cb102-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.93</span>),</span>
<span id="cb102-82"><a href="id_04_model_validation_and_interpretation.html#cb102-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb102-83"><a href="id_04_model_validation_and_interpretation.html#cb102-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-84"><a href="id_04_model_validation_and_interpretation.html#cb102-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Cell-penetration prediction&quot;</span>)</span>
<span id="cb102-85"><a href="id_04_model_validation_and_interpretation.html#cb102-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-86"><a href="id_04_model_validation_and_interpretation.html#cb102-86" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tsne_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">tSNE 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">tSNE 2</span><span class="st">`</span>, <span class="at">fill =</span> tx_predict)) <span class="sc">+</span></span>
<span id="cb102-87"><a href="id_04_model_validation_and_interpretation.html#cb102-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb102-88"><a href="id_04_model_validation_and_interpretation.html#cb102-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> note), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">nudge_y =</span> <span class="dv">10</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="at">force =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb102-89"><a href="id_04_model_validation_and_interpretation.html#cb102-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#7d5ef7&quot;</span>, <span class="st">&quot;#FF380D&quot;</span>)) <span class="sc">+</span></span>
<span id="cb102-90"><a href="id_04_model_validation_and_interpretation.html#cb102-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-91"><a href="id_04_model_validation_and_interpretation.html#cb102-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb102-92"><a href="id_04_model_validation_and_interpretation.html#cb102-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb102-93"><a href="id_04_model_validation_and_interpretation.html#cb102-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb102-94"><a href="id_04_model_validation_and_interpretation.html#cb102-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb102-95"><a href="id_04_model_validation_and_interpretation.html#cb102-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-96"><a href="id_04_model_validation_and_interpretation.html#cb102-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-97"><a href="id_04_model_validation_and_interpretation.html#cb102-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-98"><a href="id_04_model_validation_and_interpretation.html#cb102-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-99"><a href="id_04_model_validation_and_interpretation.html#cb102-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb102-100"><a href="id_04_model_validation_and_interpretation.html#cb102-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb102-101"><a href="id_04_model_validation_and_interpretation.html#cb102-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-102"><a href="id_04_model_validation_and_interpretation.html#cb102-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb102-103"><a href="id_04_model_validation_and_interpretation.html#cb102-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-104"><a href="id_04_model_validation_and_interpretation.html#cb102-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb102-105"><a href="id_04_model_validation_and_interpretation.html#cb102-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb102-106"><a href="id_04_model_validation_and_interpretation.html#cb102-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb102-107"><a href="id_04_model_validation_and_interpretation.html#cb102-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb102-108"><a href="id_04_model_validation_and_interpretation.html#cb102-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.93</span>),</span>
<span id="cb102-109"><a href="id_04_model_validation_and_interpretation.html#cb102-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb102-110"><a href="id_04_model_validation_and_interpretation.html#cb102-110" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-111"><a href="id_04_model_validation_and_interpretation.html#cb102-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Non-toxic prediction&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb103-1"><a href="id_04_model_validation_and_interpretation.html#cb103-1" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1,</span>
<span id="cb103-2"><a href="id_04_model_validation_and_interpretation.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(<span class="cn">NULL</span>, p2, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.08</span>, <span class="fl">0.85</span>)),</span>
<span id="cb103-3"><a href="id_04_model_validation_and_interpretation.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  p3, p4,</span>
<span id="cb103-4"><a href="id_04_model_validation_and_interpretation.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.48</span>, <span class="fl">0.45</span>),</span>
<span id="cb103-5"><a href="id_04_model_validation_and_interpretation.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb103-6"><a href="id_04_model_validation_and_interpretation.html#cb103-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="figures/Fig%205%20peptide%20design%20space.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb104-1"><a href="id_04_model_validation_and_interpretation.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.2 (2022-10-31)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggrepel_0.9.1    plotly_4.10.0    cowplot_1.1.1    ggforce_0.3.4   
##  [5] scales_1.2.1     reshape2_1.4.4   reticulate_1.25  ggbeeswarm_0.6.0
##  [9] ggpubr_0.4.0     ggplot2_3.3.6    h2o_3.38.0.2    
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.4.4        sass_0.4.2        tidyr_1.2.0       viridisLite_0.4.1
##  [5] jsonlite_1.8.0    here_1.0.1        carData_3.0-5     R.utils_2.12.0   
##  [9] bslib_0.4.0       assertthat_0.2.1  highr_0.9         vipor_0.4.5      
## [13] yaml_2.3.5        pillar_1.8.1      backports_1.4.1   lattice_0.20-45  
## [17] glue_1.6.2        digest_0.6.29     ggsignif_0.6.3    polyclip_1.10-0  
## [21] colorspace_2.0-3  htmltools_0.5.3   Matrix_1.5-1      R.oo_1.25.0      
## [25] plyr_1.8.7        pkgconfig_2.0.3   broom_1.0.0       bookdown_0.28    
## [29] purrr_0.3.4       tweenr_2.0.1      tibble_3.1.8      styler_1.8.0     
## [33] generics_0.1.3    farver_2.1.1      car_3.1-0         cachem_1.0.6     
## [37] withr_2.5.0       lazyeval_0.2.2    cli_3.3.0         magrittr_2.0.3   
## [41] evaluate_0.16     R.methodsS3_1.8.2 fansi_1.0.3       R.cache_0.16.0   
## [45] MASS_7.3-58.1     rstatix_0.7.0     beeswarm_0.4.0    tools_4.2.2      
## [49] data.table_1.14.2 lifecycle_1.0.1   stringr_1.4.1     munsell_0.5.0    
## [53] compiler_4.2.2    jquerylib_0.1.4   rlang_1.0.4       grid_4.2.2       
## [57] RCurl_1.98-1.8    rstudioapi_0.14   htmlwidgets_1.5.4 crosstalk_1.2.0  
## [61] bitops_1.0-7      rmarkdown_2.16    codetools_0.2-18  gtable_0.3.0     
## [65] abind_1.4-5       DBI_1.1.3         R6_2.5.1          knitr_1.40       
## [69] dplyr_1.0.9       fastmap_1.1.0     utf8_1.2.2        rprojroot_2.0.3  
## [73] stringi_1.7.8     Rcpp_1.0.9        vctrs_0.4.1       png_0.1-7        
## [77] tidyselect_1.1.2  xfun_0.32</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb106-1"><a href="id_04_model_validation_and_interpretation.html#cb106-1" aria-hidden="true" tabindex="-1"></a>session_info.show()</span></code></pre></div>
<pre><code>## -----
## h2o                 3.38.0.2
## matplotlib          3.6.2
## numpy               1.23.5
## pandas              1.5.2
## session_info        1.0.0
## shap                0.41.0
## -----
## Python 3.8.15 | packaged by conda-forge | (default, Nov 22 2022, 09:04:40) [Clang 14.0.6 ]
## macOS-10.16-x86_64-i386-64bit
## -----
## Session information updated at 2023-03-12 23:25</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_03_model_training.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="id_05_adversarial_computational_control.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["main_notebook.pdf", "PDF"]],
"search": false,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
